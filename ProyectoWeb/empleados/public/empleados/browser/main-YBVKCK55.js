import{$ as At,A as Ob,B as Fb,C as yn,D as di,E as $d,F as Nu,G as Ty,H as Vb,I as Lb,J as q,K as Qt,L as ut,M as by,N as jb,O as Pu,P as ce,Q as nn,R as Hd,S as Sy,T as vn,U as hi,V as us,W as qd,X as Gd,Y as ku,Z as zd,_ as Ft,a as b,b as ye,c as Ey,d as v,e as Sb,f as Vd,g as Ab,h as xb,i as D,j as Eo,k as Ld,l as Mb,m as Rb,n as Iy,o as ht,p as jd,q as Ru,r as Cy,s as Nb,t as er,u as Dy,v as Ud,w as Pb,x as kb,y as Bd,z as et}from"./chunk-MYOLRLH5.js";var Ub=null;var Ay=1,xy=Symbol("SIGNAL");function we(t){let e=Ub;return Ub=t,e}var Bb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function bL(t){if(!(Ny(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Ay)){if(!t.producerMustRecompute(t)&&!My(t)){t.dirty=!1,t.lastCleanEpoch=Ay;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Ay}}function $b(t){return t&&(t.nextProducerIndex=0),we(t)}function Hb(t,e){if(we(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Ny(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Ry(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function My(t){Wd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(bL(n),r!==n.version))return!0}return!1}function qb(t){if(Wd(t),Ny(t))for(let e=0;e<t.producerNode.length;e++)Ry(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Ry(t,e){if(SL(t),Wd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Ry(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Wd(i),i.producerIndexOfThis[r]=e}}function Ny(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Wd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function SL(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function AL(){throw new Error}var xL=AL;function Gb(t){xL=t}function W(t){return typeof t=="function"}function Io(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Kd=Io(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function cs(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ye=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(W(r))try{r()}catch(s){e=s instanceof Kd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{zb(s)}catch(o){e=e??[],o instanceof Kd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Kd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)zb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&cs(n,e)}remove(e){let{_finalizers:n}=this;n&&cs(n,e),e instanceof t&&e._removeParent(this)}};Ye.EMPTY=(()=>{let t=new Ye;return t.closed=!0,t})();var Py=Ye.EMPTY;function Qd(t){return t instanceof Ye||t&&"closed"in t&&W(t.remove)&&W(t.add)&&W(t.unsubscribe)}function zb(t){W(t)?t():t.unsubscribe()}var Vn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Co={setTimeout(t,e,...n){let{delegate:r}=Co;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Co;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Yd(t){Co.setTimeout(()=>{let{onUnhandledError:e}=Vn;if(e)e(t);else throw t})}function ls(){}var Wb=(()=>ky("C",void 0,void 0))();function Kb(t){return ky("E",void 0,t)}function Qb(t){return ky("N",t,void 0)}function ky(t,e,n){return{kind:t,value:e,error:n}}var ds=null;function Do(t){if(Vn.useDeprecatedSynchronousErrorHandling){let e=!ds;if(e&&(ds={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ds;if(ds=null,n)throw r}}else t()}function Yb(t){Vn.useDeprecatedSynchronousErrorHandling&&ds&&(ds.errorThrown=!0,ds.error=t)}var hs=class extends Ye{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Qd(e)&&e.add(this)):this.destination=NL}static create(e,n,r){return new Fr(e,n,r)}next(e){this.isStopped?Fy(Qb(e),this):this._next(e)}error(e){this.isStopped?Fy(Kb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Fy(Wb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},ML=Function.prototype.bind;function Oy(t,e){return ML.call(t,e)}var Vy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Zd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Zd(r)}else Zd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Zd(n)}}},Fr=class extends hs{constructor(e,n,r){super();let i;if(W(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Vn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Oy(e.next,s),error:e.error&&Oy(e.error,s),complete:e.complete&&Oy(e.complete,s)}):i=e}this.destination=new Vy(i)}};function Zd(t){Vn.useDeprecatedSynchronousErrorHandling?Yb(t):Yd(t)}function RL(t){throw t}function Fy(t,e){let{onStoppedNotification:n}=Vn;n&&Co.setTimeout(()=>n(t,e))}var NL={closed:!0,next:ls,error:RL,complete:ls};var To=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Et(t){return t}function Ly(...t){return jy(t)}function jy(t){return t.length===0?Et:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var te=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=kL(n)?n:new Fr(n,r,i);return Do(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Zb(r),new r((i,s)=>{let o=new Fr({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[To](){return this}pipe(...n){return jy(n)(this)}toPromise(n){return n=Zb(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Zb(t){var e;return(e=t??Vn.Promise)!==null&&e!==void 0?e:Promise}function PL(t){return t&&W(t.next)&&W(t.error)&&W(t.complete)}function kL(t){return t&&t instanceof hs||PL(t)&&Qd(t)}function Uy(t){return W(t?.lift)}function Z(t){return e=>{if(Uy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function K(t,e,n,r,i){return new By(t,e,n,r,i)}var By=class extends hs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function bo(){return Z((t,e)=>{let n=null;t._refCount++;let r=K(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var So=class extends te{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Uy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ye;let n=this.getSubject();e.add(this.source.subscribe(K(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ye.EMPTY)}return e}refCount(){return bo()(this)}};var Xb=Io(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Be=(()=>{class t extends te{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Xd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Xb}next(n){Do(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Do(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Do(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Py:(this.currentObservers=null,s.push(n),new Ye(()=>{this.currentObservers=null,cs(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new te;return n.source=this,n}}return t.create=(e,n)=>new Xd(e,n),t})(),Xd=class extends Be{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Py}};var It=class extends Be{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Ou={now(){return(Ou.delegate||Date).now()},delegate:void 0};var Jd=class extends Be{constructor(e=1/0,n=1/0,r=Ou){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var eh=class extends Ye{constructor(e,n){super()}schedule(e,n=0){return this}};var Fu={setInterval(t,e,...n){let{delegate:r}=Fu;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Fu;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Ao=class extends eh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Fu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Fu.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,cs(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var xo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};xo.now=Ou.now;var Mo=class extends xo{constructor(e,n=xo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var fs=new Mo(Ao);var th=class extends Ao{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var nh=class extends Mo{};var $y=new nh(th);var Vt=new te(t=>t.complete());function Jb(t){return t&&W(t.schedule)}function Hy(t){return t[t.length-1]}function Ro(t){return W(Hy(t))?t.pop():void 0}function tr(t){return Jb(Hy(t))?t.pop():void 0}function eS(t,e){return typeof Hy(t)=="number"?t.pop():e}var rh=t=>t&&typeof t.length=="number"&&typeof t!="function";function ih(t){return W(t?.then)}function sh(t){return W(t[To])}function oh(t){return Symbol.asyncIterator&&W(t?.[Symbol.asyncIterator])}function ah(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function OL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var uh=OL();function ch(t){return W(t?.[uh])}function lh(t){return Ab(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Vd(n.read());if(i)return yield Vd(void 0);yield yield Vd(r)}}finally{n.releaseLock()}})}function dh(t){return W(t?.getReader)}function Te(t){if(t instanceof te)return t;if(t!=null){if(sh(t))return FL(t);if(rh(t))return VL(t);if(ih(t))return LL(t);if(oh(t))return tS(t);if(ch(t))return jL(t);if(dh(t))return UL(t)}throw ah(t)}function FL(t){return new te(e=>{let n=t[To]();if(W(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function VL(t){return new te(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function LL(t){return new te(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Yd)})}function jL(t){return new te(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function tS(t){return new te(e=>{BL(t,e).catch(n=>e.error(n))})}function UL(t){return tS(lh(t))}function BL(t,e){var n,r,i,s;return Sb(this,void 0,void 0,function*(){try{for(n=xb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Yt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function rn(t,e=0){return Z((n,r)=>{n.subscribe(K(r,i=>Yt(r,t,()=>r.next(i),e),()=>Yt(r,t,()=>r.complete(),e),i=>Yt(r,t,()=>r.error(i),e)))})}function _n(t,e=0){return Z((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function nS(t,e){return Te(t).pipe(_n(e),rn(e))}function rS(t,e){return Te(t).pipe(_n(e),rn(e))}function iS(t,e){return new te(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function sS(t,e){return new te(n=>{let r;return Yt(n,e,()=>{r=t[uh](),Yt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>W(r?.return)&&r.return()})}function hh(t,e){if(!t)throw new Error("Iterable cannot be null");return new te(n=>{Yt(n,e,()=>{let r=t[Symbol.asyncIterator]();Yt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function oS(t,e){return hh(lh(t),e)}function aS(t,e){if(t!=null){if(sh(t))return nS(t,e);if(rh(t))return iS(t,e);if(ih(t))return rS(t,e);if(oh(t))return hh(t,e);if(ch(t))return sS(t,e);if(dh(t))return oS(t,e)}throw ah(t)}function me(t,e){return e?aS(t,e):Te(t)}function F(...t){let e=tr(t);return me(t,e)}function No(t,e){let n=W(t)?t:()=>t,r=i=>i.error(n());return new te(e?i=>e.schedule(r,0,i):r)}function qy(t){return!!t&&(t instanceof te||W(t.lift)&&W(t.subscribe))}var Vr=Io(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function O(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:$L}=Array;function HL(t,e){return $L(e)?t(...e):t(e)}function fh(t){return O(e=>HL(t,e))}var{isArray:qL}=Array,{getPrototypeOf:GL,prototype:zL,keys:WL}=Object;function ph(t){if(t.length===1){let e=t[0];if(qL(e))return{args:e,keys:null};if(KL(e)){let n=WL(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function KL(t){return t&&typeof t=="object"&&GL(t)===zL}function gh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Vu(...t){let e=tr(t),n=Ro(t),{args:r,keys:i}=ph(t);if(r.length===0)return me([],e);let s=new te(QL(r,e,i?o=>gh(i,o):Et));return n?s.pipe(fh(n)):s}function QL(t,e,n=Et){return r=>{uS(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)uS(e,()=>{let c=me(t[u],e),l=!1;c.subscribe(K(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function uS(t,e,n){t?Yt(n,t,e):e()}function cS(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let _=!1;Te(n(g,l++)).subscribe(K(e,C=>{i?.(C),s?f(C):e.next(C)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;u.length&&c<r;){let C=u.shift();o?Yt(e,o,()=>p(C)):p(C)}h()}catch(C){e.error(C)}}))};return t.subscribe(K(e,f,()=>{d=!0,h()})),()=>{a?.()}}function tt(t,e,n=1/0){return W(e)?tt((r,i)=>O((s,o)=>e(r,s,i,o))(Te(t(r,i))),n):(typeof e=="number"&&(n=e),Z((r,i)=>cS(r,i,t,n)))}function fi(t=1/0){return tt(Et,t)}function lS(){return fi(1)}function Po(...t){return lS()(me(t,tr(t)))}function mh(t){return new te(e=>{Te(t()).subscribe(e)})}function Gy(...t){let e=Ro(t),{args:n,keys:r}=ph(t),i=new te(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Te(n[l]).subscribe(K(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?gh(r,a):a),s.complete())}))}});return e?i.pipe(fh(e)):i}function ko(...t){let e=tr(t),n=eS(t,1/0),r=t;return r.length?r.length===1?Te(r[0]):fi(n)(me(r,e)):Vt}function Ct(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>t.call(e,s,i++)&&r.next(s)))})}function pi(t){return Z((e,n)=>{let r=null,i=!1,s;r=e.subscribe(K(n,void 0,void 0,o=>{s=Te(t(o,pi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function dS(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(K(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function ps(t,e){return W(e)?tt(t,e,1):tt(t,1)}function gi(t){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Lr(t){return t<=0?()=>Vt:Z((e,n)=>{let r=0;e.subscribe(K(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function zy(t){return O(()=>t)}function Lu(t,e=Et){return t=t??YL,Z((n,r)=>{let i,s=!0;n.subscribe(K(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function YL(t,e){return t===e}function yh(t=ZL){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function ZL(){return new Vr}function ju(t){return Z((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function wn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ct((i,s)=>t(i,s,r)):Et,Lr(1),n?gi(e):yh(()=>new Vr))}function Oo(t){return t<=0?()=>Vt:Z((e,n)=>{let r=[];e.subscribe(K(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Wy(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ct((i,s)=>t(i,s,r)):Et,Oo(1),n?gi(e):yh(()=>new Vr))}function Uu(){return Z((t,e)=>{let n,r=!1;t.subscribe(K(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function nr(t,e){return Z(dS(t,e,arguments.length>=2,!0))}function Bu(t={}){let{connector:e=()=>new Be,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return Z((g,_)=>{c++,!d&&!l&&h();let C=u=u??e();_.add(()=>{c--,c===0&&!d&&!l&&(a=Ky(p,i))}),C.subscribe(_),!o&&c>0&&(o=new Fr({next:k=>C.next(k),error:k=>{d=!0,h(),a=Ky(f,n,k),C.error(k)},complete:()=>{l=!0,h(),a=Ky(f,r),C.complete()}}),Te(g).subscribe(o))})(s)}}function Ky(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Fr({next:()=>{r.unsubscribe(),t()}});return Te(e(...n)).subscribe(r)}function vh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Bu({connector:()=>new Jd(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Qy(t){return Z((e,n)=>{let r=!1,i=0;e.subscribe(K(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function gs(...t){let e=tr(t);return Z((n,r)=>{(e?Po(t,n,e):Po(t,n)).subscribe(r)})}function ke(t,e){return Z((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(K(r,u=>{i?.unsubscribe();let c=0,l=s++;Te(t(u,l)).subscribe(i=K(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function _h(t,e){return W(e)?ke(()=>t,e):ke(()=>t)}function Yy(t){return Z((e,n)=>{Te(t).subscribe(K(n,()=>n.complete(),ls)),!n.closed&&e.subscribe(n)})}function ct(t,e,n){let r=W(t)||e||n?{next:t,error:e,complete:n}:t;return r?Z((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(K(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Et}function Zy(...t){let e=Ro(t);return Z((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Te(t[u]).subscribe(K(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(Et))&&(o=null))},ls));n.subscribe(K(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var ZS="https://g.co/ng/security#xss",L=class extends Error{constructor(e,n){super(Jv(e,n)),this.code=e}};function Jv(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function ec(t){return{toString:t}.toString()}var wh="__parameters__";function XL(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function XS(t,e,n){return ec(()=>{let r=XL(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(wh)?u[wh]:Object.defineProperty(u,wh,{value:[]})[wh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var jt=globalThis;function be(t){for(let e in t)if(t[e]===be)return e;throw Error("Could not find renamed property on target object.")}function JL(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Ut(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Ut).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function hS(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var e2=be({__forward_ref__:be});function Dn(t){return t.__forward_ref__=Dn,t.toString=function(){return Ut(this())},t}function Lt(t){return JS(t)?t():t}function JS(t){return typeof t=="function"&&t.hasOwnProperty(e2)&&t.__forward_ref__===Dn}function N(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function He(t){return{providers:t.providers||[],imports:t.imports||[]}}function Jh(t){return fS(t,tA)||fS(t,nA)}function eA(t){return Jh(t)!==null}function fS(t,e){return t.hasOwnProperty(e)?t[e]:null}function t2(t){let e=t&&(t[tA]||t[nA]);return e||null}function pS(t){return t&&(t.hasOwnProperty(gS)||t.hasOwnProperty(n2))?t[gS]:null}var tA=be({\u0275prov:be}),gS=be({\u0275inj:be}),nA=be({ngInjectableDef:be}),n2=be({ngInjectorDef:be}),R=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=N({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function rA(t){return t&&!!t.\u0275providers}var r2=be({\u0275cmp:be}),i2=be({\u0275dir:be}),s2=be({\u0275pipe:be}),o2=be({\u0275mod:be}),Mh=be({\u0275fac:be}),$u=be({__NG_ELEMENT_ID__:be}),mS=be({__NG_ENV_ID__:be});function ef(t){return typeof t=="string"?t:t==null?"":String(t)}function a2(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():ef(t)}function u2(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new L(-200,t)}function e_(t,e){throw new L(-201,!1)}var oe=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(oe||{}),hv;function iA(){return hv}function En(t){let e=hv;return hv=t,e}function sA(t,e,n){let r=Jh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&oe.Optional)return null;if(e!==void 0)return e;e_(t,"Injector")}var c2={},qu=c2,fv="__NG_DI_FLAG__",Rh="ngTempTokenPath",l2="ngTokenPath",d2=/\n/gm,h2="\u0275",yS="__source",Uo;function f2(){return Uo}function mi(t){let e=Uo;return Uo=t,e}function p2(t,e=oe.Default){if(Uo===void 0)throw new L(-203,!1);return Uo===null?sA(t,void 0,e):Uo.get(t,e&oe.Optional?null:void 0,e)}function E(t,e=oe.Default){return(iA()||p2)(Lt(t),e)}function M(t,e=oe.Default){return E(t,tf(e))}function tf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function pv(t){let e=[];for(let n=0;n<t.length;n++){let r=Lt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new L(900,!1);let i,s=oe.Default;for(let o=0;o<r.length;o++){let a=r[o],u=g2(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function oA(t,e){return t[fv]=e,t.prototype[fv]=e,t}function g2(t){return t[fv]}function m2(t,e,n,r){let i=t[Rh];throw e[yS]&&i.unshift(e[yS]),t.message=y2(`
`+t.message,i,n,r),t[l2]=i,t[Rh]=null,t}function y2(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==h2?t.slice(2):t;let i=Ut(e);if(Array.isArray(e))i=e.map(Ut).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Ut(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(d2,`
  `)}`}var $n=oA(XS("Optional"),8);var t_=oA(XS("SkipSelf"),4);function $o(t,e){let n=t.hasOwnProperty(Mh);return n?t[Mh]:null}function n_(t,e){t.forEach(n=>Array.isArray(n)?n_(n,e):e(n))}function aA(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Nh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function v2(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function _2(t,e,n){let r=tc(t,e);return r>=0?t[r|1]=n:(r=~r,v2(t,r,e,n)),r}function Xy(t,e){let n=tc(t,e);if(n>=0)return t[n|1]}function tc(t,e){return w2(t,e,1)}function w2(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Ho={},In=[],qo=new R(""),uA=new R("",-1),cA=new R(""),Ph=class{get(e,n=qu){if(n===qu){let r=new Error(`NullInjectorError: No provider for ${Ut(e)}!`);throw r.name="NullInjectorError",r}return n}},lA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(lA||{}),sr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(sr||{}),nt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(nt||{});function E2(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function gv(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];I2(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function dA(t){return t===3||t===4||t===6}function I2(t){return t.charCodeAt(0)===64}function Gu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?vS(t,n,i,null,e[++r]):vS(t,n,i,null,null))}}return t}function vS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var hA="ng-template";function C2(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&E2(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(r_(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function r_(t){return t.type===4&&t.value!==hA}function D2(t,e,n){let r=t.type===4&&!n?hA:t.value;return e===r}function T2(t,e,n){let r=4,i=t.attrs,s=i!==null?A2(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Ln(r)&&!Ln(u))return!1;if(o&&Ln(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!D2(t,u,n)||u===""&&e.length===1){if(Ln(r))return!1;o=!0}}else if(r&8){if(i===null||!C2(t,i,u,n)){if(Ln(r))return!1;o=!0}}else{let c=e[++a],l=b2(u,i,r_(t),n);if(l===-1){if(Ln(r))return!1;o=!0;continue}if(c!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&c!==d){if(Ln(r))return!1;o=!0}}}}return Ln(r)||o}function Ln(t){return(t&1)===0}function b2(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return x2(e,t)}function S2(t,e,n=!1){for(let r=0;r<e.length;r++)if(T2(t,e[r],n))return!0;return!1}function A2(t){for(let e=0;e<t.length;e++){let n=t[e];if(dA(n))return e}return t.length}function x2(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function _S(t,e){return t?":not("+e.trim()+")":e}function M2(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Ln(o)&&(e+=_S(s,i),i=""),r=o,s=s||!Ln(r);n++}return i!==""&&(e+=_S(s,i)),e}function R2(t){return t.map(M2).join(",")}function N2(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Ln(i))break;i=s}r++}return{attrs:e,classes:n}}function Zt(t){return ec(()=>{let e=yA(t),n=ye(b({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===lA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||sr.Emulated,styles:t.styles||In,_:null,schemas:t.schemas||null,tView:null,id:""});vA(n);let r=t.dependencies;return n.directiveDefs=ES(r,!1),n.pipeDefs=ES(r,!0),n.id=O2(n),n})}function P2(t){return vi(t)||fA(t)}function k2(t){return t!==null}function qe(t){return ec(()=>({type:t.type,bootstrap:t.bootstrap||In,declarations:t.declarations||In,imports:t.imports||In,exports:t.exports||In,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function wS(t,e){if(t==null)return Ho;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=nt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==nt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Oe(t){return ec(()=>{let e=yA(t);return vA(e),e})}function vi(t){return t[r2]||null}function fA(t){return t[i2]||null}function pA(t){return t[s2]||null}function gA(t){let e=vi(t)||fA(t)||pA(t);return e!==null?e.standalone:!1}function mA(t,e){let n=t[o2]||null;if(!n&&e===!0)throw new Error(`Type ${Ut(t)} does not have '\u0275mod' property.`);return n}function yA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ho,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||In,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:wS(t.inputs,e),outputs:wS(t.outputs),debugInfo:null}}function vA(t){t.features?.forEach(e=>e(t))}function ES(t,e){if(!t)return null;let n=e?pA:P2;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(k2)}function O2(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483647+1,"c"+e}function F2(...t){return{\u0275providers:_A(!0,t),\u0275fromNgModule:!0}}function _A(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return n_(e,o=>{let a=o;mv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&wA(i,s),n}function wA(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];i_(i,s=>{e(s,r)})}}function mv(t,e,n,r){if(t=Lt(t),!t)return!1;let i=null,s=pS(t),o=!s&&vi(t);if(!s&&!o){let u=t.ngModule;if(s=pS(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)mv(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{n_(s.imports,l=>{mv(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&wA(c,e)}if(!a){let c=$o(i)||(()=>new i);e({provide:i,useFactory:c,deps:In},i),e({provide:cA,useValue:i,multi:!0},i),e({provide:qo,useValue:()=>E(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;i_(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function i_(t,e){for(let n of t)rA(n)&&(n=n.\u0275providers),Array.isArray(n)?i_(n,e):e(n)}var V2=be({provide:String,useValue:be});function EA(t){return t!==null&&typeof t=="object"&&V2 in t}function L2(t){return!!(t&&t.useExisting)}function j2(t){return!!(t&&t.useFactory)}function Go(t){return typeof t=="function"}function U2(t){return!!t.useClass}var nf=new R(""),Th={},B2={},Jy;function s_(){return Jy===void 0&&(Jy=new Ph),Jy}var sn=class{},zu=class extends sn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,vv(e,o=>this.processProvider(o)),this.records.set(uA,Fo(void 0,this)),i.has("environment")&&this.records.set(sn,Fo(void 0,this));let s=this.records.get(nf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(cA,In,oe.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=we(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=mi(this),r=En(void 0),i;try{return e()}finally{mi(n),En(r)}}get(e,n=qu,r=oe.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(mS))return e[mS](this);r=tf(r);let i,s=mi(this),o=En(void 0);try{if(!(r&oe.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=z2(e)&&Jh(e);c&&this.injectableDefInScope(c)?u=Fo(yv(e),Th):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&oe.Self?s_():this.parent;return n=r&oe.Optional&&n===qu?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Rh]=a[Rh]||[]).unshift(Ut(e)),s)throw a;return m2(a,e,"R3InjectorError",this.source)}else throw a}finally{En(o),mi(s)}}resolveInjectorInitializers(){let e=we(null),n=mi(this),r=En(void 0),i;try{let s=this.get(qo,In,oe.Self);for(let o of s)o()}finally{mi(n),En(r),we(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Ut(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new L(205,!1)}processProvider(e){e=Lt(e);let n=Go(e)?e:Lt(e&&e.provide),r=H2(e);if(!Go(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Fo(void 0,Th,!0),i.factory=()=>pv(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=we(null);try{return n.value===Th&&(n.value=B2,n.value=n.factory()),typeof n.value=="object"&&n.value&&G2(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{we(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Lt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function yv(t){let e=Jh(t),n=e!==null?e.factory:$o(t);if(n!==null)return n;if(t instanceof R)throw new L(204,!1);if(t instanceof Function)return $2(t);throw new L(204,!1)}function $2(t){if(t.length>0)throw new L(204,!1);let n=t2(t);return n!==null?()=>n.factory(t):()=>new t}function H2(t){if(EA(t))return Fo(void 0,t.useValue);{let e=IA(t);return Fo(e,Th)}}function IA(t,e,n){let r;if(Go(t)){let i=Lt(t);return $o(i)||yv(i)}else if(EA(t))r=()=>Lt(t.useValue);else if(j2(t))r=()=>t.useFactory(...pv(t.deps||[]));else if(L2(t))r=()=>E(Lt(t.useExisting));else{let i=Lt(t&&(t.useClass||t.provide));if(q2(t))r=()=>new i(...pv(t.deps));else return $o(i)||yv(i)}return r}function Fo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function q2(t){return!!t.deps}function G2(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function z2(t){return typeof t=="function"||typeof t=="object"&&t instanceof R}function vv(t,e){for(let n of t)Array.isArray(n)?vv(n,e):n&&rA(n)?vv(n.\u0275providers,e):e(n)}function Br(t,e){t instanceof zu&&t.assertNotDestroyed();let n,r=mi(t),i=En(void 0);try{return e()}finally{mi(r),En(i)}}function CA(){return iA()!==void 0||f2()!=null}function W2(t){if(!CA())throw new L(-203,!1)}function K2(t){let e=jt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function Q2(t){return typeof t=="function"}var $r=0,he=1,G=2,xt=3,jn=4,Hn=5,kh=6,Wu=7,Un=8,zo=9,Bn=10,lt=11,Ku=12,IS=13,Zo=14,or=15,rf=16,Vo=17,Wo=18,sf=19,DA=20,yi=21,ev=22,vs=23,_i=25,TA=1;var _s=7,Oh=8,Fh=9,Cn=10,o_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(o_||{});function ms(t){return Array.isArray(t)&&typeof t[TA]=="object"}function Hr(t){return Array.isArray(t)&&t[TA]===!0}function bA(t){return(t.flags&4)!==0}function of(t){return t.componentOffset>-1}function a_(t){return(t.flags&1)===1}function wi(t){return!!t.template}function Y2(t){return(t[G]&512)!==0}var _v=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function SA(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function cr(){return AA}function AA(t){return t.type.prototype.ngOnChanges&&(t.setInput=X2),Z2}cr.ngInherit=!0;function Z2(){let t=MA(this),e=t?.current;if(e){let n=t.previous;if(n===Ho)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function X2(t,e,n,r,i){let s=this.declaredInputs[r],o=MA(t)||J2(t,{previous:Ho,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new _v(c&&c.currentValue,n,u===Ho),SA(t,e,i,n)}var xA="__ngSimpleChanges__";function MA(t){return t[xA]||null}function J2(t,e){return t[xA]=e}var CS=null;var rr=function(t,e,n){CS?.(t,e,n)},ej="svg",tj="math",nj=!1;function rj(){return nj}function ar(t){for(;Array.isArray(t);)t=t[$r];return t}function RA(t,e){return ar(e[t])}function Tn(t,e){return ar(e[t.index])}function NA(t,e){return t.data[e]}function Ii(t,e){let n=e[t];return ms(n)?n:n[$r]}function u_(t){return(t[G]&128)===128}function ij(t){return Hr(t[xt])}function Vh(t,e){return e==null?null:t[e]}function PA(t){t[Vo]=0}function sj(t){t[G]&1024||(t[G]|=1024,u_(t)&&Qu(t))}function oj(t,e){for(;t>0;)e=e[Zo],t--;return e}function c_(t){return!!(t[G]&9216||t[vs]?.dirty)}function wv(t){t[Bn].changeDetectionScheduler?.notify(1),c_(t)?Qu(t):t[G]&64&&(rj()?(t[G]|=1024,Qu(t)):t[Bn].changeDetectionScheduler?.notify())}function Qu(t){t[Bn].changeDetectionScheduler?.notify();let e=Yu(t);for(;e!==null&&!(e[G]&8192||(e[G]|=8192,!u_(e)));)e=Yu(e)}function kA(t,e){if((t[G]&256)===256)throw new L(911,!1);t[yi]===null&&(t[yi]=[]),t[yi].push(e)}function aj(t,e){if(t[yi]===null)return;let n=t[yi].indexOf(e);n!==-1&&t[yi].splice(n,1)}function Yu(t){let e=t[xt];return Hr(e)?e[xt]:e}var le={lFrame:HA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function uj(){return le.lFrame.elementDepthCount}function cj(){le.lFrame.elementDepthCount++}function lj(){le.lFrame.elementDepthCount--}function OA(){return le.bindingsEnabled}function dj(){return le.skipHydrationRootTNode!==null}function hj(t){return le.skipHydrationRootTNode===t}function fj(){le.skipHydrationRootTNode=null}function xe(){return le.lFrame.lView}function on(){return le.lFrame.tView}function FA(t){return le.lFrame.contextLView=t,t[Un]}function VA(t){return le.lFrame.contextLView=null,t}function Xt(){let t=LA();for(;t!==null&&t.type===64;)t=t.parent;return t}function LA(){return le.lFrame.currentTNode}function pj(){let t=le.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function nc(t,e){let n=le.lFrame;n.currentTNode=t,n.isParent=e}function jA(){return le.lFrame.isParent}function gj(){le.lFrame.isParent=!1}function mj(){let t=le.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function yj(t){return le.lFrame.bindingIndex=t}function af(){return le.lFrame.bindingIndex++}function vj(t){let e=le.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function _j(){return le.lFrame.inI18n}function wj(t,e){let n=le.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ev(e)}function Ej(){return le.lFrame.currentDirectiveIndex}function Ev(t){le.lFrame.currentDirectiveIndex=t}function Ij(t){let e=le.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function UA(t){le.lFrame.currentQueryIndex=t}function Cj(t){let e=t[he];return e.type===2?e.declTNode:e.type===1?t[Hn]:null}function BA(t,e,n){if(n&oe.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&oe.Host);)if(i=Cj(s),i===null||(s=s[Zo],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=le.lFrame=$A();return r.currentTNode=e,r.lView=t,!0}function l_(t){let e=$A(),n=t[he];le.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function $A(){let t=le.lFrame,e=t===null?null:t.child;return e===null?HA(t):e}function HA(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function qA(){let t=le.lFrame;return le.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var GA=qA;function d_(){let t=qA();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Dj(t){return(le.lFrame.contextLView=oj(t,le.lFrame.contextLView))[Un]}function Xo(){return le.lFrame.selectedIndex}function ws(t){le.lFrame.selectedIndex=t}function h_(){let t=le.lFrame;return NA(t.tView,t.selectedIndex)}function Tj(){return le.lFrame.currentNamespace}var zA=!0;function f_(){return zA}function p_(t){zA=t}function bj(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=AA(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function g_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function bh(t,e,n){WA(t,e,3,n)}function Sh(t,e,n,r){(t[G]&3)===n&&WA(t,e,n,r)}function tv(t,e){let n=t[G];(n&3)===e&&(n&=16383,n+=1,t[G]=n)}function WA(t,e,n,r){let i=r!==void 0?t[Vo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[Vo]+=65536),(a<s||s==-1)&&(Sj(t,n,e,u),t[Vo]=(t[Vo]&4294901760)+u+2),u++}function DS(t,e){rr(4,t,e);let n=we(null);try{e.call(t)}finally{we(n),rr(5,t,e)}}function Sj(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[G]>>14<t[Vo]>>16&&(t[G]&3)===e&&(t[G]+=16384,DS(a,s)):DS(a,s)}var Bo=-1,Es=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function Aj(t){return t instanceof Es}function xj(t){return(t.flags&8)!==0}function Mj(t){return(t.flags&16)!==0}function KA(t){return t!==Bo}function Lh(t){return t&32767}function Rj(t){return t>>16}function jh(t,e){let n=Rj(t),r=e;for(;n>0;)r=r[Zo],n--;return r}var Iv=!0;function TS(t){let e=Iv;return Iv=t,e}var Nj=256,QA=Nj-1,YA=5,Pj=0,ir={};function kj(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty($u)&&(r=n[$u]),r==null&&(r=n[$u]=Pj++);let i=r&QA,s=1<<i;e.data[t+(i>>YA)]|=s}function Uh(t,e){let n=ZA(t,e);if(n!==-1)return n;let r=e[he];r.firstCreatePass&&(t.injectorIndex=e.length,nv(r.data,t),nv(e,null),nv(r.blueprint,null));let i=m_(t,e),s=t.injectorIndex;if(KA(i)){let o=Lh(i),a=jh(i,e),u=a[he].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function nv(t,e){t.push(0,0,0,0,0,0,0,0,e)}function ZA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function m_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=nx(i),r===null)return Bo;if(n++,i=i[Zo],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Bo}function Cv(t,e,n){kj(t,e,n)}function Oj(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(dA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function XA(t,e,n){if(n&oe.Optional||t!==void 0)return t;e_(e,"NodeInjector")}function JA(t,e,n,r){if(n&oe.Optional&&r===void 0&&(r=null),!(n&(oe.Self|oe.Host))){let i=t[zo],s=En(void 0);try{return i?i.get(e,r,n&oe.Optional):sA(e,r,n&oe.Optional)}finally{En(s)}}return XA(r,e,n)}function ex(t,e,n,r=oe.Default,i){if(t!==null){if(e[G]&2048&&!(r&oe.Self)){let o=Uj(t,e,n,r,ir);if(o!==ir)return o}let s=tx(t,e,n,r,ir);if(s!==ir)return s}return JA(e,n,r,i)}function tx(t,e,n,r,i){let s=Lj(n);if(typeof s=="function"){if(!BA(e,t,r))return r&oe.Host?XA(i,n,r):JA(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&oe.Optional))e_(n);else return o}finally{GA()}}else if(typeof s=="number"){let o=null,a=ZA(t,e),u=Bo,c=r&oe.Host?e[or][Hn]:null;for((a===-1||r&oe.SkipSelf)&&(u=a===-1?m_(t,e):e[a+8],u===Bo||!SS(r,!1)?a=-1:(o=e[he],a=Lh(u),e=jh(u,e)));a!==-1;){let l=e[he];if(bS(s,a,l.data)){let d=Fj(a,e,n,o,r,c);if(d!==ir)return d}u=e[a+8],u!==Bo&&SS(r,e[he].data[a+8]===c)&&bS(s,a,e)?(o=l,a=Lh(u),e=jh(u,e)):a=-1}}return i}function Fj(t,e,n,r,i,s){let o=e[he],a=o.data[t+8],u=r==null?of(a)&&Iv:r!=o&&(a.type&3)!==0,c=i&oe.Host&&s===a,l=Vj(a,o,n,u,c);return l!==null?Ko(e,o,l,a):ir}function Vj(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&wi(f)&&f.type===n)return u}return null}function Ko(t,e,n,r){let i=t[n],s=e.data;if(Aj(i)){let o=i;o.resolving&&u2(a2(s[n]));let a=TS(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?En(o.injectImpl):null,l=BA(t,r,oe.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&bj(n,s[n],e)}finally{c!==null&&En(c),TS(a),o.resolving=!1,GA()}}return i}function Lj(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty($u)?t[$u]:void 0;return typeof e=="number"?e>=0?e&QA:jj:e}function bS(t,e,n){let r=1<<t;return!!(n[e+(t>>YA)]&r)}function SS(t,e){return!(t&oe.Self)&&!(t&oe.Host&&e)}var ys=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return ex(this._tNode,this._lView,e,tf(r),n)}};function jj(){return new ys(Xt(),xe())}function qr(t){return ec(()=>{let e=t.prototype.constructor,n=e[Mh]||Dv(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Mh]||Dv(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Dv(t){return JS(t)?()=>{let e=Dv(Lt(t));return e&&e()}:$o(t)}function Uj(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[G]&2048&&!(o[G]&512);){let a=tx(s,o,n,r|oe.Self,ir);if(a!==ir)return a;let u=s.parent;if(!u){let c=o[DA];if(c){let l=c.get(n,ir,r);if(l!==ir)return l}u=nx(o),o=o[Zo]}s=u}return i}function nx(t){let e=t[he],n=e.type;return n===2?e.declTNode:n===1?t[Hn]:null}function y_(t){return Oj(Xt(),t)}function AS(t,e=null,n=null,r){let i=rx(t,e,n,r);return i.resolveInjectorInitializers(),i}function rx(t,e=null,n=null,r,i=new Set){let s=[n||In,F2(t)];return r=r||(typeof t=="object"?void 0:Ut(t)),new zu(s,e||s_(),r||null,i)}var an=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return AS({name:""},i,r,"");{let s=r.name??"";return AS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=qu,e.NULL=new Ph,e.\u0275prov=N({token:e,providedIn:"any",factory:()=>E(uA)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var Bj="ngOriginalError";function rv(t){return t[Bj]}var ur=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&rv(e);for(;n&&rv(n);)n=rv(n);return n||null}},ix=new R("",{providedIn:"root",factory:()=>M(ur).handleError.bind(void 0)}),v_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=$j,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Tv=class extends v_{constructor(e){super(),this._lView=e}onDestroy(e){return kA(this._lView,e),()=>aj(this._lView,e)}};function $j(){return new Tv(xe())}function Hj(){return uf(Xt(),xe())}function uf(t,e){return new lr(Tn(t,e))}var lr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=Hj;let t=e;return t})();var bv=class extends Be{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,CA()&&(this.destroyRef=M(v_,{optional:!0})??void 0)}emit(e){let n=we(null);try{super.next(e)}finally{we(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=iv(s),i&&(i=iv(i)),o&&(o=iv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ye&&e.add(a),a}};function iv(t){return e=>{setTimeout(t,void 0,e)}}var $e=bv;function sx(t){return(t.flags&128)===128}var ox=new Map,qj=0;function Gj(){return qj++}function zj(t){ox.set(t[sf],t)}function Wj(t){ox.delete(t[sf])}var xS="__ngContext__";function Is(t,e){ms(e)?(t[xS]=e[sf],zj(e)):t[xS]=e}function ax(t){return cx(t[Ku])}function ux(t){return cx(t[jn])}function cx(t){for(;t!==null&&!Hr(t);)t=t[jn];return t}var Sv;function lx(t){Sv=t}function Kj(){if(Sv!==void 0)return Sv;if(typeof document<"u")return document;throw new L(210,!1)}var cf=new R("",{providedIn:"root",factory:()=>Qj}),Qj="ng",__=new R(""),Mt=new R("",{providedIn:"platform",factory:()=>"unknown"});var w_=new R("",{providedIn:"root",factory:()=>Kj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Yj="h",Zj="b";var Xj=()=>null;function E_(t,e,n=!1){return Xj(t,e,n)}var dx=!1,Jj=new R("",{providedIn:"root",factory:()=>dx});var Eh;function eU(){if(Eh===void 0&&(Eh=null,jt.trustedTypes))try{Eh=jt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Eh}function MS(t){return eU()?.createScriptURL(t)||t}var Bh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ZS})`}};function rc(t){return t instanceof Bh?t.changingThisBreaksApplicationSecurity:t}function I_(t,e){let n=tU(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${ZS})`)}return n===e}function tU(t){return t instanceof Bh&&t.getTypeName()||null}var nU=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function hx(t){return t=String(t),t.match(nU)?t:"unsafe:"+t}var lf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(lf||{});function rU(t){let e=px();return e?e.sanitize(lf.URL,t)||"":I_(t,"URL")?rc(t):hx(ef(t))}function iU(t){let e=px();if(e)return MS(e.sanitize(lf.RESOURCE_URL,t)||"");if(I_(t,"ResourceURL"))return MS(rc(t));throw new L(904,!1)}function sU(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?iU:rU}function fx(t,e,n){return sU(e,n)(t)}function px(){let t=xe();return t&&t[Bn].sanitizer}function gx(t){return t instanceof Function?t():t}function oU(t){return(t??M(an)).get(Mt)==="browser"}var jr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(jr||{}),aU;function C_(t,e){return aU(t,e)}function Lo(t,e,n,r,i){if(r!=null){let s,o=!1;Hr(r)?s=r:ms(r)&&(o=!0,r=r[$r]);let a=ar(r);t===0&&n!==null?i==null?wx(e,n,a):$h(e,n,a,i||null,!0):t===1&&n!==null?$h(e,n,a,i||null,!0):t===2?DU(e,a,o):t===3&&e.destroyNode(a),s!=null&&bU(e,t,s,n,i)}}function uU(t,e){return t.createText(e)}function cU(t,e,n){t.setValue(e,n)}function mx(t,e,n){return t.createElement(e,n)}function lU(t,e){yx(t,e),e[$r]=null,e[Hn]=null}function dU(t,e,n,r,i,s){r[$r]=i,r[Hn]=e,df(t,r,n,1,i,s)}function yx(t,e){e[Bn].changeDetectionScheduler?.notify(1),df(t,e,e[lt],2,null,null)}function hU(t){let e=t[Ku];if(!e)return sv(t[he],t);for(;e;){let n=null;if(ms(e))n=e[Ku];else{let r=e[Cn];r&&(n=r)}if(!n){for(;e&&!e[jn]&&e!==t;)ms(e)&&sv(e[he],e),e=e[xt];e===null&&(e=t),ms(e)&&sv(e[he],e),n=e&&e[jn]}e=n}}function fU(t,e,n,r){let i=Cn+r,s=n.length;r>0&&(n[i-1][jn]=e),r<s-Cn?(e[jn]=n[i],aA(n,Cn+r,e)):(n.push(e),e[jn]=null),e[xt]=n;let o=e[rf];o!==null&&n!==o&&pU(o,e);let a=e[Wo];a!==null&&a.insertView(t),wv(e),e[G]|=128}function pU(t,e){let n=t[Fh],i=e[xt][xt][or];e[or]!==i&&(t[G]|=o_.HasTransplantedViews),n===null?t[Fh]=[e]:n.push(e)}function vx(t,e){let n=t[Fh],r=n.indexOf(e);n.splice(r,1)}function Av(t,e){if(t.length<=Cn)return;let n=Cn+e,r=t[n];if(r){let i=r[rf];i!==null&&i!==t&&vx(i,r),e>0&&(t[n-1][jn]=r[jn]);let s=Nh(t,Cn+e);lU(r[he],r);let o=s[Wo];o!==null&&o.detachView(s[he]),r[xt]=null,r[jn]=null,r[G]&=-129}return r}function _x(t,e){if(!(e[G]&256)){let n=e[lt];n.destroyNode&&df(t,e,n,3,null,null),hU(e)}}function sv(t,e){if(e[G]&256)return;let n=we(null);try{e[G]&=-129,e[G]|=256,e[vs]&&qb(e[vs]),mU(t,e),gU(t,e),e[he].type===1&&e[lt].destroy();let r=e[rf];if(r!==null&&Hr(e[xt])){r!==e[xt]&&vx(r,e);let i=e[Wo];i!==null&&i.detachView(t)}Wj(e)}finally{we(n)}}function gU(t,e){let n=t.cleanup,r=e[Wu];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Wu]=null);let i=e[yi];if(i!==null){e[yi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function mU(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Es)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];rr(4,a,u);try{u.call(a)}finally{rr(5,a,u)}}else{rr(4,i,s);try{s.call(i)}finally{rr(5,i,s)}}}}}function yU(t,e,n){return vU(t,e.parent,n)}function vU(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[$r];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===sr.None||s===sr.Emulated)return null}return Tn(r,n)}}function $h(t,e,n,r,i){t.insertBefore(e,n,r,i)}function wx(t,e,n){t.appendChild(e,n)}function RS(t,e,n,r,i){r!==null?$h(t,e,n,r,i):wx(t,e,n)}function _U(t,e,n,r){t.removeChild(e,n,r)}function D_(t,e){return t.parentNode(e)}function wU(t,e){return t.nextSibling(e)}function EU(t,e,n){return CU(t,e,n)}function IU(t,e,n){return t.type&40?Tn(t,n):null}var CU=IU,NS;function T_(t,e,n,r){let i=yU(t,r,e),s=e[lt],o=r.parent||e[Hn],a=EU(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)RS(s,i,n[u],a,!1);else RS(s,i,n,a,!1);NS!==void 0&&NS(s,r,e,n,i)}function Ah(t,e){if(e!==null){let n=e.type;if(n&3)return Tn(e,t);if(n&4)return xv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ah(t,r);{let i=t[e.index];return Hr(i)?xv(-1,i):ar(i)}}else{if(n&32)return C_(e,t)()||ar(t[e.index]);{let r=Ex(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Yu(t[or]);return Ah(i,r)}else return Ah(t,e.next)}}}return null}function Ex(t,e){if(e!==null){let r=t[or][Hn],i=e.projection;return r.projection[i]}return null}function xv(t,e){let n=Cn+t+1;if(n<e.length){let r=e[n],i=r[he].firstChild;if(i!==null)return Ah(r,i)}return e[_s]}function DU(t,e,n){let r=D_(t,e);r&&_U(t,r,e,n)}function b_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&Is(ar(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)b_(t,e,n.child,r,i,s,!1),Lo(e,t,i,a,s);else if(u&32){let c=C_(n,r),l;for(;l=c();)Lo(e,t,i,l,s);Lo(e,t,i,a,s)}else u&16?TU(t,e,r,n,i,s):Lo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function df(t,e,n,r,i,s){b_(n,r,t.firstChild,e,i,s,!1)}function TU(t,e,n,r,i,s){let o=n[or],u=o[Hn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];Lo(e,t,i,l,s)}else{let c=u,l=o[xt];sx(r)&&(c.flags|=128),b_(t,e,c,l,i,s,!0)}}function bU(t,e,n,r,i){let s=n[_s],o=ar(n);s!==o&&Lo(e,t,r,s,i);for(let a=Cn;a<n.length;a++){let u=n[a];df(u[he],u,t,e,r,s)}}function SU(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:jr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=jr.Important),t.setStyle(n,r,i,s))}}function AU(t,e,n){t.setAttribute(e,"style",n)}function Ix(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Cx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&gv(t,e,r),i!==null&&Ix(t,e,i),s!==null&&AU(t,e,s)}var Ts={};function Le(t=1){Dx(on(),xe(),Xo()+t,!1)}function Dx(t,e,n,r){if(!r)if((e[G]&3)===3){let s=t.preOrderCheckHooks;s!==null&&bh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Sh(e,s,0,n)}ws(n)}function j(t,e=oe.Default){let n=xe();if(n===null)return E(t,e);let r=Xt();return ex(r,n,Lt(t),e)}function Tx(){let t="invalid";throw new Error(t)}function bx(t,e,n,r,i,s){let o=we(null);try{let a=null;i&nt.SignalBased&&(a=e[r][xy]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&nt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):SA(e,a,r,s)}finally{we(o)}}function xU(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ws(~i);else{let s=i,o=n[++r],a=n[++r];wj(o,s);let u=e[s];a(2,u)}}}finally{ws(-1)}}function hf(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[$r]=i,d[G]=r|4|128|8|64,(c!==null||t&&t[G]&2048)&&(d[G]|=2048),PA(d),d[xt]=d[Zo]=t,d[Un]=n,d[Bn]=o||t&&t[Bn],d[lt]=a||t&&t[lt],d[zo]=u||t&&t[zo]||null,d[Hn]=s,d[sf]=Gj(),d[kh]=l,d[DA]=c,d[or]=e.type==2?t[or]:d,d}function ff(t,e,n,r,i){let s=t.data[e];if(s===null)s=MU(t,e,n,r,i),_j()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=pj();s.injectorIndex=o===null?-1:o.injectorIndex}return nc(s,!0),s}function MU(t,e,n,r,i){let s=LA(),o=jA(),a=o?s:s&&s.parent,u=t.data[e]=OU(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function Sx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Ax(t,e,n,r,i){let s=Xo(),o=r&2;try{ws(-1),o&&e.length>_i&&Dx(t,e,_i,!1),rr(o?2:0,i),n(r,i)}finally{ws(s),rr(o?3:1,i)}}function xx(t,e,n){if(bA(e)){let r=we(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let u=n[o];a.contentQueries(1,u,o)}}}finally{we(r)}}}function Mx(t,e,n){OA()&&(BU(t,e,n,Tn(n,e)),(n.flags&64)===64&&Fx(t,e,n))}function Rx(t,e,n=Tn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Nx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=S_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function S_(t,e,n,r,i,s,o,a,u,c,l){let d=_i+r,h=d+i,f=RU(d,h),p=typeof c=="function"?c():c;return f[he]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function RU(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ts);return n}function NU(t,e,n,r){let s=r.get(Jj,dx)||n===sr.ShadowDom,o=t.selectRootElement(e,s);return PU(o),o}function PU(t){kU(t)}var kU=()=>null;function OU(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return dj()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function PS(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=nt.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?kS(r,n,c,a,u):kS(r,n,c,a)}return r}function kS(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function FU(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=PS(0,d.inputs,l,u,f),c=PS(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!r_(e)?XU(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function VU(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Px(t,e,n,r,i,s,o,a){let u=Tn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(A_(t,n,l,r,i),of(e)&&LU(n,e.index)):e.type&3?(r=VU(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function LU(t,e){let n=Ii(e,t);n[G]&16||(n[G]|=64)}function kx(t,e,n,r){if(OA()){let i=r===null?null:{"":-1},s=HU(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Ox(t,e,n,o,i,a),i&&qU(n,r,i)}n.mergedAttrs=Gu(n.mergedAttrs,n.attrs)}function Ox(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Cv(Uh(n,e),t,r[c].type);zU(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=Sx(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Gu(n.mergedAttrs,l.hostAttrs),WU(t,n,e,u,l),GU(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}FU(t,n,s)}function jU(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;UU(o)!=a&&o.push(a),o.push(n,r,s)}}function UU(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function BU(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;of(n)&&KU(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Uh(n,e),Is(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Ko(e,t,a,n);if(Is(c,e),o!==null&&ZU(e,a-i,c,u,n,o),wi(u)){let l=Ii(n.index,e);l[Un]=Ko(e,t,a,n)}}}function Fx(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Ej();try{ws(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];Ev(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&$U(u,c)}}finally{ws(-1),Ev(o)}}function $U(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function HU(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(S2(e,o.selectors,!1))if(r||(r=[]),wi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Mv(t,e,u)}else r.unshift(o),Mv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Mv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function qU(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new L(-301,!1);r.push(e[i],s)}}}function GU(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;wi(e)&&(n[""]=t)}}function zU(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function WU(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=$o(i.type,!0)),o=new Es(s,wi(i),j);t.blueprint[r]=o,n[r]=o,jU(t,e,r,Sx(t,n,i.hostVars,Ts),i)}function KU(t,e,n){let r=Tn(e,t),i=Nx(n),s=t[Bn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=pf(t,hf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function QU(t,e,n,r,i,s){let o=Tn(t,e);YU(e[lt],o,s,t.value,n,r,i)}function YU(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?ef(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function ZU(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];bx(r,n,u,c,l,d)}}function XU(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function Vx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Lx(t,e){let n=t.contentQueries;if(n!==null){let r=we(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];UA(s),a.contentQueries(2,e[o],o)}}}finally{we(r)}}}function pf(t,e){return t[Ku]?t[IS][jn]=e:t[Ku]=e,t[IS]=e,e}function Rv(t,e,n){UA(0);let r=we(null);try{e(t,n)}finally{we(r)}}function JU(t){return t[Wu]||(t[Wu]=[])}function eB(t){return t.cleanup||(t.cleanup=[])}function jx(t,e){let n=t[zo],r=n?n.get(ur,null):null;r&&r.handleError(e)}function A_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];bx(l,c,r,a,u,i)}}function tB(t,e,n){let r=RA(e,t);cU(t[lt],r,n)}function nB(t,e){let n=Ii(e,t),r=n[he];rB(r,n);let i=n[$r];i!==null&&n[kh]===null&&(n[kh]=E_(i,n[zo])),x_(r,n,n[Un])}function rB(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function x_(t,e,n){l_(e);try{let r=t.viewQuery;r!==null&&Rv(1,r,n);let i=t.template;i!==null&&Ax(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Wo]?.finishViewCreation(t),t.staticContentQueries&&Lx(t,e),t.staticViewQueries&&Rv(2,t.viewQuery,n);let s=t.components;s!==null&&iB(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[G]&=-5,d_()}}function iB(t,e){for(let n=0;n<e.length;n++)nB(t,e[n])}function sB(t,e,n,r){let i=we(null);try{let s=e.tView,a=t[G]&4096?4096:16,u=hf(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[e.index];u[rf]=c;let l=t[Wo];return l!==null&&(u[Wo]=l.createEmbeddedView(s)),x_(s,u,n),u}finally{we(i)}}function OS(t,e){return!e||e.firstChild===null||sx(t)}function oB(t,e,n,r=!0){let i=e[he];if(fU(i,e,t,n),r){let o=xv(n,t),a=e[lt],u=D_(a,t[_s]);u!==null&&dU(i,t[Hn],a,e,u,o)}let s=e[kh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Hh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(ar(s)),Hr(s)&&aB(s,r);let o=n.type;if(o&8)Hh(t,e,n.child,r);else if(o&32){let a=C_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=Ex(e,n);if(Array.isArray(a))r.push(...a);else{let u=Yu(e[or]);Hh(u[he],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function aB(t,e){for(let n=Cn;n<t.length;n++){let r=t[n],i=r[he].firstChild;i!==null&&Hh(r[he],r,i,e)}t[_s]!==t[$r]&&e.push(t[_s])}var Ux=[];function uB(t){return t[vs]??cB(t)}function cB(t){let e=Ux.pop()??Object.create(dB);return e.lView=t,e}function lB(t){t.lView[vs]!==t&&(t.lView=null,Ux.push(t))}var dB=ye(b({},Bb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Qu(t.lView)},consumerOnSignalRead(){this.lView[vs]=this}}),Bx=100;function $x(t,e=!0,n=0){let r=t[Bn],i=r.rendererFactory,s=!1;s||i.begin?.();try{hB(t,n)}catch(o){throw e&&jx(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function hB(t,e){Nv(t,e);let n=0;for(;c_(t);){if(n===Bx)throw new L(103,!1);n++,Nv(t,1)}}function fB(t,e,n,r){let i=e[G];if((i&256)===256)return;let s=!1;!s&&e[Bn].inlineEffectRunner?.flush(),l_(e);let o=null,a=null;!s&&pB(t)&&(a=uB(e),o=$b(a));try{PA(e),yj(t.bindingStartIndex),n!==null&&Ax(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&bh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Sh(e,d,0,null),tv(e,0)}if(gB(e),Hx(e,0),t.contentQueries!==null&&Lx(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&bh(e,d)}else{let d=t.contentHooks;d!==null&&Sh(e,d,1),tv(e,1)}xU(t,e);let c=t.components;c!==null&&Gx(e,c,0);let l=t.viewQuery;if(l!==null&&Rv(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&bh(e,d)}else{let d=t.viewHooks;d!==null&&Sh(e,d,2),tv(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[ev]){for(let d of e[ev])d();e[ev]=null}s||(e[G]&=-73)}catch(u){throw Qu(e),u}finally{a!==null&&(Hb(a,o),lB(a)),d_()}}function pB(t){return t.type!==2}function Hx(t,e){for(let n=ax(t);n!==null;n=ux(n))for(let r=Cn;r<n.length;r++){let i=n[r];qx(i,e)}}function gB(t){for(let e=ax(t);e!==null;e=ux(e)){if(!(e[G]&o_.HasTransplantedViews))continue;let n=e[Fh];for(let r=0;r<n.length;r++){let i=n[r],s=i[xt];sj(i)}}}function mB(t,e,n){let r=Ii(e,t);qx(r,n)}function qx(t,e){u_(t)&&Nv(t,e)}function Nv(t,e){let r=t[he],i=t[G],s=t[vs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&My(s)),s&&(s.dirty=!1),t[G]&=-9217,o)fB(r,t,r.template,t[Un]);else if(i&8192){Hx(t,1);let a=r.components;a!==null&&Gx(t,a,1)}}function Gx(t,e,n){for(let r=0;r<e.length;r++)mB(t,e[r],n)}function M_(t){for(t[Bn].changeDetectionScheduler?.notify();t;){t[G]|=64;let e=Yu(t);if(Y2(t)&&!e)return t;t=e}return null}var Cs=class{get rootNodes(){let e=this._lView,n=e[he];return Hh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Un]}set context(e){this._lView[Un]=e}get destroyed(){return(this._lView[G]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[xt];if(Hr(e)){let n=e[Oh],r=n?n.indexOf(this):-1;r>-1&&(Av(e,r),Nh(n,r))}this._attachedToViewContainer=!1}_x(this._lView[he],this._lView)}onDestroy(e){kA(this._lView,e)}markForCheck(){M_(this._cdRefInjectingView||this._lView)}detach(){this._lView[G]&=-129}reattach(){wv(this._lView),this._lView[G]|=128}detectChanges(){this._lView[G]|=1024,$x(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new L(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,yx(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new L(902,!1);this._appRef=e,wv(this._lView)}},gf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=_B;let t=e;return t})(),yB=gf,vB=class extends yB{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=sB(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new Cs(i)}};function _B(){return wB(Xt(),xe())}function wB(t,e){return t.type&4?new vB(e,t,uf(t,e)):null}var Bee=new RegExp(`^(\\d+)*(${Zj}|${Yj})*(.*)`);var EB=()=>null;function FS(t,e){return EB(t,e)}var qh=class{},Pv=class{},Gh=class{};function IB(t){let e=Error(`No component factory found for ${Ut(t)}.`);return e[CB]=t,e}var CB="ngComponent";var kv=class{resolveComponentFactory(e){throw IB(e)}},mf=(()=>{let e=class e{};e.NULL=new kv;let t=e;return t})(),Zu=class{},Gr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>DB();let t=e;return t})();function DB(){let t=xe(),e=Xt(),n=Ii(e.index,t);return(ms(n)?n:t)[lt]}var TB=(()=>{let e=class e{};e.\u0275prov=N({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),ov={};var VS=new Set;function R_(t){VS.has(t)||(VS.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function LS(...t){}function bB(){let t=typeof jt.requestAnimationFrame=="function",e=jt[t?"requestAnimationFrame":"setTimeout"],n=jt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var ae=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $e(!1),this.onMicrotaskEmpty=new $e(!1),this.onStable=new $e(!1),this.onError=new $e(!1),typeof Zone>"u")throw new L(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=bB().nativeRequestAnimationFrame,xB(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new L(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new L(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,SB,LS,LS);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},SB={};function N_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function AB(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(jt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Ov(t),t.isCheckStableRunning=!0,N_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Ov(t))}function xB(t){let e=()=>{AB(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(MB(a))return n.invokeTask(i,s,o,a);try{return jS(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),US(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return jS(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),US(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Ov(t),N_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Ov(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function jS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function US(t){t._nesting--,N_(t)}var Fv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $e,this.onMicrotaskEmpty=new $e,this.onStable=new $e,this.onError=new $e}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function MB(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function RB(t="zone.js",e){return t==="noop"?new Fv:t==="zone.js"?new ae(e):t}var jo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(jo||{}),NB={destroy(){}};function P_(t,e){!e&&W2(P_);let n=e?.injector??M(an);if(!oU(n))return NB;R_("NgAfterNextRender");let r=n.get(k_),i=r.handler??=new Lv,s=e?.phase??jo.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(v_).onDestroy(o),u=Br(n,()=>new Vv(s,()=>{o(),t()}));return i.register(u),{destroy:o}}var Vv=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=M(ae),this.errorHandler=M(ur,{optional:!0}),M(qh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Lv=class{constructor(){this.executingCallbacks=!1,this.buckets={[jo.EarlyRead]:new Set,[jo.Write]:new Set,[jo.MixedReadWrite]:new Set,[jo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},k_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=N({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function jv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=hS(i,a);else if(s==2){let u=a,c=e[++o];r=hS(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var zh=class extends mf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=vi(e);return new Qo(n,this.ngModule)}};function BS(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function PB(t){let e=t.toLowerCase();return e==="svg"?ej:e==="math"?tj:null}var Uv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=tf(r);let i=this.injector.get(e,ov,r);return i!==ov||n===ov?i:this.parentInjector.get(e,n,r)}},Qo=class extends Gh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=BS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return BS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=R2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=we(null);try{i=i||this.ngModule;let o=i instanceof sn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Uv(e,o):e,u=a.get(Zu,null);if(u===null)throw new L(407,!1);let c=a.get(TB,null),l=a.get(k_,null),d=a.get(qh,null),h={rendererFactory:u,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=u.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?NU(f,r,this.componentDef.encapsulation,a):mx(f,p,PB(p)),_=512;this.componentDef.signals?_|=4096:this.componentDef.onPush||(_|=16);let C=null;g!==null&&(C=E_(g,a,!0));let k=S_(0,null,null,1,0,null,null,null,null,null,null),T=hf(null,k,null,_,null,null,h,f,a,null,C);l_(T);let H,z;try{let Y=this.componentDef,De,Kt=null;Y.findHostDirectiveDefs?(De=[],Kt=new Map,Y.findHostDirectiveDefs(Y,De,Kt),De.push(Y)):De=[Y];let wy=kB(T,g),Fd=OB(wy,g,Y,De,T,h,f);z=NA(k,_i),g&&LB(f,Y,g,r),n!==void 0&&jB(z,this.ngContentSelectors,n),H=VB(Fd,Y,De,Kt,T,[UB]),x_(k,T,null)}finally{d_()}return new Bv(this.componentType,H,uf(z,T),T,z)}finally{we(s)}}},Bv=class extends Pv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Cs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;A_(s[he],s,i,e,n),this.previousInputValues.set(e,n);let o=Ii(this._tNode.index,s);M_(o)}}get injector(){return new ys(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function kB(t,e){let n=t[he],r=_i;return t[r]=e,ff(n,r,2,"#host",null)}function OB(t,e,n,r,i,s,o){let a=i[he];FB(r,t,e,o);let u=null;e!==null&&(u=E_(e,i[zo]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=hf(i,Nx(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Mv(a,t,r.length-1),pf(i,d),i[t.index]=d}function FB(t,e,n,r){for(let i of t)e.mergedAttrs=Gu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(jv(e,e.mergedAttrs,!0),n!==null&&Cx(r,n,e))}function VB(t,e,n,r,i,s){let o=Xt(),a=i[he],u=Tn(o,i);Ox(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Ko(i,a,d,o);Is(h,i)}Fx(a,i,o),u&&Is(u,i);let c=Ko(i,a,o.directiveStart+o.componentOffset,o);if(t[Un]=i[Un]=c,s!==null)for(let l of s)l(c,e);return xx(a,o,i),c}function LB(t,e,n,r){if(r)gv(t,n,["ng-version","17.3.3"]);else{let{attrs:i,classes:s}=N2(e.selectors[0]);i&&gv(t,n,i),s&&s.length>0&&Ix(t,n,s.join(" "))}}function jB(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function UB(){let t=Xt();g_(xe()[he],t)}var Jo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=BB;let t=e;return t})();function BB(){let t=Xt();return HB(t,xe())}var $B=Jo,zx=class extends $B{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return uf(this._hostTNode,this._hostLView)}get injector(){return new ys(this._hostTNode,this._hostLView)}get parentInjector(){let e=m_(this._hostTNode,this._hostLView);if(KA(e)){let n=jh(e,this._hostLView),r=Lh(e),i=n[he].data[r+8];return new ys(i,n)}else return new ys(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=$S(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Cn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=FS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,OS(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!Q2(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new Qo(vi(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(sn,null);g&&(s=g)}let l=vi(u.componentType??{}),d=FS(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,OS(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(ij(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[xt],c=new zx(u,u[Hn],u[xt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return oB(o,i,s,r),e.attachToViewContainerRef(),aA(av(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=$S(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Av(this._lContainer,n);r&&(Nh(av(this._lContainer),n),_x(r[he],r))}detach(e){let n=this._adjustIndex(e,-1),r=Av(this._lContainer,n);return r&&Nh(av(this._lContainer),n)!=null?new Cs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function $S(t){return t[Oh]}function av(t){return t[Oh]||(t[Oh]=[])}function HB(t,e){let n,r=e[t.index];return Hr(r)?n=r:(n=Vx(r,e,null,t),e[t.index]=n,pf(e,n)),GB(n,e,t,r),new zx(n,t,e)}function qB(t,e){let n=t[lt],r=n.createComment(""),i=Tn(e,t),s=D_(n,i);return $h(n,s,r,wU(n,i),!1),r}var GB=KB,zB=()=>!1;function WB(t,e,n){return zB(t,e,n)}function KB(t,e,n,r){if(t[_s])return;let i;n.type&8?i=ar(r):i=qB(e,n),t[_s]=i}function QB(t){return typeof t=="function"&&t[xy]!==void 0}function Wx(t){return QB(t)&&typeof t.set=="function"}function YB(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(e$))}return s}return Wh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>t$(s));e.push(u)}),XB(),Promise.all(e).then(()=>{})}var Wh=new Map,ZB=new Set;function XB(){let t=Wh;return Wh=new Map,t}function JB(){return Wh.size===0}function e$(t){return typeof t=="string"?t:t.text()}function t$(t){ZB.delete(t)}function n$(t){return Object.getPrototypeOf(t.prototype).constructor}function Jt(t){let e=n$(t.type),n=!0,r=[t];for(;e;){let i;if(wi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new L(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Ih(t.inputs),o.inputTransforms=Ih(t.inputTransforms),o.declaredInputs=Ih(t.declaredInputs),o.outputs=Ih(t.outputs);let a=i.hostBindings;a&&a$(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&s$(t,u),c&&o$(t,c),r$(t,i),JL(t.outputs,i.outputs),wi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Jt&&(n=!1)}}e=Object.getPrototypeOf(e)}i$(r)}function r$(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function i$(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Gu(i.hostAttrs,n=Gu(n,i.hostAttrs))}}function Ih(t){return t===Ho?{}:t===In?[]:t}function s$(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function o$(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function a$(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function O_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ei=class{},Xu=class{};var Kh=class extends Ei{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new zh(this);let i=mA(e);this._bootstrapComponents=gx(i.bootstrap),this._r3Injector=rx(e,n,[{provide:Ei,useValue:this},{provide:mf,useValue:this.componentFactoryResolver},...r],Ut(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Qh=class extends Xu{constructor(e){super(),this.moduleType=e}create(e){return new Kh(this.moduleType,e,[])}};function u$(t,e,n){return new Kh(t,e,n)}var $v=class extends Ei{constructor(e){super(),this.componentFactoryResolver=new zh(this),this.instance=null;let n=new zu([...e.providers,{provide:Ei,useValue:this},{provide:mf,useValue:this.componentFactoryResolver}],e.parent||s_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function yf(t,e,n=null){return new $v({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var vf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new It(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Kx(t){return l$(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function c$(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function l$(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function d$(t,e,n){return t[e]=n}function ea(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function h$(t){return(t.flags&32)===32}function f$(t,e,n,r,i,s,o,a,u){let c=e.consts,l=ff(e,t,4,o||null,Vh(c,a));kx(e,n,l,Vh(c,u)),g_(e,l);let d=l.tView=S_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function zr(t,e,n,r,i,s,o,a){let u=xe(),c=on(),l=t+_i,d=c.firstCreatePass?f$(l,c,u,e,n,r,i,s,o):c.data[l];nc(d,!1);let h=p$(c,u,d,t);f_()&&T_(c,u,h,d),Is(h,u);let f=Vx(h,u,h,d);return u[l]=f,pf(u,f),WB(f,d,u),a_(d)&&Mx(c,u,d),o!=null&&Rx(u,d,a),zr}var p$=g$;function g$(t,e,n,r){return p_(!0),e[lt].createComment("")}function ic(t,e,n,r){let i=xe(),s=af();if(ea(i,s,e)){let o=on(),a=h_();QU(a,i,t,e,n,r)}return ic}function m$(t,e,n,r){return ea(t,af(),n)?e+ef(n)+r:Ts}function Ch(t,e){return t<<17|e<<2}function Ds(t){return t>>17&32767}function y$(t){return(t&2)==2}function v$(t,e){return t&131071|e<<17}function Hv(t){return t|2}function Yo(t){return(t&131068)>>2}function uv(t,e){return t&-131069|e<<2}function _$(t){return(t&1)===1}function qv(t){return t|1}function w$(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ds(o),u=Yo(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||tc(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=Ds(t[a+1]);t[r+1]=Ch(h,a),h!==0&&(t[h+1]=uv(t[h+1],r)),t[a+1]=v$(t[a+1],r)}else t[r+1]=Ch(a,0),a!==0&&(t[a+1]=uv(t[a+1],r)),a=r;else t[r+1]=Ch(u,0),a===0?a=r:t[u+1]=uv(t[u+1],r),u=r;c&&(t[r+1]=Hv(t[r+1])),HS(t,l,r,!0),HS(t,l,r,!1),E$(e,l,t,r,s),o=Ch(a,u),s?e.classBindings=o:e.styleBindings=o}function E$(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&tc(s,e)>=0&&(n[r+1]=qv(n[r+1]))}function HS(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ds(i):Yo(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];I$(u,e)&&(a=!0,t[o+1]=r?qv(c):Hv(c)),o=r?Ds(c):Yo(c)}a&&(t[n+1]=r?Hv(i):qv(i))}function I$(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?tc(t,e)>=0:!1}function bn(t,e,n){let r=xe(),i=af();if(ea(r,i,e)){let s=on(),o=h_();Px(s,o,r,t,e,r[lt],n,!1)}return bn}function qS(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";A_(t,n,s[o],o,r)}function _f(t,e){return C$(t,e,null,!0),_f}function C$(t,e,n,r){let i=xe(),s=on(),o=vj(2);if(s.firstUpdatePass&&T$(s,t,o,r),e!==Ts&&ea(i,o,e)){let a=s.data[Xo()];M$(s,a,i,i[lt],t,i[o+1]=R$(e,n),r,o)}}function D$(t,e){return e>=t.expandoStartIndex}function T$(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Xo()],o=D$(t,n);N$(s,r)&&e===null&&!o&&(e=!1),e=b$(i,s,e,r),w$(i,s,e,n,o,r)}}function b$(t,e,n,r){let i=Ij(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=cv(null,t,e,n,r),n=Ju(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=cv(i,t,e,n,r),s===null){let u=S$(t,e,r);u!==void 0&&Array.isArray(u)&&(u=cv(null,t,e,u[1],r),u=Ju(u,e.attrs,r),A$(t,e,r,u))}else s=x$(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function S$(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Yo(r)!==0)return t[Ds(r)]}function A$(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ds(i)]=r}function x$(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Ju(r,o,n)}return Ju(r,e.attrs,n)}function cv(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Ju(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Ju(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),_2(t,o,n?!0:e[++s]))}return t===void 0?null:t}function M$(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=_$(c)?GS(u,e,n,i,Yo(c),o):void 0;if(!Yh(l)){Yh(s)||y$(c)&&(s=GS(u,null,n,i,a,o));let d=RA(Xo(),n);SU(r,o,d,i,s)}}function GS(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Ts&&(h=d?In:void 0);let f=d?Xy(h,r):l===r?h:void 0;if(c&&!Yh(f)&&(f=Xy(u,r)),Yh(f)&&(a=f,o))return a;let p=t[i+1];i=o?Ds(p):Yo(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=Xy(u,r))}return a}function Yh(t){return t!==void 0}function R$(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Ut(rc(t)))),t}function N$(t,e){return(t.flags&(e?8:16))!==0}function P$(t,e,n,r,i,s){let o=e.consts,a=Vh(o,i),u=ff(e,t,2,r,a);return kx(e,n,u,Vh(o,s)),u.attrs!==null&&jv(u,u.attrs,!1),u.mergedAttrs!==null&&jv(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function U(t,e,n,r){let i=xe(),s=on(),o=_i+t,a=i[lt],u=s.firstCreatePass?P$(o,s,i,e,n,r):s.data[o],c=k$(s,i,u,a,e,t);i[o]=c;let l=a_(u);return nc(u,!0),Cx(a,c,u),!h$(u)&&f_()&&T_(s,i,c,u),uj()===0&&Is(c,i),cj(),l&&(Mx(s,i,u),xx(s,u,i)),r!==null&&Rx(i,u),U}function $(){let t=Xt();jA()?gj():(t=t.parent,nc(t,!1));let e=t;hj(e)&&fj(),lj();let n=on();return n.firstCreatePass&&(g_(n,t),bA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&xj(e)&&qS(n,e,xe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Mj(e)&&qS(n,e,xe(),e.stylesWithoutHost,!1),$}function Dt(t,e,n,r){return U(t,e,n,r),$(),Dt}var k$=(t,e,n,r,i,s)=>(p_(!0),mx(r,i,Tj()));function Qx(){return xe()}var Zh="en-US";var O$=Zh;function F$(t){typeof t=="string"&&(O$=t.toLowerCase().replace(/_/g,"-"))}function ft(t,e,n,r){let i=xe(),s=on(),o=Xt();return Yx(s,i,i[lt],o,t,e,r),ft}function V$(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Wu],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function Yx(t,e,n,r,i,s,o){let a=a_(r),c=t.firstCreatePass&&eB(t),l=e[Un],d=JU(e),h=!0;if(r.type&3||o){let g=Tn(r,e),_=o?o(g):g,C=d.length,k=o?H=>o(ar(H[r.index])):r.index,T=null;if(!o&&a&&(T=V$(t,e,i,r.index)),T!==null){let H=T.__ngLastListenerFn__||T;H.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=WS(r,e,l,s,!1);let H=n.listen(_,i,s);d.push(s,H),c&&c.push(i,k,C,C+1)}}else s=WS(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let _=0;_<g;_+=2){let C=p[_],k=p[_+1],z=e[C][k].subscribe(s),Y=d.length;d.push(s,z),c&&c.push(i,r.index,Y,-(Y+1))}}}function zS(t,e,n,r){let i=we(null);try{return rr(6,e,n),n(r)!==!1}catch(s){return jx(t,s),!1}finally{rr(7,e,n),we(i)}}function WS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Ii(t.index,e):e;M_(a);let u=zS(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=zS(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function sc(t=1){return Dj(t)}function re(t,e=""){let n=xe(),r=on(),i=t+_i,s=r.firstCreatePass?ff(r,i,1,e,null):r.data[i],o=L$(r,n,s,e,t);n[i]=o,f_()&&T_(r,n,o,s),nc(s,!1)}var L$=(t,e,n,r,i)=>(p_(!0),uU(e[lt],r));function qn(t){return wf("",t,""),qn}function wf(t,e,n){let r=xe(),i=m$(r,t,e,n);return i!==Ts&&tB(r,Xo(),i),wf}function Ef(t,e,n){Wx(e)&&(e=e());let r=xe(),i=af();if(ea(r,i,e)){let s=on(),o=h_();Px(s,o,r,t,e,r[lt],n,!1)}return Ef}function F_(t,e){let n=Wx(t);return n&&t.set(e),n}function If(t,e){let n=xe(),r=on(),i=Xt();return Yx(r,n,n[lt],i,t,e),If}function j$(t,e,n){let r=on();if(r.firstCreatePass){let i=wi(t);Gv(n,r.data,r.blueprint,i,!0),Gv(e,r.data,r.blueprint,i,!1)}}function Gv(t,e,n,r,i){if(t=Lt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Gv(t[s],e,n,r,i);else{let s=on(),o=xe(),a=Xt(),u=Go(t)?t:Lt(t.provide),c=IA(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Go(t)||!t.multi){let f=new Es(c,i,j),p=dv(u,e,i?l:l+h,d);p===-1?(Cv(Uh(a,o),s,u),lv(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=dv(u,e,l+h,d),p=dv(u,e,l,l+h),g=f>=0&&n[f],_=p>=0&&n[p];if(i&&!_||!i&&!g){Cv(Uh(a,o),s,u);let C=$$(i?B$:U$,n.length,i,r,c);!i&&_&&(n[p].providerFactory=C),lv(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(C),o.push(C)}else{let C=Zx(n[i?p:f],c,!i&&r);lv(s,t,f>-1?f:p,C)}!i&&r&&_&&n[p].componentProviders++}}}function lv(t,e,n,r){let i=Go(e),s=U2(e);if(i||s){let u=(s?Lt(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function Zx(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function dv(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function U$(t,e,n,r){return zv(this.multi,[])}function B$(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Ko(n,n[he],this.providerFactory.index,r);s=a.slice(0,o),zv(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],zv(i,s);return s}function zv(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function $$(t,e,n,r,i){let s=new Es(t,n,j);return s.multi=[],s.index=e,s.componentProviders=0,Zx(s,i,r&&!n),s}function dr(t,e=[]){return n=>{n.providersResolver=(r,i)=>j$(r,i?i(t):t,e)}}var H$=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=_A(!1,r.type),s=i.length>0?yf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=N({token:e,providedIn:"environment",factory:()=>new e(E(sn))});let t=e;return t})();function Xx(t){R_("NgStandalone"),t.getStandaloneInjector=e=>e.get(H$).getOrCreateStandaloneInjector(t)}function V_(t,e,n,r){return G$(xe(),mj(),t,e,n,r)}function q$(t,e){let n=t[e];return n===Ts?void 0:n}function G$(t,e,n,r,i,s){let o=e+n;return ea(t,o,i)?d$(t,o+1,s?r.call(s,i):r(i)):q$(t,o+1)}var Dh=null;function z$(t){Dh!==null&&(t.defaultEncapsulation!==Dh.defaultEncapsulation||t.preserveWhitespaces!==Dh.preserveWhitespaces)||(Dh=t)}var Ur=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Jx=new Ur("17.3.3"),Cf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var L_=new R(""),oc=new R(""),Df=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,j_||(W$(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ae.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(ae),E(Tf),E(oc))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),Tf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return j_?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function W$(t){j_=t}var j_;function bs(t){return!!t&&typeof t.then=="function"}function eM(t){return!!t&&typeof t.subscribe=="function"}var bf=new R(""),tM=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=M(bf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(bs(o))r.push(o);else if(eM(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),U_=new R("");function K$(){Gb(()=>{throw new L(600,!1)})}function Q$(t){return t.isBoundToModule}function Y$(t,e,n){try{let r=n();return bs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function nM(t,e){return Array.isArray(e)?e.reduce(nM,t):b(b({},t),e)}var ta=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=M(ix),this.afterRenderEffectManager=M(k_),this.externalTestViews=new Set,this.beforeRender=new Be,this.afterTick=new Be,this.componentTypes=[],this.components=[],this.isStable=M(vf).hasPendingTasks.pipe(O(r=>!r)),this._injector=M(sn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Gh;if(!this._injector.get(tM).done){let f=!s&&gA(r),p=!1;throw new L(405,p)}let a;s?a=r:a=this._injector.get(mf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=Q$(a)?void 0:this._injector.get(Ei),c=i||a.selector,l=a.create(an.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(L_,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),xh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new L(101,!1);let i=we(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,we(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===Bx)throw new L(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)Z$(a,o,u)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Wv(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Wv(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;xh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(U_,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>xh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new L(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Z$(t,e,n){!e&&!Wv(t)||X$(t,n,e)}function Wv(t){return c_(t)}function X$(t,e,n){let r;n?(r=0,t[G]|=1024):t[G]&64?r=0:r=1,$x(t,e,r)}var Kv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Sf=(()=>{let e=class e{compileModuleSync(r){return new Qh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=mA(r),o=gx(s.declarations).reduce((a,u)=>{let c=vi(u);return c&&a.push(new Qo(c)),a},[]);return new Kv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),J$=new R("");function eH(t,e,n){let r=new Qh(n);return Promise.resolve(r)}function KS(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var tH=(()=>{let e=class e{constructor(){this.zone=M(ae),this.applicationRef=M(ta)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function nH(t){return[{provide:ae,useFactory:t},{provide:qo,multi:!0,useFactory:()=>{let e=M(tH,{optional:!0});return()=>e.initialize()}},{provide:qo,multi:!0,useFactory:()=>{let e=M(sH);return()=>{e.initialize()}}},{provide:ix,useFactory:rH}]}function rH(){let t=M(ae),e=M(ur);return n=>t.runOutsideAngular(()=>e.handleError(n))}function iH(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var sH=(()=>{let e=class e{constructor(){this.subscription=new Ye,this.initialized=!1,this.zone=M(ae),this.pendingTasks=M(vf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ae.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ae.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oH(){return typeof $localize<"u"&&$localize.locale||Zh}var B_=new R("",{providedIn:"root",factory:()=>M(B_,oe.Optional|oe.SkipSelf)||oH()});var rM=new R(""),iM=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=RB(i?.ngZone,iH({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=u$(r.moduleType,this.injector,nH(()=>s)),a=o.injector.get(ur,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{xh(this._modules,o),u.unsubscribe()})}),Y$(a,s,()=>{let u=o.injector.get(tM);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(B_,Zh);return F$(c||Zh),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=nM({},i);return eH(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ta);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new L(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new L(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(rM,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(an))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Hu=null,sM=new R("");function aH(t){if(Hu&&!Hu.get(sM,!1))throw new L(400,!1);K$(),Hu=t;let e=t.get(iM);return lH(t),e}function $_(t,e,n=[]){let r=`Platform: ${e}`,i=new R(r);return(s=[])=>{let o=oM();if(!o||o.injector.get(sM,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):aH(uH(a,r))}return cH(i)}}function uH(t=[],e){return an.create({name:e,providers:[{provide:nf,useValue:"platform"},{provide:rM,useValue:new Set([()=>Hu=null])},...t]})}function cH(t){let e=oM();if(!e)throw new L(401,!1);return e}function oM(){return Hu?.get(iM)??null}function lH(t){t.get(__,null)?.forEach(n=>n())}function H_(){return!1}var Ss=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=dH;let t=e;return t})();function dH(t){return hH(Xt(),xe(),(t&16)===16)}function hH(t,e,n){if(of(t)&&!n){let r=Ii(t.index,e);return new Cs(r,r)}else if(t.type&47){let r=e[or];return new Cs(r,e)}return null}var Qv=class{constructor(){}supports(e){return Kx(e)}create(e){return new Yv(e)}},fH=(t,e)=>e,Yv=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||fH}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<QS(r,i,s)?n:r,a=QS(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Kx(e))throw new L(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,c$(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new Zv(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Xh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Xh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Zv=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Xv=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Xh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new Xv,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function QS(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function YS(){return new q_([new Qv])}var q_=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||YS()),deps:[[e,new t_,new $n]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new L(901,!1)}};e.\u0275prov=N({token:e,providedIn:"root",factory:YS});let t=e;return t})();var aM=$_(null,"core",[]),uM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(ta))},e.\u0275mod=qe({type:e}),e.\u0275inj=He({});let t=e;return t})();function Ci(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function cM(t){let e=vi(t);if(!e)return null;let n=new Qo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var pM=null;function hr(){return pM}function gM(t){pM??=t}var Af=class{};var en=new R(""),Q_=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(pH))(),providedIn:"platform"});let t=e;return t})(),mM=new R(""),pH=(()=>{let e=class e extends Q_{constructor(){super(),this._doc=M(en),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return hr().getBaseHref(this._doc)}onPopState(r){let i=hr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=hr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>new e)(),providedIn:"platform"});let t=e;return t})();function Y_(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function lM(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Wr(t){return t&&t[0]!=="?"?"?"+t:t}var Kr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(Z_))(),providedIn:"root"});let t=e;return t})(),yM=new R(""),Z_=(()=>{let e=class e extends Kr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??M(en).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Y_(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Wr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Q_),E(yM,8))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),vM=(()=>{let e=class e extends Kr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Y_(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Q_),E(yM,8))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),na=(()=>{let e=class e{constructor(r){this._subject=new $e,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=yH(lM(dM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Wr(i))}normalize(r){return e.stripTrailingSlash(mH(this._basePath,dM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Wr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Wr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Wr,e.joinWithSlash=Y_,e.stripTrailingSlash=lM,e.\u0275fac=function(i){return new(i||e)(E(Kr))},e.\u0275prov=N({token:e,factory:()=>gH(),providedIn:"root"});let t=e;return t})();function gH(){return new na(E(Kr))}function mH(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function dM(t){return t.replace(/\/index.html$/,"")}function yH(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function _M(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var G_=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},wM=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(!1)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new G_(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),hM(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);hM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(j(Jo),j(gf),j(q_))},e.\u0275dir=Oe({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function hM(t,e){t.context.$implicit=e.item}var ra=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new z_,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){fM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){fM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(j(Jo),j(gf))},e.\u0275dir=Oe({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),z_=class{constructor(){this.$implicit=null,this.ngIf=null}};function fM(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Ut(e)}'.`)}var EM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=He({});let t=e;return t})(),X_="browser",vH="server";function _H(t){return t===X_}function As(t){return t===vH}var IM=(()=>{let e=class e{};e.\u0275prov=N({token:e,providedIn:"root",factory:()=>_H(M(Mt))?new W_(M(en),window):new K_});let t=e;return t})(),W_=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=wH(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function wH(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var K_=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},xf=class{};var tw=class extends Af{constructor(){super(...arguments),this.supportsDOMEvents=!0}},nw=class t extends tw{static makeCurrent(){gM(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=IH();return n==null?null:CH(n)}resetBaseElement(){ac=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _M(document.cookie,e)}},ac=null;function IH(){return ac=ac||document.querySelector("base"),ac?ac.getAttribute("href"):null}function CH(t){return new URL(t,document.baseURI).pathname}var rw=class{addToWindow(e){jt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new L(5103,!1);return s},jt.getAllAngularTestabilities=()=>e.getAllTestabilities(),jt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=jt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};jt.frameworkStabilizers||(jt.frameworkStabilizers=[]),jt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?hr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},DH=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),iw=new R(""),bM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new L(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(iw),E(ae))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),Rf=class{constructor(e){this._doc=e}},J_="ng-app-id",SM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=As(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${J_}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(J_),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(J_,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(en),E(cf),E(w_,8),E(Mt))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),ew={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ow=/%COMP%/g,AM="%COMP%",TH=`_nghost-${AM}`,bH=`_ngcontent-${AM}`,SH=!0,AH=new R("",{providedIn:"root",factory:()=>SH});function xH(t){return bH.replace(ow,t)}function MH(t){return TH.replace(ow,t)}function xM(t,e){return e.map(n=>n.replace(ow,t))}var CM=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=As(u),this.defaultRenderer=new uc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===sr.ShadowDom&&(i=ye(b({},i),{encapsulation:sr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Nf?s.applyToHost(r):s instanceof cc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case sr.Emulated:o=new Nf(c,l,i,this.appId,d,a,u,h);break;case sr.ShadowDom:return new sw(c,l,r,i,a,u,this.nonce,h);default:o=new cc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(bM),E(SM),E(cf),E(AH),E(en),E(Mt),E(ae),E(w_))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),uc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(ew[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(DM(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(DM(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new L(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=ew[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=ew[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(jr.DashCase|jr.Important)?e.style.setProperty(n,r,i&jr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&jr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=hr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function DM(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var sw=class extends uc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=xM(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},cc=class extends uc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?xM(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Nf=class extends cc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=xH(c),this.hostAttr=MH(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},RH=(()=>{let e=class e extends Rf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(en))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})(),TM=["alt","control","meta","shift"],NH={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},PH={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},kH=(()=>{let e=class e extends Rf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),TM.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=NH[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),TM.forEach(a=>{if(a!==s){let u=PH[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(en))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})();function OH(){nw.makeCurrent()}function FH(){return new ur}function VH(){return lx(document),document}var LH=[{provide:Mt,useValue:X_},{provide:__,useValue:OH,multi:!0},{provide:en,useFactory:VH,deps:[]}],MM=$_(aM,"browser",LH),jH=new R(""),UH=[{provide:oc,useClass:rw,deps:[]},{provide:L_,useClass:Df,deps:[ae,Tf,oc]},{provide:Df,useClass:Df,deps:[ae,Tf,oc]}],BH=[{provide:nf,useValue:"root"},{provide:ur,useFactory:FH,deps:[]},{provide:iw,useClass:RH,multi:!0,deps:[en,ae,Mt]},{provide:iw,useClass:kH,multi:!0,deps:[en]},CM,SM,bM,{provide:Zu,useExisting:CM},{provide:xf,useClass:DH,deps:[]},[]],RM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:cf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(jH,12))},e.\u0275mod=qe({type:e}),e.\u0275inj=He({providers:[...BH,...UH],imports:[EM,uM]});let t=e;return t})();var NM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(en))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var HM=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(j(Gr),j(lr))},e.\u0275dir=Oe({type:e});let t=e;return t})(),Bf=(()=>{let e=class e extends HM{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275dir=Oe({type:e,features:[Jt]});let t=e;return t})(),ua=new R("");var $H={provide:ua,useExisting:Dn(()=>ca),multi:!0};function HH(){let t=hr()?hr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var qH=new R(""),ca=(()=>{let e=class e extends HM{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!HH())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(j(Gr),j(lr),j(qH,8))},e.\u0275dir=Oe({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&ft("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[dr([$H]),Jt]});let t=e;return t})();function Di(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function qM(t){return t!=null&&typeof t.length=="number"}var pc=new R(""),$f=new R(""),GH=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,sa=class{static min(e){return zH(e)}static max(e){return WH(e)}static required(e){return GM(e)}static requiredTrue(e){return KH(e)}static email(e){return QH(e)}static minLength(e){return YH(e)}static maxLength(e){return ZH(e)}static pattern(e){return XH(e)}static nullValidator(e){return kf(e)}static compose(e){return ZM(e)}static composeAsync(e){return XM(e)}};function zH(t){return e=>{if(Di(e.value)||Di(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function WH(t){return e=>{if(Di(e.value)||Di(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function GM(t){return Di(t.value)?{required:!0}:null}function KH(t){return t.value===!0?null:{required:!0}}function QH(t){return Di(t.value)||GH.test(t.value)?null:{email:!0}}function YH(t){return e=>Di(e.value)||!qM(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function ZH(t){return e=>qM(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function XH(t){if(!t)return kf;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(Di(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function kf(t){return null}function zM(t){return t!=null}function WM(t){return bs(t)?me(t):t}function KM(t){let e={};return t.forEach(n=>{e=n!=null?b(b({},e),n):e}),Object.keys(e).length===0?null:e}function QM(t,e){return e.map(n=>n(t))}function JH(t){return!t.validate}function YM(t){return t.map(e=>JH(e)?e:n=>e.validate(n))}function ZM(t){if(!t)return null;let e=t.filter(zM);return e.length==0?null:function(n){return KM(QM(n,e))}}function lw(t){return t!=null?ZM(YM(t)):null}function XM(t){if(!t)return null;let e=t.filter(zM);return e.length==0?null:function(n){let r=QM(n,e).map(WM);return Gy(r).pipe(O(KM))}}function dw(t){return t!=null?XM(YM(t)):null}function kM(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function JM(t){return t._rawValidators}function eR(t){return t._rawAsyncValidators}function aw(t){return t?Array.isArray(t)?t:[t]:[]}function Of(t,e){return Array.isArray(t)?t.includes(e):t===e}function OM(t,e){let n=aw(e);return aw(t).forEach(i=>{Of(n,i)||n.push(i)}),n}function FM(t,e){return aw(e).filter(n=>!Of(t,n))}var Ff=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=lw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Qr=class extends Ff{get formDirective(){return null}get path(){return null}},xs=class extends Ff{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Vf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},eq={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Qte=ye(b({},eq),{"[class.ng-submitted]":"isSubmitted"}),Hf=(()=>{let e=class e extends Vf{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(j(xs,2))},e.\u0275dir=Oe({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&_f("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Jt]});let t=e;return t})(),qf=(()=>{let e=class e extends Vf{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(j(Qr,10))},e.\u0275dir=Oe({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&_f("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Jt]});let t=e;return t})();var lc="VALID",Pf="INVALID",ia="PENDING",dc="DISABLED";function hw(t){return(Gf(t)?t.validators:t)||null}function tq(t){return Array.isArray(t)?lw(t):t||null}function fw(t,e){return(Gf(e)?e.asyncValidators:t)||null}function nq(t){return Array.isArray(t)?dw(t):t||null}function Gf(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function tR(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new L(1e3,"");if(!r[n])throw new L(1001,"")}function nR(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new L(1002,"")})}var oa=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===lc}get invalid(){return this.status===Pf}get pending(){return this.status==ia}get disabled(){return this.status===dc}get enabled(){return this.status!==dc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(OM(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(OM(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(FM(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(FM(e,this._rawAsyncValidators))}hasValidator(e){return Of(this._rawValidators,e)}hasAsyncValidator(e){return Of(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ia,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=dc,this.errors=null,this._forEachChild(r=>{r.disable(ye(b({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ye(b({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=lc,this._forEachChild(r=>{r.enable(ye(b({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ye(b({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===lc||this.status===ia)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dc:lc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ia,this._hasOwnPendingAsyncValidator=!0;let n=WM(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new $e,this.statusChanges=new $e}_calculateStatus(){return this._allControlsDisabled()?dc:this.errors?Pf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ia)?ia:this._anyControlsHaveStatus(Pf)?Pf:lc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Gf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=tq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=nq(this._rawAsyncValidators)}},aa=class extends oa{constructor(e,n,r){super(hw(n),fw(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){nR(this,!0,e),Object.keys(e).forEach(r=>{tR(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var uw=class extends aa{};var gc=new R("CallSetDisabledState",{providedIn:"root",factory:()=>zf}),zf="always";function rR(t,e){return[...e.path,t]}function Lf(t,e,n=zf){pw(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),iq(t,e),oq(t,e),sq(t,e),rq(t,e)}function VM(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Uf(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function jf(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function rq(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function pw(t,e){let n=JM(t);e.validator!==null?t.setValidators(kM(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=eR(t);e.asyncValidator!==null?t.setAsyncValidators(kM(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();jf(e._rawValidators,i),jf(e._rawAsyncValidators,i)}function Uf(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=JM(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=eR(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}let r=()=>{};return jf(e._rawValidators,r),jf(e._rawAsyncValidators,r),n}function iq(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&iR(t,e)})}function sq(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&iR(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function iR(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function oq(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function sR(t,e){t==null,pw(t,e)}function aq(t,e){return Uf(t,e)}function oR(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function uq(t){return Object.getPrototypeOf(t.constructor)===Bf}function aR(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function uR(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===ca?n=s:uq(s)?r=s:i=s}),i||r||n||null}function cq(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var lq={provide:Qr,useExisting:Dn(()=>gw)},hc=(()=>Promise.resolve())(),gw=(()=>{let e=class e extends Qr{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new $e,this.form=new aa({},lw(r),dw(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){hc.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),Lf(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){hc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){hc.then(()=>{let i=this._findContainer(r.path),s=new aa({});sR(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){hc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){hc.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,aR(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(j(pc,10),j($f,10),j(gc,8))},e.\u0275dir=Oe({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&ft("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:[nt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[dr([lq]),Jt]});let t=e;return t})();function LM(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function jM(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var fc=class extends oa{constructor(e=null,n,r){super(hw(n),fw(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Gf(n)&&(n.nonNullable||n.initialValueIsDefault)&&(jM(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){LM(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){LM(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){jM(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var dq=t=>t instanceof fc;var hq={provide:xs,useExisting:Dn(()=>mw)},UM=(()=>Promise.resolve())(),mw=(()=>{let e=class e extends xs{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new fc,this._registered=!1,this.name="",this.update=new $e,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=uR(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),oR(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Lf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){UM.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ci(i);UM.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?rR(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(j(Qr,9),j(pc,10),j($f,10),j(ua,10),j(Ss,8),j(gc,8))},e.\u0275dir=Oe({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[nt.None,"disabled","isDisabled"],model:[nt.None,"ngModel","model"],options:[nt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[dr([hq]),Jt,cr]});let t=e;return t})(),Wf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Oe({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),fq={provide:ua,useExisting:Dn(()=>yw),multi:!0},yw=(()=>{let e=class e extends Bf{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275dir=Oe({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&ft("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[dr([fq]),Jt]});let t=e;return t})();var cR=new R("");var pq={provide:Qr,useExisting:Dn(()=>vw)},vw=(()=>{let e=class e extends Qr{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new $e,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Uf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return Lf(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){VM(r.control||null,r,!1),cq(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,aR(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(VM(i||null,r),dq(s)&&(Lf(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);sR(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&aq(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){pw(this.form,this),this._oldForm&&Uf(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(j(pc,10),j($f,10),j(gc,8))},e.\u0275dir=Oe({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&ft("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[nt.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[dr([pq]),Jt,cr]});let t=e;return t})();var gq={provide:xs,useExisting:Dn(()=>_w)},_w=(()=>{let e=class e extends xs{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new $e,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=uR(this,o)}ngOnChanges(r){this._added||this._setUpControl(),oR(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return rR(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(j(Qr,13),j(pc,10),j($f,10),j(ua,10),j(cR,8))},e.\u0275dir=Oe({type:e,selectors:[["","formControlName",""]],inputs:{name:[nt.None,"formControlName","name"],isDisabled:[nt.None,"disabled","isDisabled"],model:[nt.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[dr([gq]),Jt,cr]});let t=e;return t})(),mq={provide:ua,useExisting:Dn(()=>dR),multi:!0};function lR(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function yq(t){return t.split(":")[0]}var dR=(()=>{let e=class e extends Bf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=lR(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=yq(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275dir=Oe({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&ft("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[dr([mq]),Jt]});let t=e;return t})(),hR=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(lR(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(j(lr),j(Gr),j(dR,9))},e.\u0275dir=Oe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),vq={provide:ua,useExisting:Dn(()=>fR),multi:!0};function BM(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function _q(t){return t.split(":")[0]}var fR=(()=>{let e=class e extends Bf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],l=this._getOptionValue(c.value);s.push(l)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let l=this._getOptionValue(c.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=_q(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275dir=Oe({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&ft("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[dr([vq]),Jt]});let t=e;return t})(),pR=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(BM(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(BM(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(j(lr),j(Gr),j(fR,9))},e.\u0275dir=Oe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var wq=(()=>{let e=class e{constructor(){this._validator=kf}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):kf,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Oe({type:e,features:[cr]});let t=e;return t})();var Eq={provide:pc,useExisting:Dn(()=>ww),multi:!0};var ww=(()=>{let e=class e extends wq{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Ci,this.createValidator=r=>GM}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275dir=Oe({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&ic("required",s._enabled?"":null)},inputs:{required:"required"},features:[dr([Eq]),Jt]});let t=e;return t})();var gR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=He({});let t=e;return t})(),cw=class extends oa{constructor(e,n,r){super(hw(n),fw(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,r={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){nR(this,!1,e),e.forEach((r,i)=>{tR(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,r)=>r._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,r)=>{e(n,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function $M(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var mR=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,i=null){let s=this._reduceControls(r),o={};return $M(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new aa(s,o)}record(r,i=null){let s=this._reduceControls(r);return new uw(s,i)}control(r,i,s){let o={};return this.useNonNullable?($M(i)?o=i:(o.validators=i,o.asyncValidators=s),new fc(r,ye(b({},o),{nonNullable:!0}))):new fc(r,i,s)}array(r,i,s){let o=r.map(a=>this._createControl(a));return new cw(o,i,s)}_reduceControls(r){let i={};return Object.keys(r).forEach(s=>{i[s]=this._createControl(r[s])}),i}_createControl(r){if(r instanceof fc)return r;if(r instanceof oa)return r;if(Array.isArray(r)){let i=r[0],s=r.length>1?r[1]:null,o=r.length>2?r[2]:null;return this.control(i,s,o)}else return this.control(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yR=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:gc,useValue:r.callSetDisabledState??zf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=He({imports:[gR]});let t=e;return t})(),vR=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:cR,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:gc,useValue:r.callSetDisabledState??zf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=He({imports:[gR]});let t=e;return t})();var Iq="firebase",Cq="10.10.0";Ft(Iq,Cq,"app");var Yr=new Ur("ANGULARFIRE2_VERSION");function Cw(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var mc=(t,e)=>{let n=e?[e]:zd(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Sn=class{constructor(){return mc(Dq)}},Dq="app-check";function la(){}var Kf=class{zone;delegate;constructor(e,n=$y){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Iw=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",la,{},la,la)),n.pipe(ct({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Zr=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Kf(Zone.current)),this.insideAngular=n.run(()=>new Kf(Zone.current,fs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(ae))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Qf(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Tq(t){return Qf().ngZone.runOutsideAngular(()=>t())}function Ms(t){return Qf().ngZone.run(()=>t())}function ze(t){return bq(Qf())(t)}function bq(t){return function(n){return n=n.lift(new Iw(t.ngZone)),n.pipe(_n(t.outsideAngular),rn(t.insideAngular))}}var Sq=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ms(()=>t.apply(void 0,r))},Dw=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=Ms(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",la,{},la,la))),r[s]=Sq(r[s],n));let i=Tq(()=>t.apply(this,r));if(!e)if(i instanceof te){let s=Qf();return i.pipe(_n(s.outsideAngular),rn(s.insideAngular))}else return Ms(()=>i);return i instanceof te?i.pipe(ze):i instanceof Promise?Ms(()=>new Promise((s,o)=>i.then(a=>Ms(()=>s(a)),a=>Ms(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:Ms(()=>i)};var Yf=class{constructor(e){return e}},Zf=class{constructor(){return zd()}};var S4="auth";var Xf=class{constructor(){return mc(S4)}};var A4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zn={},x,Ww=Ww||{},Q=A4||self;function hp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Mc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function x4(t){return Object.prototype.hasOwnProperty.call(t,bw)&&t[bw]||(t[bw]=++M4)}var bw="closure_uid_"+(1e9*Math.random()>>>0),M4=0;function R4(t,e,n){return t.call.apply(t.bind,arguments)}function N4(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Rt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Rt=R4:Rt=N4,Rt.apply(null,arguments)}function Jf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function gt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ti(){this.s=this.s,this.o=this.o}var P4=0;Ti.prototype.s=!1;Ti.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),P4!=0)&&x4(this)};Ti.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var RR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Kw(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function _R(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(hp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Nt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Nt.prototype.h=function(){this.defaultPrevented=!0};var k4=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Q.addEventListener("test",n,e),Q.removeEventListener("test",n,e)}catch{}return t}();function Ic(t){return/^[\s\xa0]*$/.test(t)}function fp(){var t=Q.navigator;return t&&(t=t.userAgent)?t:""}function fr(t){return fp().indexOf(t)!=-1}function Qw(t){return Qw[" "](t),t}Qw[" "]=function(){};function O4(t,e){var n=CG;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var F4=fr("Opera"),pa=fr("Trident")||fr("MSIE"),NR=fr("Edge"),Rw=NR||pa,PR=fr("Gecko")&&!(fp().toLowerCase().indexOf("webkit")!=-1&&!fr("Edge"))&&!(fr("Trident")||fr("MSIE"))&&!fr("Edge"),V4=fp().toLowerCase().indexOf("webkit")!=-1&&!fr("Edge");function kR(){var t=Q.document;return t?t.documentMode:void 0}var Nw;e:{if(ep="",tp=function(){var t=fp();if(PR)return/rv:([^\);]+)(\)|;)/.exec(t);if(NR)return/Edge\/([\d\.]+)/.exec(t);if(pa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(V4)return/WebKit\/(\S+)/.exec(t);if(F4)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),tp&&(ep=tp?tp[1]:""),pa&&(np=kR(),np!=null&&np>parseFloat(ep))){Nw=String(np);break e}Nw=ep}var ep,tp,np,Pw;Q.document&&pa?(Sw=kR(),Pw=Sw||parseInt(Nw,10)||void 0):Pw=void 0;var Sw,L4=Pw;function Cc(t,e){if(Nt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(PR){e:{try{Qw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:j4[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Cc.$.h.call(this)}}gt(Cc,Nt);var j4={2:"touch",3:"pen",4:"mouse"};Cc.prototype.h=function(){Cc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Rc="closure_listenable_"+(1e6*Math.random()|0),U4=0;function B4(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++U4,this.fa=this.ia=!1}function pp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Yw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function $4(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function OR(t){let e={};for(let n in t)e[n]=t[n];return e}var wR="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function FR(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<wR.length;s++)n=wR[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function gp(t){this.src=t,this.g={},this.h=0}gp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Ow(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new B4(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function kw(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=RR(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(pp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Ow(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Zw="closure_lm_"+(1e6*Math.random()|0),Aw={};function VR(t,e,n,r,i){if(r&&r.once)return jR(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)VR(t,e[s],n,r,i);return null}return n=eE(n),t&&t[Rc]?t.O(e,n,Mc(r)?!!r.capture:!!r,i):LR(t,e,n,!1,r,i)}function LR(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Mc(i)?!!i.capture:!!i,a=Jw(t);if(a||(t[Zw]=a=new gp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=H4(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)k4||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(BR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function H4(){function t(n){return e.call(t.src,t.listener,n)}let e=q4;return t}function jR(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jR(t,e[s],n,r,i);return null}return n=eE(n),t&&t[Rc]?t.P(e,n,Mc(r)?!!r.capture:!!r,i):LR(t,e,n,!0,r,i)}function UR(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)UR(t,e[s],n,r,i);else r=Mc(r)?!!r.capture:!!r,n=eE(n),t&&t[Rc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Ow(s,n,r,i),-1<n&&(pp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Jw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ow(e,n,r,i)),(n=-1<t?e[t]:null)&&Xw(n))}function Xw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Rc])kw(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(BR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Jw(e))?(kw(n,t),n.h==0&&(n.src=null,e[Zw]=null)):pp(t)}}}function BR(t){return t in Aw?Aw[t]:Aw[t]="on"+t}function q4(t,e){if(t.fa)t=!0;else{e=new Cc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Xw(t),t=n.call(r,e)}return t}function Jw(t){return t=t[Zw],t instanceof gp?t:null}var xw="__closure_events_fn_"+(1e9*Math.random()>>>0);function eE(t){return typeof t=="function"?t:(t[xw]||(t[xw]=function(e){return t.handleEvent(e)}),t[xw])}function pt(){Ti.call(this),this.i=new gp(this),this.S=this,this.J=null}gt(pt,Ti);pt.prototype[Rc]=!0;pt.prototype.removeEventListener=function(t,e,n,r){UR(this,t,e,n,r)};function bt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Nt(e,t);else if(e instanceof Nt)e.target=e.target||t;else{var i=e;e=new Nt(r,t),FR(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=rp(o,r,!0,e)&&i}if(o=e.g=t,i=rp(o,r,!0,e)&&i,i=rp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=rp(o,r,!1,e)&&i}pt.prototype.N=function(){if(pt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)pp(n[r]);delete t.g[e],t.h--}}this.J=null};pt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};pt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function rp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&kw(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var tE=Q.JSON.stringify,Fw=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function G4(){var t=nE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Vw=class{constructor(){this.h=this.g=null}add(e,n){let r=$R.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},$R=new Fw(()=>new Lw,t=>t.reset()),Lw=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function z4(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function W4(t){Q.setTimeout(()=>{throw t},0)}var Dc,Tc=!1,nE=new Vw,HR=()=>{let t=Q.Promise.resolve(void 0);Dc=()=>{t.then(K4)}},K4=()=>{for(var t;t=G4();){try{t.h.call(t.g)}catch(n){W4(n)}var e=$R;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Tc=!1};function mp(t,e){pt.call(this),this.h=t||1,this.g=e||Q,this.j=Rt(this.qb,this),this.l=Date.now()}gt(mp,pt);x=mp.prototype;x.ga=!1;x.T=null;x.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),bt(this,"tick"),this.ga&&(rE(this),this.start()))}};x.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function rE(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}x.N=function(){mp.$.N.call(this),rE(this),delete this.g};function iE(t,e,n){if(typeof t=="function")n&&(t=Rt(t,n));else if(t&&typeof t.handleEvent=="function")t=Rt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(t,e||0)}function qR(t){t.g=iE(()=>{t.g=null,t.i&&(t.i=!1,qR(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var jw=class extends Ti{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:qR(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function bc(t){Ti.call(this),this.h=t,this.g={}}gt(bc,Ti);var ER=[];function GR(t,e,n,r){Array.isArray(n)||(n&&(ER[0]=n.toString()),n=ER);for(var i=0;i<n.length;i++){var s=VR(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function zR(t){Yw(t.g,function(e,n){this.g.hasOwnProperty(n)&&Xw(e)},t),t.g={}}bc.prototype.N=function(){bc.$.N.call(this),zR(this)};bc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function yp(){this.g=!0}yp.prototype.Ea=function(){this.g=!1};function Q4(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function Y4(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ha(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+X4(t,n)+(r?" "+r:"")})}function Z4(t,e){t.info(function(){return"TIMEOUT: "+e})}yp.prototype.info=function(){};function X4(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return tE(n)}catch{return e}}var ks={},IR=null;function vp(){return IR=IR||new pt}ks.Ta="serverreachability";function WR(t){Nt.call(this,ks.Ta,t)}gt(WR,Nt);function Sc(t){let e=vp();bt(e,new WR(e))}ks.STAT_EVENT="statevent";function KR(t,e){Nt.call(this,ks.STAT_EVENT,t),this.stat=e}gt(KR,Nt);function Bt(t){let e=vp();bt(e,new KR(e,t))}ks.Ua="timingevent";function QR(t,e){Nt.call(this,ks.Ua,t),this.size=e}gt(QR,Nt);function Nc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){t()},e)}var _p={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},YR={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function sE(){}sE.prototype.h=null;function CR(t){return t.h||(t.h=t.i())}function ZR(){}var Pc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oE(){Nt.call(this,"d")}gt(oE,Nt);function aE(){Nt.call(this,"c")}gt(aE,Nt);var Uw;function wp(){}gt(wp,sE);wp.prototype.g=function(){return new XMLHttpRequest};wp.prototype.i=function(){return{}};Uw=new wp;function kc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new bc(this),this.P=J4,t=Rw?125:void 0,this.V=new mp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new XR}function XR(){this.i=null,this.g="",this.h=!1}var J4=45e3,JR={},Bw={};x=kc.prototype;x.setTimeout=function(t){this.P=t};function $w(t,e,n){t.L=1,t.A=Ip(Jr(e)),t.u=n,t.S=!0,eN(t,null)}function eN(t,e){t.G=Date.now(),Oc(t),t.B=Jr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),uN(n.i,"t",r),t.o=0,n=t.l.J,t.h=new XR,t.g=xN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new jw(Rt(t.Pa,t,t.g),t.O)),GR(t.U,t.g,"readystatechange",t.nb),e=t.I?OR(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Sc(),Q4(t.j,t.v,t.B,t.m,t.W,t.u)}x.nb=function(t){t=t.target;let e=this.M;e&&pr(t)==3?e.l():this.Pa(t)};x.Pa=function(t){try{if(t==this.g)e:{let l=pr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Rw||this.g&&(this.h.h||this.g.ja()||SR(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Sc(3):Sc(2)),Ep(this);var n=this.g.da();this.ca=n;t:if(tN(this)){var r=SR(this.g);t="";var i=r.length,s=pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Rs(this),Ec(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Y4(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ic(a)){var c=a;break t}}c=null}if(n=c)ha(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hw(this,n);else{this.i=!1,this.s=3,Bt(12),Rs(this),Ec(this);break e}}this.S?(nN(this,l,o),Rw&&this.i&&l==3&&(GR(this.U,this.V,"tick",this.mb),this.V.start())):(ha(this.j,this.m,o,null),Hw(this,o)),l==4&&Rs(this),this.i&&!this.J&&(l==4?TN(this.l,this):(this.i=!1,Oc(this)))}else wG(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Bt(12)):(this.s=0,Bt(13)),Rs(this),Ec(this)}}}catch{}finally{}};function tN(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function nN(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=eG(t,n),i==Bw){e==4&&(t.s=4,Bt(14),r=!1),ha(t.j,t.m,null,"[Incomplete Response]");break}else if(i==JR){t.s=4,Bt(15),ha(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ha(t.j,t.m,i,null),Hw(t,i);tN(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Bt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),fE(e),e.M=!0,Bt(11))):(ha(t.j,t.m,n,"[Invalid Chunked Response]"),Rs(t),Ec(t))}x.mb=function(){if(this.g){var t=pr(this.g),e=this.g.ja();this.o<e.length&&(Ep(this),nN(this,t,e),this.i&&t!=4&&Oc(this))}};function eG(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Bw:(n=Number(e.substring(n,r)),isNaN(n)?JR:(r+=1,r+n>e.length?Bw:(e=e.slice(r,r+n),t.o=r+n,e)))}x.cancel=function(){this.J=!0,Rs(this)};function Oc(t){t.Y=Date.now()+t.P,rN(t,t.P)}function rN(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Nc(Rt(t.lb,t),e)}function Ep(t){t.C&&(Q.clearTimeout(t.C),t.C=null)}x.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(Z4(this.j,this.B),this.L!=2&&(Sc(),Bt(17)),Rs(this),this.s=2,Ec(this)):rN(this,this.Y-t)};function Ec(t){t.l.H==0||t.J||TN(t.l,t)}function Rs(t){Ep(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,rE(t.V),zR(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Hw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||qw(n.i,t))){if(!t.K&&qw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)up(n),Tp(n);else break e;hE(n),Bt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Nc(Rt(n.ib,n),6e3));if(1>=dN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ns(n,11)}else if((t.K||n.g==t)&&up(n),!Ic(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(uE(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Ne(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=AN(r,r.J?r.pa:null,r.Y),o.K){hN(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(Ep(a),Oc(a)),r.g=o}else CN(r);0<n.j.length&&bp(n)}else c[0]!="stop"&&c[0]!="close"||Ns(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Ns(n,7):dE(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Sc(4)}catch{}}function tG(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(hp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function nG(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(hp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function iN(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(hp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=nG(t),r=tG(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var sN=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rG(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ps(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ps){this.h=t.h,op(this,t.j),this.s=t.s,this.g=t.g,ap(this,t.m),this.l=t.l;var e=t.i,n=new Ac;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),DR(this,n),this.o=t.o}else t&&(e=String(t).match(sN))?(this.h=!1,op(this,e[1]||"",!0),this.s=_c(e[2]||""),this.g=_c(e[3]||"",!0),ap(this,e[4]),this.l=_c(e[5]||"",!0),DR(this,e[6]||"",!0),this.o=_c(e[7]||"")):(this.h=!1,this.i=new Ac(null,this.h))}Ps.prototype.toString=function(){var t=[],e=this.j;e&&t.push(wc(e,TR,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(wc(e,TR,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(wc(n,n.charAt(0)=="/"?oG:sG,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",wc(n,uG)),t.join("")};function Jr(t){return new Ps(t)}function op(t,e,n){t.j=n?_c(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ap(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function DR(t,e,n){e instanceof Ac?(t.i=e,cG(t.i,t.h)):(n||(e=wc(e,aG)),t.i=new Ac(e,t.h))}function Ne(t,e,n){t.i.set(e,n)}function Ip(t){return Ne(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function _c(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function wc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,iG),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function iG(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var TR=/[#\/\?@]/g,sG=/[#\?:]/g,oG=/[#\?]/g,aG=/[#\?@]/g,uG=/#/g;function Ac(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function bi(t){t.g||(t.g=new Map,t.h=0,t.i&&rG(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}x=Ac.prototype;x.add=function(t,e){bi(this),this.i=null,t=ga(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function oN(t,e){bi(t),e=ga(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function aN(t,e){return bi(t),e=ga(t,e),t.g.has(e)}x.forEach=function(t,e){bi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};x.ta=function(){bi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};x.Z=function(t){bi(this);let e=[];if(typeof t=="string")aN(this,t)&&(e=e.concat(this.g.get(ga(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};x.set=function(t,e){return bi(this),this.i=null,t=ga(this,t),aN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};x.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function uN(t,e,n){oN(t,e),0<n.length&&(t.i=null,t.g.set(ga(t,e),Kw(n)),t.h+=n.length)}x.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function ga(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function cG(t,e){e&&!t.j&&(bi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(oN(this,r),uN(this,i,n))},t)),t.j=e}var lG=class{constructor(t,e){this.g=t,this.map=e}};function cN(t){this.l=t||dG,Q.PerformanceNavigationTiming?(t=Q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var dG=10;function lN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function dN(t){return t.h?1:t.g?t.g.size:0}function qw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function uE(t,e){t.g?t.g.add(e):t.h=e}function hN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}cN.prototype.cancel=function(){if(this.i=fN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function fN(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return Kw(t.i)}var hG=class{stringify(t){return Q.JSON.stringify(t,void 0)}parse(t){return Q.JSON.parse(t,void 0)}};function fG(){this.g=new hG}function pG(t,e,n){let r=n||"";try{iN(t,function(i,s){let o=i;Mc(i)&&(o=tE(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function gG(t,e){let n=new yp;if(Q.Image){let r=new Image;r.onload=Jf(ip,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Jf(ip,n,r,"TestLoadImage: error",!1,e),r.onabort=Jf(ip,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Jf(ip,n,r,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ip(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Fc(t){this.l=t.ec||null,this.j=t.ob||!1}gt(Fc,sE);Fc.prototype.g=function(){return new Cp(this.l,this.j)};Fc.prototype.i=function(t){return function(){return t}}({});function Cp(t,e){pt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=cE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gt(Cp,pt);var cE=0;x=Cp.prototype;x.open=function(t,e){if(this.readyState!=cE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,xc(this)};x.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};x.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vc(this)),this.readyState=cE};x.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,xc(this)),this.g&&(this.readyState=3,xc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function pN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}x.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Vc(this):xc(this),this.readyState==3&&pN(this)}};x.Za=function(t){this.g&&(this.response=this.responseText=t,Vc(this))};x.Ya=function(t){this.g&&(this.response=t,Vc(this))};x.ka=function(){this.g&&Vc(this)};function Vc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,xc(t)}x.setRequestHeader=function(t,e){this.v.append(t,e)};x.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};x.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function xc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Cp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var mG=Q.JSON.parse;function We(t){pt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=gN,this.L=this.M=!1}gt(We,pt);var gN="",yG=/^https?$/i,vG=["POST","PUT"];x=We.prototype;x.Oa=function(t){this.M=t};x.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Uw.g(),this.C=this.u?CR(this.u):CR(Uw),this.g.onreadystatechange=Rt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){bR(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Q.FormData&&t instanceof Q.FormData,!(0<=RR(vG,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{vN(this),0<this.B&&((this.L=_G(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Rt(this.ua,this)):this.A=iE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){bR(this,s)}};function _G(t){return pa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}x.ua=function(){typeof Ww<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,bt(this,"timeout"),this.abort(8))};function bR(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,mN(t),Dp(t)}function mN(t){t.F||(t.F=!0,bt(t,"complete"),bt(t,"error"))}x.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,bt(this,"complete"),bt(this,"abort"),Dp(this))};x.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dp(this,!0)),We.$.N.call(this)};x.La=function(){this.s||(this.G||this.v||this.l?yN(this):this.kb())};x.kb=function(){yN(this)};function yN(t){if(t.h&&typeof Ww<"u"&&(!t.C[1]||pr(t)!=4||t.da()!=2)){if(t.v&&pr(t)==4)iE(t.La,0,t);else if(bt(t,"readystatechange"),pr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(sN)[1]||null;!i&&Q.self&&Q.self.location&&(i=Q.self.location.protocol.slice(0,-1)),r=!yG.test(i?i.toLowerCase():"")}n=r}if(n)bt(t,"complete"),bt(t,"success");else{t.m=6;try{var s=2<pr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",mN(t)}}finally{Dp(t)}}}}function Dp(t,e){if(t.g){vN(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||bt(t,"ready");try{n.onreadystatechange=r}catch{}}}function vN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Q.clearTimeout(t.A),t.A=null)}x.isActive=function(){return!!this.g};function pr(t){return t.g?t.g.readyState:0}x.da=function(){try{return 2<pr(this)?this.g.status:-1}catch{return-1}};x.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};x.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),mG(e)}};function SR(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case gN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function wG(t){let e={};t=(t.g&&2<=pr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Ic(t[r]))continue;var n=z4(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}$4(e,function(r){return r.join(", ")})}x.Ia=function(){return this.m};x.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function _N(t){let e="";return Yw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function lE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=_N(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ne(t,e,n))}function yc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function wN(t){this.Ga=0,this.j=[],this.l=new yp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=yc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=yc("baseRetryDelayMs",5e3,t),this.hb=yc("retryDelaySeedMs",1e4,t),this.eb=yc("forwardChannelMaxRetries",2,t),this.xa=yc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new cN(t&&t.concurrentRequestLimit),this.Ja=new fG,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}x=wN.prototype;x.ra=8;x.H=1;function dE(t){if(EN(t),t.H==3){var e=t.W++,n=Jr(t.I);if(Ne(n,"SID",t.K),Ne(n,"RID",e),Ne(n,"TYPE","terminate"),Lc(t,n),e=new kc(t,t.l,e),e.L=2,e.A=Ip(Jr(n)),n=!1,Q.navigator&&Q.navigator.sendBeacon)try{n=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Q.Image&&(new Image().src=e.A,n=!0),n||(e.g=xN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Oc(e)}SN(t)}function Tp(t){t.g&&(fE(t),t.g.cancel(),t.g=null)}function EN(t){Tp(t),t.u&&(Q.clearTimeout(t.u),t.u=null),up(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Q.clearTimeout(t.m),t.m=null)}function bp(t){if(!lN(t.i)&&!t.m){t.m=!0;var e=t.Na;Dc||HR(),Tc||(Dc(),Tc=!0),nE.add(e,t),t.C=0}}function EG(t,e){return dN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Nc(Rt(t.Na,t,e),bN(t,t.C)),t.C++,!0)}x.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new kc(this,this.l,t),s=this.s;if(this.U&&(s?(s=OR(s),FR(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=IN(this,i,e),n=Jr(this.I),Ne(n,"RID",t),Ne(n,"CVER",22),this.F&&Ne(n,"X-HTTP-Session-Id",this.F),Lc(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(_N(s)))+"&"+e:this.o&&lE(n,this.o,s)),uE(this.i,i),this.bb&&Ne(n,"TYPE","init"),this.P?(Ne(n,"$req",e),Ne(n,"SID","null"),i.aa=!0,$w(i,n,null)):$w(i,n,e),this.H=2}}else this.H==3&&(t?AR(this,t):this.j.length==0||lN(this.i)||AR(this))};function AR(t,e){var n;e?n=e.m:n=t.W++;let r=Jr(t.I);Ne(r,"SID",t.K),Ne(r,"RID",n),Ne(r,"AID",t.V),Lc(t,r),t.o&&t.s&&lE(r,t.o,t.s),n=new kc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=IN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),uE(t.i,n),$w(n,r,e)}function Lc(t,e){t.na&&Yw(t.na,function(n,r){Ne(e,r,n)}),t.h&&iN({},function(n,r){Ne(e,r,n)})}function IN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Rt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{pG(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function CN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Dc||HR(),Tc||(Dc(),Tc=!0),nE.add(e,t),t.A=0}}function hE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Nc(Rt(t.Ma,t),bN(t,t.A)),t.A++,!0)}x.Ma=function(){if(this.u=null,DN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Nc(Rt(this.jb,this),t)}};x.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Bt(10),Tp(this),DN(this))};function fE(t){t.B!=null&&(Q.clearTimeout(t.B),t.B=null)}function DN(t){t.g=new kc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Jr(t.wa);Ne(e,"RID","rpc"),Ne(e,"SID",t.K),Ne(e,"AID",t.V),Ne(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ne(e,"TO",t.qa),Ne(e,"TYPE","xmlhttp"),Lc(t,e),t.o&&t.s&&lE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Ip(Jr(e)),n.u=null,n.S=!0,eN(n,t)}x.ib=function(){this.v!=null&&(this.v=null,Tp(this),hE(this),Bt(19))};function up(t){t.v!=null&&(Q.clearTimeout(t.v),t.v=null)}function TN(t,e){var n=null;if(t.g==e){up(t),fE(t),t.g=null;var r=2}else if(qw(t.i,e))n=e.F,hN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=vp(),bt(r,new QR(r,n)),bp(t)}else CN(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&EG(t,e)||r==2&&hE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ns(t,5);break;case 4:Ns(t,10);break;case 3:Ns(t,6);break;default:Ns(t,2)}}}function bN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ns(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Rt(t.pb,t);n||(n=new Ps("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||op(n,"https"),Ip(n)),gG(n.toString(),r)}else Bt(2);t.H=0,t.h&&t.h.za(e),SN(t),EN(t)}x.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Bt(2)):(this.l.info("Failed to ping google.com"),Bt(1))};function SN(t){if(t.H=0,t.ma=[],t.h){let e=fN(t.i);(e.length!=0||t.j.length!=0)&&(_R(t.ma,e),_R(t.ma,t.j),t.i.i.length=0,Kw(t.j),t.j.length=0),t.h.ya()}}function AN(t,e,n){var r=n instanceof Ps?Jr(n):new Ps(n);if(r.g!="")e&&(r.g=e+"."+r.g),ap(r,r.m);else{var i=Q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ps(null);r&&op(s,r),e&&(s.g=e),i&&ap(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ne(r,n,e),Ne(r,"VER",t.ra),Lc(t,r),r}function xN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new We(new Fc({ob:n})):new We(t.va),e.Oa(t.J),e}x.isActive=function(){return!!this.h&&this.h.isActive(this)};function MN(){}x=MN.prototype;x.Ba=function(){};x.Aa=function(){};x.za=function(){};x.ya=function(){};x.isActive=function(){return!0};x.Va=function(){};function cp(){if(pa&&!(10<=Number(L4)))throw Error("Environmental error: no available transport.")}cp.prototype.g=function(t,e){return new un(t,e)};function un(t,e){pt.call(this),this.g=new wN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ic(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ic(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ma(this)}gt(un,pt);un.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Bt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=AN(t,null,t.Y),bp(t)};un.prototype.close=function(){dE(this.g)};un.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=tE(t),t=n);e.j.push(new lG(e.fb++,t)),e.H==3&&bp(e)};un.prototype.N=function(){this.g.h=null,delete this.j,dE(this.g),delete this.g,un.$.N.call(this)};function RN(t){oE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}gt(RN,oE);function NN(){aE.call(this),this.status=1}gt(NN,aE);function ma(t){this.g=t}gt(ma,MN);ma.prototype.Ba=function(){bt(this.g,"a")};ma.prototype.Aa=function(t){bt(this.g,new RN(t))};ma.prototype.za=function(t){bt(this.g,new NN)};ma.prototype.ya=function(){bt(this.g,"b")};function IG(){this.blockSize=-1}function Gn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}gt(Gn,IG);Gn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Mw(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Gn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Mw(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Mw(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Mw(this,r),i=0;break}}this.h=i,this.i+=e};Gn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ie(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var CG={};function pE(t){return-128<=t&&128>t?O4(t,function(e){return new Ie([e|0],0>e?-1:0)}):new Ie([t|0],0>t?-1:0)}function gr(t){if(isNaN(t)||!isFinite(t))return fa;if(0>t)return Tt(gr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Gw;return new Ie(e,0)}function PN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Tt(PN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=gr(Math.pow(e,8)),r=fa,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=gr(Math.pow(e,s)),r=r.R(s).add(gr(o))):(r=r.R(n),r=r.add(gr(o)))}return r}var Gw=4294967296,fa=pE(0),zw=pE(1),xR=pE(16777216);x=Ie.prototype;x.ea=function(){if(An(this))return-Tt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Gw+r)*e,e*=Gw}return t};x.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Xr(this))return"0";if(An(this))return"-"+Tt(this).toString(t);for(var e=gr(Math.pow(t,6)),n=this,r="";;){var i=dp(n,e).g;n=lp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Xr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};x.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Xr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function An(t){return t.h==-1}x.X=function(t){return t=lp(this,t),An(t)?-1:Xr(t)?0:1};function Tt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ie(n,~t.h).add(zw)}x.abs=function(){return An(this)?Tt(this):this};x.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ie(n,n[n.length-1]&-2147483648?-1:0)};function lp(t,e){return t.add(Tt(e))}x.R=function(t){if(Xr(this)||Xr(t))return fa;if(An(this))return An(t)?Tt(this).R(Tt(t)):Tt(Tt(this).R(t));if(An(t))return Tt(this.R(Tt(t)));if(0>this.X(xR)&&0>t.X(xR))return gr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,sp(n,2*r+2*i),n[2*r+2*i+1]+=s*u,sp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,sp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,sp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ie(n,0)};function sp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function vc(t,e){this.g=t,this.h=e}function dp(t,e){if(Xr(e))throw Error("division by zero");if(Xr(t))return new vc(fa,fa);if(An(t))return e=dp(Tt(t),e),new vc(Tt(e.g),Tt(e.h));if(An(e))return e=dp(t,Tt(e)),new vc(Tt(e.g),e.h);if(30<t.g.length){if(An(t)||An(e))throw Error("slowDivide_ only works with positive integers.");for(var n=zw,r=e;0>=r.X(t);)n=MR(n),r=MR(r);var i=da(n,1),s=da(r,1);for(r=da(r,2),n=da(n,2);!Xr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=da(r,1),n=da(n,1)}return e=lp(t,i.R(e)),new vc(i,e)}for(i=fa;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=gr(n),o=s.R(e);An(o)||0<o.X(t);)n-=r,s=gr(n),o=s.R(e);Xr(s)&&(s=zw),i=i.add(s),t=lp(t,o)}return new vc(i,t)}x.gb=function(t){return dp(this,t).h};x.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ie(n,this.h&t.h)};x.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ie(n,this.h|t.h)};x.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ie(n,this.h^t.h)};function MR(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ie(n,t.h)}function da(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ie(i,t.h)}cp.prototype.createWebChannel=cp.prototype.g;un.prototype.send=un.prototype.u;un.prototype.open=un.prototype.m;un.prototype.close=un.prototype.close;_p.NO_ERROR=0;_p.TIMEOUT=8;_p.HTTP_ERROR=6;YR.COMPLETE="complete";ZR.EventType=Pc;Pc.OPEN="a";Pc.CLOSE="b";Pc.ERROR="c";Pc.MESSAGE="d";pt.prototype.listen=pt.prototype.O;We.prototype.listenOnce=We.prototype.P;We.prototype.getLastError=We.prototype.Sa;We.prototype.getLastErrorCode=We.prototype.Ia;We.prototype.getStatus=We.prototype.da;We.prototype.getResponseJson=We.prototype.Wa;We.prototype.getResponseText=We.prototype.ja;We.prototype.send=We.prototype.ha;We.prototype.setWithCredentials=We.prototype.Oa;Gn.prototype.digest=Gn.prototype.l;Gn.prototype.reset=Gn.prototype.reset;Gn.prototype.update=Gn.prototype.j;Ie.prototype.add=Ie.prototype.add;Ie.prototype.multiply=Ie.prototype.R;Ie.prototype.modulo=Ie.prototype.gb;Ie.prototype.compare=Ie.prototype.X;Ie.prototype.toNumber=Ie.prototype.ea;Ie.prototype.toString=Ie.prototype.toString;Ie.prototype.getBits=Ie.prototype.D;Ie.fromNumber=gr;Ie.fromString=PN;var kN=zn.createWebChannelTransport=function(){return new cp},ON=zn.getStatEventTarget=function(){return vp()},Sp=zn.ErrorCode=_p,FN=zn.EventType=YR,VN=zn.Event=ks,gE=zn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},rre=zn.FetchXmlHttpFactory=Fc,jc=zn.WebChannel=ZR,LN=zn.XhrIo=We,jN=zn.Md5=Gn,Os=zn.Integer=Ie;var UN="@firebase/firestore";var st=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};st.UNAUTHENTICATED=new st(null),st.GOOGLE_CREDENTIALS=new st("google-credentials-uid"),st.FIRST_PARTY=new st("first-party-uid"),st.MOCK_USER=new st("mock-user");var Wa="10.10.0";var Pi=new hi("@firebase/firestore");function Ea(){return Pi.logLevel}function vC(t){Pi.setLogLevel(t)}function I(t,...e){if(Pi.logLevel<=vn.DEBUG){let n=e.map(_C);Pi.debug(`Firestore (${Wa}): ${t}`,...n)}}function Ze(t,...e){if(Pi.logLevel<=vn.ERROR){let n=e.map(_C);Pi.error(`Firestore (${Wa}): ${t}`,...n)}}function Mn(t,...e){if(Pi.logLevel<=vn.WARN){let n=e.map(_C);Pi.warn(`Firestore (${Wa}): ${t}`,...n)}}function _C(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function P(t="Unexpected state"){let e=`FIRESTORE (${Wa}) INTERNAL ASSERTION FAILED: `+t;throw Ze(e),new Error(e)}function V(t,e){t||P()}function UP(t,e){t||P()}function A(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends Pb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ot=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Lp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},wE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(st.UNAUTHENTICATED))}shutdown(){}},EE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},IE=class{constructor(e){this.t=e,this.currentUser=st.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ot,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>v(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ot)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(V(typeof r.accessToken=="string"),new Lp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return V(e===null||typeof e=="string"),new st(e)}},CE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=st.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},DE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new CE(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(st.FIRST_PARTY))}shutdown(){}invalidateToken(){}},TE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},bE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(V(typeof n.token=="string"),this.R=n.token,new TE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function DG(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var jp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=DG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function X(t,e){return t<e?-1:t>e?1:0}function Ma(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function BP(t){return t+"\0"}var je=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new je(0,0))}static max(){return new t(new je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Up=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&P(),r===void 0?r=e.length-n:r>e.length-n&&P(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},pe=class t extends Up{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},TG=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class t extends Up{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return TG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var S=class t{constructor(e){this.path=e}static fromPath(e){return new t(pe.fromString(e))}static fromName(e){return new t(pe.fromString(e).popFirst(5))}static empty(){return new t(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new pe(e.slice()))}};var Ra=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function SE(t){return t.fields.find(e=>e.kind===2)}function Vs(t){return t.fields.filter(e=>e.kind!==2)}Ra.UNKNOWN_ID=-1;var Sa=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Zc=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Rn.min())}};function $P(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new je(n+1,0):new je(n,r));return new Rn(i,S.empty(),e)}function HP(t){return new Rn(t.readTime,t.key,-1)}var Rn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(B.min(),S.empty(),-1)}static max(){return new t(B.max(),S.empty(),-1)}};function wC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=S.comparator(t.documentKey,e.documentKey),n!==0?n:X(t.largestBatchId,e.largestBatchId))}var qP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Bp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Hi(t){return v(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==qP)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&P(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var $p=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ot,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Hs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=EC(r.target.error);this.V.reject(new Hs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Hs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(I("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new xE(n)}},ni=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Ru())===12.2&&Ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return I("SimpleDb","Removing database:",e),Ls(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ud())return!1;if(t.C())return!0;let e=Ru(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(I("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Hs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Hs(e,o))},i.onupgradeneeded=s=>{I("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{I("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=$p.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),m.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(I("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},AE=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ls(this.k.delete())}},Hs=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function qi(t){return t.name==="IndexedDbTransactionError"}var xE=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ls(r)}add(e){return I("SimpleDb","ADD",this.store.name,e,e),Ls(this.store.add(e))}get(e){return Ls(this.store.get(e)).next(n=>(n===void 0&&(n=null),I("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return I("SimpleDb","DELETE",this.store.name,e),Ls(this.store.delete(e))}count(){return I("SimpleDb","COUNT",this.store.name),Ls(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){I("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=EC(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new AE(a),c=n(a.primaryKey,a.value,u);if(c instanceof m){let l=c.catch(d=>(u.done(),m.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Ls(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=EC(r.target.error);n(i)}})}var BN=!1;function EC(t){let e=ni.S(Ru());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return BN||(BN=!0,setTimeout(()=>{throw r},0)),r}}return t}var ME=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){I("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{I("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){qi(n)?I("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Hi(n)}yield this.ee(6e4)}))}},RE=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return I("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(I("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=HP(s);wC(o,r)>0&&(r=o)}),new Rn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var cn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function _l(t){return t==null}function Xc(t){return t===0&&1/t==-1/0}function GP(t){return typeof t=="number"&&Number.isInteger(t)&&!Xc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function $t(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$N(e)),e=bG(t.get(n),e);return $N(e)}function bG(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function $N(t){return t+""}function mr(t){let e=t.length;if(V(e>=2),e===2)return V(t.charAt(0)===""&&t.charAt(1)===""),pe.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&P(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:P()}s=o+2}return new pe(r)}var HN=["userId","batchId"];function Np(t,e){return[t,$t(e)]}function zP(t,e,n){return[t,$t(e),n]}var SG={},AG=["prefixPath","collectionGroup","readTime","documentId"],xG=["prefixPath","collectionGroup","documentId"],MG=["collectionGroup","readTime","prefixPath","documentId"],RG=["canonicalId","targetId"],NG=["targetId","path"],PG=["path","targetId"],kG=["collectionId","parent"],OG=["indexId","uid"],FG=["uid","sequenceNumber"],VG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],LG=["indexId","uid","orderedDocumentKey"],jG=["userId","collectionPath","documentId"],UG=["userId","collectionPath","largestBatchId"],BG=["userId","collectionGroup","largestBatchId"],WP=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$G=[...WP,"documentOverlays"],KP=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],QP=KP,HG=[...QP,"indexConfiguration","indexState","indexEntries"];var Jc=class extends Bp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function yt(t,e){let n=A(t);return ni.M(n.ae,e)}function qN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function to(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function YP(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Pe=class t{constructor(e,n){this.comparator=e,this.root=n||vr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ba(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ba(this.root,e,this.comparator,!1)}getReverseIterator(){return new ba(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ba(this.root,e,this.comparator,!0)}},ba=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},vr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw P();let e=this.left.check();if(e!==this.right.check())throw P();return e+(this.isRed()?0:1)}};vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw P()}get value(){throw P()}get color(){throw P()}get left(){throw P()}get right(){throw P()}copy(e,n,r,i,s){return this}insert(e,n,r){return new vr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class t{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Hp(this.data.getIterator())}getIteratorFrom(e){return new Hp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Hp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ya(t){return t.hasNext()?t.getNext():void 0}var ln=class t{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new t([])}unionWith(e){let n=new Se(Xe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ma(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var qp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function ZP(){return typeof atob<"u"}var mt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new qp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};mt.EMPTY_BYTE_STRING=new mt("");var qG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(t){if(V(!!t),typeof t=="string"){let e=0,n=qG.exec(t);if(V(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(t.seconds),nanos:Ke(t.nanos)}}function Ke(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Oi(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}function kg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function IC(t){let e=t.mapValue.fields.__previous_value__;return kg(e)?IC(e):e}function el(t){let e=ki(t.mapValue.fields.__local_write_time__.timestampValue);return new je(e.seconds,e.nanos)}var NE=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Fi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Ri={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Pp={nullValue:"NULL_VALUE"};function qs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?kg(t)?4:XP(t)?9007199254740991:10:P()}function Er(t,e){if(t===e)return!0;let n=qs(t);if(n!==qs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return el(t).isEqual(el(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=ki(i.timestampValue),a=ki(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Oi(i.bytesValue).isEqual(Oi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ke(i.doubleValue),a=Ke(s.doubleValue);return o===a?Xc(o)===Xc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ma(t.arrayValue.values||[],e.arrayValue.values||[],Er);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(qN(o)!==qN(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Er(o[u],a[u])))return!1;return!0}(t,e);default:return P()}}function tl(t,e){return(t.values||[]).find(n=>Er(n,e))!==void 0}function Vi(t,e){if(t===e)return 0;let n=qs(t),r=qs(e);if(n!==r)return X(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return X(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ke(s.integerValue||s.doubleValue),u=Ke(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return GN(t.timestampValue,e.timestampValue);case 4:return GN(el(t),el(e));case 5:return X(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Oi(s),u=Oi(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=X(a[c],u[c]);if(l!==0)return l}return X(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=X(Ke(s.latitude),Ke(o.latitude));return a!==0?a:X(Ke(s.longitude),Ke(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=Vi(a[c],u[c]);if(l)return l}return X(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ri.mapValue&&o===Ri.mapValue)return 0;if(s===Ri.mapValue)return 1;if(o===Ri.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=X(u[d],l[d]);if(h!==0)return h;let f=Vi(a[u[d]],c[l[d]]);if(f!==0)return f}return X(u.length,l.length)}(t.mapValue,e.mapValue);default:throw P()}}function GN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return X(t,e);let n=ki(t),r=ki(e),i=X(n.seconds,r.seconds);return i!==0?i:X(n.nanos,r.nanos)}function Na(t){return PE(t)}function PE(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=ki(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Oi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return S.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=PE(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${PE(n.fields[o])}`;return i+"}"}(t.mapValue):P()}function Gs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function kE(t){return!!t&&"integerValue"in t}function nl(t){return!!t&&"arrayValue"in t}function zN(t){return!!t&&"nullValue"in t}function WN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kp(t){return!!t&&"mapValue"in t}function zc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return to(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=zc(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function XP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function GG(t){return"nullValue"in t?Pp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Gs(Fi.empty(),S.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:P()}function zG(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Gs(Fi.empty(),S.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ri:P()}function KN(t,e){let n=Vi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function QN(t,e){let n=Vi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var kt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zc(n)}setAll(e){let n=Xe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=zc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());kp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Er(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];kp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){to(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(zc(this.value))}};function JP(t){let e=[];return to(t.fields,(n,r)=>{let i=new Xe([n]);if(kp(r)){let s=JP(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new ln(e)}var at=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,B.min(),B.min(),B.min(),kt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,B.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,B.min(),B.min(),kt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,B.min(),B.min(),kt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ir=class{constructor(e,n){this.position=e,this.inclusive=n}};function YN(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=S.comparator(S.fromName(o.referenceValue),n.key):r=Vi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ZN(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Er(t.position[n],e.position[n]))return!1;return!0}var zs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function WG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Gp=class{},de=class t extends Gp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new VE(e,n,r):n==="array-contains"?new UE(e,r):n==="in"?new zp(e,r):n==="not-in"?new BE(e,r):n==="array-contains-any"?new $E(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new LE(e,r):new jE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Vi(n,this.value)):n!==null&&qs(this.value)===qs(n)&&this.matchesComparison(Vi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return P()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ce=class t extends Gp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Pa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Pa(t){return t.op==="and"}function OE(t){return t.op==="or"}function CC(t){return ek(t)&&Pa(t)}function ek(t){for(let e of t.filters)if(e instanceof Ce)return!1;return!0}function FE(t){if(t instanceof de)return t.field.canonicalString()+t.op.toString()+Na(t.value);if(CC(t))return t.filters.map(e=>FE(e)).join(",");{let e=t.filters.map(n=>FE(n)).join(",");return`${t.op}(${e})`}}function tk(t,e){return t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&Er(r.value,i.value)}(t,e):t instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&tk(o,i.filters[a]),!0):!1}(t,e):void P()}function nk(t,e){let n=t.filters.concat(e);return Ce.create(n,t.op)}function rk(t){return t instanceof de?function(n){return`${n.field.canonicalString()} ${n.op} ${Na(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(rk).join(" ,")+"}"}(t):"Filter"}var VE=class extends de{constructor(e,n,r){super(e,n,r),this.key=S.fromName(r.referenceValue)}matches(e){let n=S.comparator(e.key,this.key);return this.matchesComparison(n)}},LE=class extends de{constructor(e,n){super(e,"in",n),this.keys=ik("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},jE=class extends de{constructor(e,n){super(e,"not-in",n),this.keys=ik("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function ik(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>S.fromName(r.referenceValue))}var UE=class extends de{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return nl(n)&&tl(n.arrayValue,this.value)}},zp=class extends de{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&tl(this.value.arrayValue,n)}},BE=class extends de{constructor(e,n){super(e,"not-in",n)}matches(e){if(tl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!tl(this.value.arrayValue,n)}},$E=class extends de{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!nl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>tl(this.value.arrayValue,r))}};var HE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function qE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new HE(t,e,n,r,i,s,o)}function Ws(t){let e=A(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>FE(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),_l(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Na(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Na(r)).join(",")),e.ce=n}return e.ce}function wl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!WG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!tk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ZN(t.startAt,e.startAt)&&ZN(t.endAt,e.endAt)}function Wp(t){return S.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Kp(t,e){return t.filters.filter(n=>n instanceof de&&n.field.isEqual(e))}function XN(t,e,n){let r=Pp,i=!0;for(let s of Kp(t,e)){let o=Pp,a=!0;switch(s.op){case"<":case"<=":o=GG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Pp}KN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];KN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function JN(t,e,n){let r=Ri,i=!0;for(let s of Kp(t,e)){let o=Ri,a=!0;switch(s.op){case">=":case">":o=zG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ri}QN({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];QN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Wn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function sk(t,e,n,r,i,s,o,a){return new Wn(t,e,n,r,i,s,o,a)}function Ka(t){return new Wn(t)}function eP(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function DC(t){return t.collectionGroup!==null}function Aa(t){let e=A(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(Xe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new zs(s,r))}),n.has(Xe.keyField().canonicalString())||e.le.push(new zs(Xe.keyField(),r))}return e.le}function Ht(t){let e=A(t);return e.he||(e.he=KG(e,Aa(t))),e.he}function KG(t,e){if(t.limitType==="F")return qE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new zs(i.field,s)});let n=t.endAt?new Ir(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ir(t.startAt.position,t.startAt.inclusive):null;return qE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function GE(t,e){let n=t.filters.concat([e]);return new Wn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Qp(t,e,n){return new Wn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function El(t,e){return wl(Ht(t),Ht(e))&&t.limitType===e.limitType}function ok(t){return`${Ws(Ht(t))}|lt:${t.limitType}`}function Ia(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>rk(i)).join(", ")}]`),_l(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Na(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Na(i)).join(",")),`Target(${r})`}(Ht(t))}; limitType=${t.limitType})`}function Il(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):S.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Aa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=YN(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Aa(r),i)||r.endAt&&!function(o,a,u){let c=YN(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Aa(r),i))}(t,e)}function ak(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function uk(t){return(e,n)=>{let r=!1;for(let i of Aa(t)){let s=QG(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function QG(t,e,n){let r=t.field.isKeyField()?S.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Vi(u,c):P()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return P()}}var Cr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){to(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return YP(this.inner)}size(){return this.innerSize}};var YG=new Pe(S.comparator);function tn(){return YG}var ck=new Pe(S.comparator);function qc(...t){let e=ck;for(let n of t)e=e.insert(n.key,n);return e}function lk(t){let e=ck;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function yr(){return Wc()}function dk(){return Wc()}function Wc(){return new Cr(t=>t.toString(),(t,e)=>t.isEqual(e))}var ZG=new Pe(S.comparator),XG=new Se(S.comparator);function ee(...t){let e=XG;for(let n of t)e=e.add(n);return e}var JG=new Se(X);function TC(){return JG}function hk(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xc(e)?"-0":e}}function fk(t){return{integerValue:""+t}}function pk(t,e){return GP(e)?fk(e):hk(t,e)}var ka=class{constructor(){this._=void 0}};function ez(t,e,n){return t instanceof Li?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&kg(s)&&(s=IC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ri?mk(t,e):t instanceof ii?yk(t,e):function(i,s){let o=gk(i,s),a=tP(o)+tP(i.Ie);return kE(o)&&kE(i.Ie)?fk(a):hk(i.serializer,a)}(t,e)}function tz(t,e,n){return t instanceof ri?mk(t,e):t instanceof ii?yk(t,e):n}function gk(t,e){return t instanceof ji?function(r){return kE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Li=class extends ka{},ri=class extends ka{constructor(e){super(),this.elements=e}};function mk(t,e){let n=vk(e);for(let r of t.elements)n.some(i=>Er(i,r))||n.push(r);return{arrayValue:{values:n}}}var ii=class extends ka{constructor(e){super(),this.elements=e}};function yk(t,e){let n=vk(e);for(let r of t.elements)n=n.filter(i=>!Er(i,r));return{arrayValue:{values:n}}}var ji=class extends ka{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function tP(t){return Ke(t.integerValue||t.doubleValue)}function vk(t){return nl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ks=class{constructor(e,n){this.field=e,this.transform=n}};function nz(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ri&&i instanceof ri||r instanceof ii&&i instanceof ii?Ma(r.elements,i.elements,Er):r instanceof ji&&i instanceof ji?Er(r.Ie,i.Ie):r instanceof Li&&i instanceof Li}(t.transform,e.transform)}var zE=class{constructor(e,n){this.version=e,this.transformResults=n}},Qe=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Op(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Oa=class{};function _k(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bi(t.key,Qe.none()):new Ui(t.key,t.data,Qe.none());{let n=t.data,r=kt.empty(),i=new Se(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Kn(t.key,r,new ln(i.toArray()),Qe.none())}}function rz(t,e,n){t instanceof Ui?function(i,s,o){let a=i.value.clone(),u=rP(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Kn?function(i,s,o){if(!Op(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=rP(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(wk(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Kc(t,e,n,r){return t instanceof Ui?function(s,o,a,u){if(!Op(s.precondition,o))return a;let c=s.value.clone(),l=iP(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Kn?function(s,o,a,u){if(!Op(s.precondition,o))return a;let c=iP(s.fieldTransforms,u,o),l=o.data;return l.setAll(wk(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Op(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function iz(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=gk(r.transform,i||null);s!=null&&(n===null&&(n=kt.empty()),n.set(r.field,s))}return n||null}function nP(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ma(r,i,(s,o)=>nz(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Ui=class extends Oa{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Kn=class extends Oa{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function wk(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function rP(t,e,n){let r=new Map;V(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,tz(o,a,n[i]))}return r}function iP(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,ez(s,o,e))}return r}var Bi=class extends Oa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},rl=class extends Oa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var il=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&rz(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Kc(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Kc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=dk();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=_k(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ee())}isEqual(e){return this.batchId===e.batchId&&Ma(this.mutations,e.mutations,(n,r)=>nP(n,r))&&Ma(this.baseMutations,e.baseMutations,(n,r)=>nP(n,r))}},WE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){V(e.mutations.length===r.length);let i=function(){return ZG}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var sl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var KE=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var rt,fe;function Ek(t){switch(t){default:return P();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function Ik(t){if(t===void 0)return Ze("GRPC error has no .code"),y.UNKNOWN;switch(t){case rt.OK:return y.OK;case rt.CANCELLED:return y.CANCELLED;case rt.UNKNOWN:return y.UNKNOWN;case rt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case rt.INTERNAL:return y.INTERNAL;case rt.UNAVAILABLE:return y.UNAVAILABLE;case rt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case rt.NOT_FOUND:return y.NOT_FOUND;case rt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case rt.ABORTED:return y.ABORTED;case rt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case rt.DATA_LOSS:return y.DATA_LOSS;default:return P()}}(fe=rt||(rt={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var sP=null;function Ck(){return new TextEncoder}var sz=new Os([4294967295,4294967295],0);function oP(t){let e=Ck().encode(t),n=new jN;return n.update(e),new Uint8Array(n.digest())}function aP(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Os([n,r],0),new Os([i,s],0)]}var QE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $s(`Invalid padding: ${n}`);if(r<0)throw new $s(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $s(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $s(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Os.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Os.fromNumber(r)));return i.compare(sz)===1&&(i=new Os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=oP(e),[r,i]=aP(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=oP(e),[r,i]=aP(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},$s=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ol=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,al.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(B.min(),i,new Pe(X),tn(),ee())}},al=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,ee(),ee(),ee())}};var xa=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Yp=class{constructor(e,n){this.targetId=e,this.fe=n}},Zp=class{constructor(e,n,r=mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Xp=class{constructor(){this.ge=0,this.pe=cP(),this.ye=mt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ee(),n=ee(),r=ee();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:P()}}),new al(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=cP()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,V(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},YE=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=tn(),this.Qe=uP(),this.Ke=new Pe(X)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:P()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Wp(s))if(r===0){let o=new S(s.path);this.We(n,o,at.newNoDocument(o,B.min()))}else V(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}sP?.tt(function(l,d,h,f,p){var g,_,C,k,T,H;let z={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Y=d.unchangedNames;return Y&&(z.bloomFilter={applied:p===0,hashCount:(g=Y?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(k=(C=(_=Y?.bits)===null||_===void 0?void 0:_.bitmap)===null||C===void 0?void 0:C.length)!==null&&k!==void 0?k:0,padding:(H=(T=Y?.bits)===null||T===void 0?void 0:T.padding)!==null&&H!==void 0?H:0,mightContain:De=>{var Kt;return(Kt=f?.mightContain(De))!==null&&Kt!==void 0&&Kt}}),z}(o,e.fe,this.Be.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Oi(r).toUint8Array()}catch(u){if(u instanceof qp)return Mn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new QE(o,i,s)}catch(u){return Mn(u instanceof $s?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Wp(a.target)){let u=new S(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,at.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ee();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new ol(e,n,this.Ke,this.qe,r);return this.qe=tn(),this.Qe=uP(),this.Ke=new Pe(X),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Xp,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Se(X),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Xp),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function uP(){return new Pe(S.comparator)}function cP(){return new Pe(S.comparator)}var oz=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),az=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),uz=(()=>({and:"AND",or:"OR"}))(),ZE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function XE(t,e){return t.useProto3Json||_l(e)?e:{value:e}}function Fa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cz(t,e){return Fa(t,e.toTimestamp())}function Je(t){return V(!!t),B.fromTimestamp(function(n){let r=ki(n);return new je(r.seconds,r.nanos)}(t))}function bC(t,e){return JE(t,e).canonicalString()}function JE(t,e){let n=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Tk(t){let e=pe.fromString(t);return V(Ok(e)),e}function ul(t,e){return bC(t.databaseId,e.path)}function _r(t,e){let n=Tk(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new S(Ak(n))}function bk(t,e){return bC(t.databaseId,e)}function Sk(t){let e=Tk(t);return e.length===4?pe.emptyPath():Ak(e)}function eI(t){return new pe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ak(t){return V(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function lP(t,e,n){return{name:ul(t,e),fields:n.value.mapValue.fields}}function xk(t,e,n){let r=_r(t,e.name),i=Je(e.updateTime),s=e.createTime?Je(e.createTime):B.min(),o=new kt({mapValue:{fields:e.fields}}),a=at.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function lz(t,e){return"found"in e?function(r,i){V(!!i.found),i.found.name,i.found.updateTime;let s=_r(r,i.found.name),o=Je(i.found.updateTime),a=i.found.createTime?Je(i.found.createTime):B.min(),u=new kt({mapValue:{fields:i.found.fields}});return at.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){V(!!i.missing),V(!!i.readTime);let s=_r(r,i.missing),o=Je(i.readTime);return at.newNoDocument(s,o)}(t,e):P()}function dz(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:P()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(V(l===void 0||typeof l=="string"),mt.fromBase64String(l||"")):(V(l===void 0||l instanceof Uint8Array),mt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:Ik(c.code);return new w(l,c.message||"")}(o);n=new Zp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=_r(t,r.document.name),s=Je(r.document.updateTime),o=r.document.createTime?Je(r.document.createTime):B.min(),a=new kt({mapValue:{fields:r.document.fields}}),u=at.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new xa(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=_r(t,r.document),s=r.readTime?Je(r.readTime):B.min(),o=at.newNoDocument(i,s),a=r.removedTargetIds||[];n=new xa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=_r(t,r.document),s=r.removedTargetIds||[];n=new xa([],s,i,null)}else{if(!("filter"in e))return P();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new KE(i,s),a=r.targetId;n=new Yp(a,o)}}return n}function cl(t,e){let n;if(e instanceof Ui)n={update:lP(t,e.key,e.value)};else if(e instanceof Bi)n={delete:ul(t,e.key)};else if(e instanceof Kn)n={update:lP(t,e.key,e.data),updateMask:yz(e.fieldMask)};else{if(!(e instanceof rl))return P();n={verify:ul(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Li)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ri)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ii)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ji)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw P()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:cz(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:P()}(t,e.precondition)),n}function tI(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Qe.updateTime(Je(s.updateTime)):s.exists!==void 0?Qe.exists(s.exists):Qe.none()}(e.currentDocument):Qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)V(a.setToServerValue==="REQUEST_TIME"),u=new Li;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new ri(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new ii(l)}else"increment"in a?u=new ji(o,a.increment):P();let c=Xe.fromServerFormat(a.fieldPath);return new Ks(c,u)}(t,i)):[];if(e.update){e.update.name;let i=_r(t,e.update.name),s=new kt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new ln(c.map(l=>Xe.fromServerFormat(l)))}(e.updateMask);return new Kn(i,s,o,n,r)}return new Ui(i,s,n,r)}if(e.delete){let i=_r(t,e.delete);return new Bi(i,n)}if(e.verify){let i=_r(t,e.verify);return new rl(i,n)}return P()}function hz(t,e){return t&&t.length>0?(V(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Je(i.updateTime):Je(s);return o.isEqual(B.min())&&(o=Je(s)),new zE(o,i.transformResults||[])}(n,e))):[]}function Mk(t,e){return{documents:[bk(t,e.path)]}}function Rk(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=bk(t,i);let s=function(c){if(c.length!==0)return kk(Ce.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Ca(h.field),direction:pz(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=XE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function Nk(t){let e=Sk(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){V(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=Pk(d);return h instanceof Ce&&CC(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new zs(Da(p.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,_l(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new Ir(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new Ir(f,h)}(n.endAt)),sk(e,i,o,s,a,"F",u,c)}function fz(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return P()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Pk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Da(n.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Da(n.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Da(n.unaryFilter.field);return de.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Da(n.unaryFilter.field);return de.create(o,"!=",{nullValue:"NULL_VALUE"});default:return P()}}(t):t.fieldFilter!==void 0?function(n){return de.create(Da(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return P()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>Pk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return P()}}(n.compositeFilter.op))}(t):P()}function pz(t){return oz[t]}function gz(t){return az[t]}function mz(t){return uz[t]}function Ca(t){return{fieldPath:t.canonicalString()}}function Da(t){return Xe.fromServerFormat(t.fieldPath)}function kk(t){return t instanceof de?function(n){if(n.op==="=="){if(WN(n.value))return{unaryFilter:{field:Ca(n.field),op:"IS_NAN"}};if(zN(n.value))return{unaryFilter:{field:Ca(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(WN(n.value))return{unaryFilter:{field:Ca(n.field),op:"IS_NOT_NAN"}};if(zN(n.value))return{unaryFilter:{field:Ca(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ca(n.field),op:gz(n.op),value:n.value}}}(t):t instanceof Ce?function(n){let r=n.getFilters().map(i=>kk(i));return r.length===1?r[0]:{compositeFilter:{op:mz(n.op),filters:r}}}(t):P()}function yz(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ok(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Va=class t{constructor(e,n,r,i,s=B.min(),o=B.min(),a=mt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Jp=class{constructor(e){this.ct=e}};function vz(t,e){let n;if(e.document)n=xk(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=S.fromSegments(e.noDocument.path),i=Ys(e.noDocument.readTime);n=at.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return P();{let r=S.fromSegments(e.unknownDocument.path),i=Ys(e.unknownDocument.version);n=at.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new je(i[0],i[1]);return B.fromTimestamp(s)}(e.readTime)),n}function dP(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:eg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:ul(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Fa(s,o.version.toTimestamp()),createTime:Fa(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Qs(e.version)};else{if(!e.isUnknownDocument())return P();r.unknownDocument={path:n.path.toArray(),version:Qs(e.version)}}return r}function eg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Qs(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ys(t){let e=new je(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function js(t,e){let n=(e.baseMutations||[]).map(s=>tI(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>tI(t.ct,s)),i=je.fromMillis(e.localWriteTimeMs);return new il(e.batchId,i,n,r)}function Gc(t){let e=Ys(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ys(t.lastLimboFreeSnapshotVersion):B.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return V(s.documents.length===1),Ht(Ka(Sk(s.documents[0])))}(t.query):function(s){return Ht(Nk(s))}(t.query),new Va(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,mt.fromBase64String(t.resumeToken))}function Fk(t,e){let n=Qs(e.snapshotVersion),r=Qs(e.lastLimboFreeSnapshotVersion),i;i=Wp(e.target)?Mk(t.ct,e.target):Rk(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ws(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function SC(t){let e=Nk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Qp(e,e.limit,"L"):e}function mE(t,e){return new sl(e.largestBatchId,tI(t.ct,e.overlayMutation))}function hP(t,e){let n=e.path.lastSegment();return[t,$t(e.path.popLast()),n]}function fP(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Qs(r.readTime),documentKey:$t(r.documentKey.path),largestBatchId:r.largestBatchId}}var nI=class{getBundleMetadata(e,n){return pP(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ys(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return pP(e).put(function(i){return{bundleId:i.id,createTime:Qs(Je(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return gP(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:SC(s.bundledQuery),readTime:Ys(s.readTime)}}(r)})}saveNamedQuery(e,n){return gP(e).put(function(i){return{name:i.name,readTime:Qs(Je(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function pP(t){return yt(t,"bundles")}function gP(t){return yt(t,"namedQueries")}var tg=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Uc(e).get(hP(this.userId,n)).next(r=>r?mE(this.serializer,r):null)}getOverlays(e,n){let r=yr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new sl(n,o);i.push(this.ht(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add($t(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Uc(e).H("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=yr(),s=$t(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Uc(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=mE(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=yr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Uc(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=mE(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return Uc(e).put(function(i,s,o){let[a,u,c]=hP(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:cl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Uc(t){return yt(t,"documentOverlays")}var ei=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ke(e.integerValue));else if("doubleValue"in e){let r=Ke(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Xc(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Oi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?XP(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):P()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),S.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ei.bt=new ei;function _z(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function mP(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=_z(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var rI=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=mP(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=mP(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},iI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},sI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Us=class{constructor(){this.Gt=new rI,this.zt=new iI(this.Gt),this.jt=new sI(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Bs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Si(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=yP(t.arrayValue,e.arrayValue),n!==0?n:(n=yP(t.directionalValue,e.directionalValue),n!==0?n:S.comparator(t.documentKey,e.documentKey)))}function yP(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var ng=class{constructor(e){this.Yt=new Se((n,r)=>Xe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(V(e.collectionGroup===this.collectionId),this.en)return!1;let n=SE(e);if(n!==void 0&&!this.nn(n))return!1;let r=Vs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Se(Xe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Sa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Sa(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Sa(r.field,r.dir==="asc"?0:1)));return new Ra(Ra.UNKNOWN_ID,this.collectionId,n,Zc.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function Vk(t){var e,n;if(V(t instanceof de||t instanceof Ce),t instanceof de){if(t instanceof zp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>de.create(t.field,"==",s)))||[];return Ce.create(i,"or")}return t}let r=t.filters.map(i=>Vk(i));return Ce.create(r,t.op)}function wz(t){if(t.getFilters().length===0)return[];let e=uI(Vk(t));return V(Lk(e)),oI(e)||aI(e)?[e]:e.getFilters()}function oI(t){return t instanceof de}function aI(t){return t instanceof Ce&&CC(t)}function Lk(t){return oI(t)||aI(t)||function(n){if(n instanceof Ce&&OE(n)){for(let r of n.getFilters())if(!oI(r)&&!aI(r))return!1;return!0}return!1}(t)}function uI(t){if(V(t instanceof de||t instanceof Ce),t instanceof de)return t;if(t.filters.length===1)return uI(t.filters[0]);let e=t.filters.map(r=>uI(r)),n=Ce.create(e,t.op);return n=rg(n),Lk(n)?n:(V(n instanceof Ce),V(Pa(n)),V(n.filters.length>1),n.filters.reduce((r,i)=>AC(r,i)))}function AC(t,e){let n;return V(t instanceof de||t instanceof Ce),V(e instanceof de||e instanceof Ce),n=t instanceof de?e instanceof de?function(i,s){return Ce.create([i,s],"and")}(t,e):vP(t,e):e instanceof de?vP(e,t):function(i,s){if(V(i.filters.length>0&&s.filters.length>0),Pa(i)&&Pa(s))return nk(i,s.getFilters());let o=OE(i)?i:s,a=OE(i)?s:i,u=o.filters.map(c=>AC(c,a));return Ce.create(u,"or")}(t,e),rg(n)}function vP(t,e){if(Pa(e))return nk(e,t.getFilters());{let n=e.filters.map(r=>AC(t,r));return Ce.create(n,"or")}}function rg(t){if(V(t instanceof de||t instanceof Ce),t instanceof de)return t;let e=t.getFilters();if(e.length===1)return rg(e[0]);if(ek(t))return t;let n=e.map(i=>rg(i)),r=[];return n.forEach(i=>{i instanceof de?r.push(i):i instanceof Ce&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ce.create(r,t.op)}var cI=class{constructor(){this._n=new ll}addToCollectionParentIndex(e,n){return this._n.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(Rn.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(Rn.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},ll=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(pe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(pe.comparator)).toArray()}};var Ap=new Uint8Array(0),lI=class{constructor(e,n){this.databaseId=n,this.an=new ll,this.un=new Cr(r=>Ws(r),(r,i)=>wl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:$t(i)};return _P(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[BP(n),""],!1,!0);return _P(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(mr(o.parent))}return r})}addFieldIndex(e,n){let r=Bc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=_a(e);return s.next(a=>{o.put(fP(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Bc(e),i=_a(e),s=va(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Bc(e),r=va(e),i=_a(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return m.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ng(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=va(e),i=!0,s=new Map;return m.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ee(),a=[];return m.forEach(s,(u,c)=>{I("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(u)} to execute ${Ws(n)}`);let l=function(T,H){let z=SE(H);if(z===void 0)return null;for(let Y of Kp(T,z.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(c,u),d=function(T,H){let z=new Map;for(let Y of Vs(H))for(let De of Kp(T,Y.fieldPath))switch(De.op){case"==":case"in":z.set(Y.fieldPath.canonicalString(),De.value);break;case"not-in":case"!=":return z.set(Y.fieldPath.canonicalString(),De.value),Array.from(z.values())}return null}(c,u),h=function(T,H){let z=[],Y=!0;for(let De of Vs(H)){let Kt=De.kind===0?XN(T,De.fieldPath,T.startAt):JN(T,De.fieldPath,T.startAt);z.push(Kt.value),Y&&(Y=Kt.inclusive)}return new Ir(z,Y)}(c,u),f=function(T,H){let z=[],Y=!0;for(let De of Vs(H)){let Kt=De.kind===0?JN(T,De.fieldPath,T.endAt):XN(T,De.fieldPath,T.endAt);z.push(Kt.value),Y&&(Y=Kt.inclusive)}return new Ir(z,Y)}(c,u),p=this.hn(u,c,h),g=this.hn(u,c,f),_=this.Pn(u,c,d),C=this.In(u.indexId,l,p,h.inclusive,g,f.inclusive,_);return m.forEach(C,k=>r.j(k,n.limit).next(T=>{T.forEach(H=>{let z=S.fromSegments(H.documentKey);o.has(z)||(o=o.add(z),a.push(z))})}))}).next(()=>a)}return m.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=wz(Ce.create(e.filters,"and")).map(r=>qE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):Ap,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(_=>this.En(e,h,_,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new Bs(e,S.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Bs(e,S.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new ng(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return m.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Se(Xe.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Us;for(let i of Vs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ei.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Us;return ei.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Us;return ei.bt.Pt(Gs(this.databaseId,n),r.Ht(function(s){let o=Vs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Us);let s=0;for(let o of Vs(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&nl(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);ei.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Us;u.seed(a.Wt()),ei.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof de&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Bc(e),i=_a(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new Zc(d.sequenceNumber,new Rn(Ys(d.readTime),new S(mr(d.documentKey)),d.largestBatchId)):Zc.empty(),f=l.fields.map(([p,g])=>new Sa(Xe.fromServerFormat(p),g));return new Ra(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:X(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Bc(e),s=_a(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,u=>s.put(fP(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?m.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return va(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return va(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=va(e),s=new Se(Si);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Bs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Se(Si),i=this.An(n,e);if(i==null)return r;let s=SE(n);if(s!=null){let o=e.data.field(s.fieldPath);if(nl(o))for(let a of o.arrayValue.values||[])r=r.add(new Bs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Bs(n.indexId,e.key,Ap,i));return r}wn(e,n,r,i,s){I("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=ya(f),_=ya(p);for(;g||_;){let C=!1,k=!1;if(g&&_){let T=l(g,_);T<0?k=!0:T>0&&(C=!0)}else g!=null?k=!0:C=!0;C?(d(_),_=ya(p)):k?(h(g),g=ya(f)):(g=ya(f),_=ya(p))}}(i,s,Si,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),m.waitFor(o)}gn(e){let n=1;return _a(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Si(o,a)).filter((o,a,u)=>!a||Si(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Si(o,e),u=Si(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ap,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ap,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return Si(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(wP)}getMinOffset(e,n){return m.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||P())).next(wP)}};function _P(t){return yt(t,"collectionParents")}function va(t){return yt(t,"indexEntries")}function Bc(t){return yt(t,"indexConfiguration")}function _a(t){return yt(t,"indexState")}function wP(t){V(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;wC(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Rn(e.readTime,e.documentKey,n)}var EP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function jk(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{V(a===1)}));let c=[];for(let l of n.mutations){let d=zP(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return m.waitFor(s).next(()=>c)}function ig(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw P();e=t.noDocument}return JSON.stringify(e).length}xn.DEFAULT_COLLECTION_PERCENTILE=10,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xn.DEFAULT=new xn(41943040,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xn.DISABLED=new xn(-1,0,0);var sg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){V(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Ta(e),o=Ai(e);return o.add({}).next(a=>{V(typeof a=="number");let u=new il(a,n,r,i),c=function(f,p,g){let _=g.baseMutations.map(k=>cl(f.ct,k)),C=g.mutations.map(k=>cl(f.ct,k));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:_,mutations:C}}(this.serializer,this.userId,u),l=[],d=new Se((h,f)=>X(h.canonicalString(),f.canonicalString()));for(let h of i){let f=zP(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,SG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),m.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Ai(e).get(n).next(r=>r?(V(r.userId===this.userId),js(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?m.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Ai(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(V(a.batchId>=r),s=js(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ai(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).W("userMutationsIndex",n).next(r=>r.map(i=>js(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Np(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ta(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=mr(l);if(c===this.userId&&n.path.isEqual(h))return Ai(e).get(d).next(f=>{if(!f)throw P();V(f.userId===this.userId),s.push(js(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(X),i=[];return n.forEach(s=>{let o=Np(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Ta(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,g=mr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),m.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Np(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Se(X);return Ta(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=mr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Ai(e).get(s).next(o=>{if(o===null)throw P();V(o.userId===this.userId),r.push(js(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return jk(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ta(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=mr(s[1]);i.push(u)}else a.done()}).next(()=>{V(i.length===0)})})}containsKey(e,n){return Uk(e,this.userId,n)}xn(e){return Bk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function Uk(t,e,n){let r=Np(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ta(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function Ai(t){return yt(t,"mutations")}function Ta(t){return yt(t,"documentMutations")}function Bk(t){return yt(t,"mutationQueues")}var La=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var dI=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new La(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>B.fromTimestamp(new je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>wa(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(V(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return wa(e).Y((o,a)=>{let u=Gc(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return wa(e).Y((r,i)=>{let s=Gc(i);n(s)})}Bn(e){return IP(e).get("targetGlobalKey").next(n=>(V(n!==null),n))}kn(e,n){return IP(e).put("targetGlobalKey",n)}qn(e,n){return wa(e).put(Fk(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Ws(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return wa(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=Gc(a);wl(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=xi(e);return n.forEach(o=>{let a=$t(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=xi(e);return m.forEach(n,s=>{let o=$t(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=xi(e),s=ee();return i.Y({range:r,J:!0},(o,a,u)=>{let c=mr(o[1]),l=new S(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=$t(n.path),i=IDBKeyRange.bound([r],[BP(r)],!1,!0),s=0;return xi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return wa(e).get(n).next(r=>r?Gc(r):null)}};function wa(t){return yt(t,"targets")}function IP(t){return yt(t,"targetGlobal")}function xi(t){return yt(t,"targetDocuments")}function CP([t,e],[n,r]){let i=X(t,n);return i===0?X(e,r):i}var hI=class{constructor(e){this.Kn=e,this.buffer=new Se(CP),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();CP(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},fI=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){I("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){qi(n)?I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Hi(n)}yield this.zn(3e5)}))}},pI=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(cn._e);let r=new hI(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(EP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),EP):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Ea()<=vn.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function Ez(t,e){return new pI(t,e)}var gI=class{constructor(e,n){this.db=e,this.garbageCollector=Ez(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return xp(e,r)}removeReference(e,n,r){return xp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return xp(e,n)}er(e,n){return function(i,s){let o=!1;return Bk(i).Z(a=>Uk(i,a,s).next(u=>(u&&(o=!0),m.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,B.min()),xi(e).delete(function(d){return[0,$t(d.path)]}(o))))});i.push(u)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return xp(e,n)}Xn(e,n){let r=xi(e),i,s=cn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==cn._e&&n(new S(mr(i)),s),s=c,i=u):s=cn._e}).next(()=>{s!==cn._e&&n(new S(mr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function xp(t,e){return xi(t).put(function(r,i){return{targetId:0,path:$t(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var og=class{constructor(){this.changes=new Cr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var mI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Fs(e).put(r)}removeEntry(e,n,r){return Fs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],eg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=at.newInvalidDocument(n);return Fs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only($c(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:at.newInvalidDocument(n)};return Fs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only($c(n))},(i,s)=>{r={document:this.nr(n,s),size:ig(s)}}).next(()=>r)}getEntries(e,n){let r=tn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=tn(),i=new Pe(S.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,ig(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return m.resolve();let i=new Se(bP);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound($c(i.first()),$c(i.last())),o=i.getIterator(),a=o.getNext();return Fs(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=S.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&bP(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U($c(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),eg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fs(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=tn();for(let d of c){let h=this.nr(S.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Il(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=tn(),o=TP(n,r),a=TP(n,Rn.max());return Fs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(S.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new yI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return DP(e).get("remoteDocumentGlobalKey").next(n=>(V(!!n),n))}tr(e,n){return DP(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=vz(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return at.newInvalidDocument(e)}};function $k(t){return new mI(t)}var yI=class extends og{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Cr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Se((s,o)=>X(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=dP(this.ar.serializer,o);i=i.add(s.path.popLast());let c=ig(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=dP(this.ar.serializer,o.convertToNoDocument(B.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function DP(t){return yt(t,"remoteDocumentGlobal")}function Fs(t){return yt(t,"remoteDocumentsV14")}function $c(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function TP(t,e){let n=e.documentKey.path.toArray();return[t,eg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function bP(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=X(n[s],r[s]),i)return i;return i=X(n.length,r.length),i||(i=X(n[n.length-2],r[r.length-2]),i||X(n[n.length-1],r[r.length-1]))}var vI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var ag=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Kc(r.mutation,i,ln.empty(),je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ee()){let i=yr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=qc();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=yr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ee()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=tn(),o=Wc(),a=function(){return Wc()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof Kn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),Kc(l.mutation,c,l.mutation.getFieldMask(),je.now())):o.set(c.key,ln.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new vI(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Wc(),i=new Pe((o,a)=>o-a),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||ln.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||ee()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=dk();l.forEach(h=>{if(!s.has(h)){let f=_k(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return S.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):DC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(yr()),a=-1,u=s;return o.next(c=>m.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ee())).next(l=>({batchId:a,changes:lk(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new S(n)).next(r=>{let i=qc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=qc();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,u=>{let c=function(d,h){return new Wn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,at.newInvalidDocument(l)))});let a=qc();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&Kc(l.mutation,c,ln.empty(),je.now()),Il(n,c)&&(a=a.insert(u,c))}),a})}};var _I=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return m.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:SC(i.bundledQuery),readTime:Je(i.readTime)}}(n)),m.resolve()}};var wI=class{constructor(){this.overlays=new Pe(S.comparator),this.hr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=yr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=yr(),s=n.length+1,o=new S(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Pe((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=yr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=yr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return m.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sl(n,r));let s=this.hr.get(n);s===void 0&&(s=ee(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var dl=class{constructor(){this.Pr=new Se(it.Ir),this.Tr=new Se(it.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new it(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new it(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new S(new pe([])),r=new it(n,e),i=new it(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new S(new pe([])),r=new it(n,e),i=new it(n,e+1),s=ee();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new it(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},it=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return S.comparator(e.key,n.key)||X(e.pr,n.pr)}static Er(e,n){return X(e.pr,n.pr)||S.comparator(e.key,n.key)}};var EI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Se(it.Ir)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new il(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new it(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new it(n,0),i=new it(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(X);return n.forEach(i=>{let s=new it(i,0),o=new it(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),m.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;S.isDocumentKey(s)||(s=s.child(""));let o=new it(new S(s),0),a=new Se(X);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),m.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){V(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return m.forEach(n.mutations,i=>{let s=new it(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new it(n,0),i=this.wr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var II=class{constructor(e){this.vr=e,this.docs=function(){return new Pe(S.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():at.newInvalidDocument(n))}getEntries(e,n){let r=tn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():at.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=tn(),o=n.path,a=new S(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||wC(HP(l),r)<=0||(i.has(l.key)||Il(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){P()}Fr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CI(this)}getSize(e){return m.resolve(this.size)}},CI=class extends og{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var DI=class{constructor(e){this.persistence=e,this.Mr=new Cr(n=>Ws(n),wl),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Or=0,this.Nr=new dl,this.targetCount=0,this.Lr=La.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),m.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new La(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.qn(n),m.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Nr.containsKey(n))}};var ug=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new cn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new DI(this),this.indexManager=new cI,this.remoteDocumentCache=function(i){return new II(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Jp(n),this.$r=new _I(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new wI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new EI(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new TI(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return m.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},TI=class extends Bp{constructor(e){super(),this.currentSequenceNumber=e}},cg=class t{constructor(e){this.persistence=e,this.zr=new dl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw P()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),m.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Jr,r=>{let i=S.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,B.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return m.or([()=>m.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var bI=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new $p("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",HN,{unique:!0}),u.createObjectStore("documentMutations")}(e),SP(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),SP(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",HN,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:jG});c.createIndex("collectionPathOverlayIndex",UG,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",BG,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:AG});c.createIndex("documentKeyIndex",xG),c.createIndex("collectionGroupIndex",MG)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:OG}).createIndex("sequenceNumberIndex",FG,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:VG}).createIndex("documentKeyIndex",LG,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=ig(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>m.forEach(a,u=>{V(u.userId===s.userId);let c=js(this.serializer,u);return jk(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new pe(o),c=function(d){return[0,$t(d)]}(u);s.push(n.get(c).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:$t(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>m.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:kG});let r=n.store("collectionParents"),i=new ll,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:$t(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new pe(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=mr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Gc(i),o=Fk(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new S(pe.fromString(d.document.name).popFirst(5)):d.noDocument?S.fromSegments(d.noDocument.path):d.unknownDocument?S.fromSegments(d.unknownDocument.path):P()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>m.waitFor(i))}si(e,n){let r=n.store("mutations"),i=$k(this.serializer),s=new ug(cg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:ee();js(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),m.forEach(a,(u,c)=>{let l=new st(c),d=tg.lt(this.serializer,l),h=s.getIndexManager(l),f=sg.lt(l,this.serializer,h,s.referenceDelegate);return new ag(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Jc(n,cn._e),u).next()})})}};function SP(t){t.createObjectStore("targetDocuments",{keyPath:NG}).createIndex("documentTargetsIndex",PG,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",RG,{unique:!0}),t.createObjectStore("targetGlobal")}var yE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",SI=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gI(this,i),this.Ti=n+"main",this.serializer=new Jp(u),this.Ei=new ni(this.Ti,this.ui,new bI(this.serializer)),this.Qr=new dI(this.referenceDelegate,this.serializer),this.remoteDocumentCache=$k(this.serializer),this.$r=new nI,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,yE);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new cn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(qi(e))return I("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Hc(e).get("owner").next(n=>m.resolve(this.Si(n)))}bi(e){return Mp(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=yt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?m.resolve(!0):Hc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,yE);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mp(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&I("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Jc(e,cn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Mp(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return sg.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lI(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return tg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){I("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?HG:u===14?QP:u===13?KP:u===12?$G:u===11?WP:void P()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Jc(a,this.kr?this.kr.next():cn._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw Ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(y.FAILED_PRECONDITION,qP);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Hc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,yE)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Hc(e).put("owner",n)}static D(){return ni.D()}yi(e){let n=Hc(e);return n.get("owner").next(r=>this.Si(r)?(I("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Dy()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return I("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ze("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Hc(t){return yt(t,"owner")}function Mp(t){return yt(t,"clientMetadata")}function xC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var AI=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ee(),i=ee();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var xI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var lg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Dy()?8:ni.v(Ru())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new xI;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ea()<=vn.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",Ia(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),m.resolve()):(Ea()<=vn.DEBUG&&I("QueryEngine","Query:",Ia(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ea()<=vn.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",Ia(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ht(n))):m.resolve())}ji(e,n){if(eP(n))return m.resolve(null);let r=Ht(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Qp(n,null,"F"),r=Ht(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ee(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,Qp(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return eP(n)||i.isEqual(B.min())?m.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?m.resolve(null):(Ea()<=vn.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ia(n)),this.es(e,o,n,$P(i,-1)).next(a=>a))})}Zi(e,n){let r=new Se(uk(e));return n.forEach((i,s)=>{Il(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ea()<=vn.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",Ia(n)),this.zi.getDocumentsMatchingQuery(e,n,Rn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var MI=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Pe(X),this.rs=new Cr(s=>Ws(s),wl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ag(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function Hk(t,e,n,r){return new MI(t,e,n,r)}function qk(t,e){return v(this,null,function*(){let n=A(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=ee();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function Iz(t,e){let n=A(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let _=c.docVersions.get(p);V(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ee();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Gk(t){let e=A(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function Cz(t,e){let n=A(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(mt.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,_,C){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=tn(),c=ee();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(zk(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(B.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function zk(t,e,n){let r=ee(),i=ee();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=tn();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(B.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function Dz(t,e){let n=A(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ja(t,e){let n=A(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Va(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Ua(t,e,n){return v(this,null,function*(){let r=A(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!qi(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function dg(t,e,n){let r=A(t),i=B.min(),s=ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=A(u),h=d.rs.get(l);return h!==void 0?m.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,Ht(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:B.min(),n?s:ee())).next(a=>(Qk(r,ak(e),a),{documents:a,hs:s})))}function Wk(t,e){let n=A(t),r=A(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function Kk(t,e){let n=A(t),r=n.ss.get(e)||B.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,$P(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Qk(n,e,i),i))}function Qk(t,e,n){let r=t.ss.get(e)||B.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function Tz(t,e,n,r){return v(this,null,function*(){let i=A(t),s=ee(),o=tn();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield ja(i,function(l){return Ht(Ka(pe.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>zk(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function bz(r,i){return v(this,arguments,function*(t,e,n=ee()){let s=yield ja(t,Ht(SC(e.bundledQuery))),o=A(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Je(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(mt.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function AP(t,e){return`firestore_clients_${t}_${e}`}function xP(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function vE(t,e){return`firestore_targets_${t}_${e}`}var hg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Qc=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},fg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=TC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=GP(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},RI=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},hl=class{constructor(){this.activeTargetIds=TC()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Yc=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Pe(X),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=AP(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new hl),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(AP(this.persistenceKey,r));if(i){let s=fg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(vE(this.persistenceKey,e));if(r){let i=Qc.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(vE(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return I("SharedClientState","READ",e,n),n}setItem(e,n){I("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){I("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(I("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=cn._e;if(s!=null)try{let a=JSON.parse(s);V(typeof a=="number"),o=a}catch(a){Ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==cn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new hg(this.currentUser,e,n,r),s=xP(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=xP(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=vE(this.persistenceKey,e),s=new Qc(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return fg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return hg.Es(new st(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Qc.Es(i,n)}xs(e){return RI.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);I("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=TC();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},pg=class{constructor(){this.no=new hl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new hl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var NI=class{io(e){}shutdown(){}};var gg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Rp=null;function _E(){return Rp===null?Rp=function(){return 268435456+Math.round(2147483648*Math.random())}():Rp++,"0x"+Rp.toString(16)}var Sz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var PI=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Pt="WebChannelConnection",kI=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=_E(),u=this.bo(n,r.toUriEncodedString());I("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(I("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Mn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wa}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=Sz[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=_E();return new Promise((o,a)=>{let u=new LN;u.setWithCredentials(!0),u.listenOnce(FN.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Sp.NO_ERROR:let l=u.getResponseJson();I(Pt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Sp.TIMEOUT:I(Pt,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case Sp.HTTP_ERROR:let d=u.getStatus();if(I(Pt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(_){let C=_.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(C)>=0?C:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:P()}}finally{I(Pt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);I(Pt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=_E(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kN(),a=ON(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");I(Pt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new PI({lo:_=>{f?I(Pt,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(I(Pt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),I(Pt,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},ho:()=>d.close()}),g=(_,C,k)=>{_.listen(C,T=>{try{k(T)}catch(H){setTimeout(()=>{throw H},0)}})};return g(d,jc.EventType.OPEN,()=>{f||I(Pt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,jc.EventType.CLOSE,()=>{f||(f=!0,I(Pt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,jc.EventType.ERROR,_=>{f||(f=!0,Mn(Pt,`RPC '${e}' stream ${i} transport errored:`,_),p.Vo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,jc.EventType.MESSAGE,_=>{var C;if(!f){let k=_.data[0];V(!!k);let T=k,H=T.error||((C=T[0])===null||C===void 0?void 0:C.error);if(H){I(Pt,`RPC '${e}' stream ${i} received error:`,H);let z=H.status,Y=function(wy){let Fd=rt[wy];if(Fd!==void 0)return Ik(Fd)}(z),De=H.message;Y===void 0&&(Y=y.INTERNAL,De="Unknown error status: "+z+" with message "+H.message),f=!0,p.Vo(new w(Y,De)),d.close()}else I(Pt,`RPC '${e}' stream ${i} received:`,k),p.mo(k)}}),g(a,VN.STAT_EVENT,_=>{_.stat===gE.PROXY?I(Pt,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===gE.NOPROXY&&I(Pt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function Yk(){return typeof window<"u"?window:null}function Fp(){return typeof document<"u"?document:null}function Cl(t){return new ZE(t,!0)}var fl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var mg=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new fl(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Ze(n.toString()),Ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},OI=class extends mg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=dz(this.serializer,e),r=function(s){if(!("targetChange"in s))return B.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?B.min():o.readTime?Je(o.readTime):B.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=eI(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=Wp(u)?{documents:Mk(s,u)}:{query:Rk(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Dk(s,o.resumeToken);let c=XE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(B.min())>0){a.readTime=Fa(s,o.snapshotVersion.toTimestamp());let c=XE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=fz(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=eI(this.serializer),n.removeTarget=e,this.t_(n)}},FI=class extends mg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(V(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=hz(e.writeResults,e.commitTime),r=Je(e.commitTime);return this.listener.T_(r,n)}return V(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=eI(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>cl(this.serializer,r))};this.t_(n)}};var VI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,JE(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,JE(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var LI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ze(n),this.g_=!1):I("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var jI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){Gi(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(u){return v(this,null,function*(){let c=A(u);c.v_.add(4),yield Qa(c),c.x_.set("Unknown"),c.v_.delete(4),yield Dl(c)})}(this))}))}),this.x_=new LI(r,i)}};function Dl(t){return v(this,null,function*(){if(Gi(t))for(let e of t.F_)yield e(!0)})}function Qa(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Og(t,e){let n=A(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),NC(n)?RC(n):Za(n).Jo()&&MC(n,e))}function Ba(t,e){let n=A(t),r=Za(n);n.C_.delete(e),r.Jo()&&Zk(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Gi(n)&&n.x_.set("Unknown"))}function MC(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Za(t).c_(e)}function Zk(t,e){t.O_.Oe(e),Za(t).l_(e)}function RC(t){t.O_=new YE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Za(t).start(),t.x_.p_()}function NC(t){return Gi(t)&&!Za(t).Ho()&&t.C_.size>0}function Gi(t){return A(t).v_.size===0}function Xk(t){t.O_=void 0}function Az(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{MC(t,e)})})}function xz(t,e){return v(this,null,function*(){Xk(t),NC(t)?(t.x_.S_(e),RC(t)):t.x_.set("Unknown")})}function Mz(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof Zp&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield yg(t,r)}else if(e instanceof xa?t.O_.$e(e):e instanceof Yp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(B.min()))try{let r=yield Gk(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(mt.EMPTY_BYTE_STRING,l.snapshotVersion)),Zk(s,u);let d=new Va(l.target,u,c,l.sequenceNumber);MC(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield yg(t,r)}})}function yg(t,e,n){return v(this,null,function*(){if(!qi(e))throw e;t.v_.add(1),yield Qa(t),t.x_.set("Offline"),n||(n=()=>Gk(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Dl(t)}))})}function Jk(t,e){return e().catch(n=>yg(t,n,e))}function Ya(t){return v(this,null,function*(){let e=A(t),n=$i(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Rz(e);)try{let i=yield Dz(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,Nz(e,i)}catch(i){yield yg(e,i)}e1(e)&&t1(e)})}function Rz(t){return Gi(t)&&t.D_.length<10}function Nz(t,e){t.D_.push(e);let n=$i(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function e1(t){return Gi(t)&&!$i(t).Ho()&&t.D_.length>0}function t1(t){$i(t).start()}function Pz(t){return v(this,null,function*(){$i(t).d_()})}function kz(t){return v(this,null,function*(){let e=$i(t);for(let n of t.D_)e.I_(n.mutations)})}function Oz(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=WE.from(r,e,n);yield Jk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Ya(t)})}function Fz(t,e){return v(this,null,function*(){e&&$i(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return Ek(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();$i(r).Zo(),yield Jk(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ya(r)}})}(t,e)),e1(t)&&t1(t)})}function MP(t,e){return v(this,null,function*(){let n=A(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=Gi(n);n.v_.add(3),yield Qa(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Dl(n)})}function UI(t,e){return v(this,null,function*(){let n=A(t);e?(n.v_.delete(2),yield Dl(n)):e||(n.v_.add(2),yield Qa(n),n.x_.set("Unknown"))})}function Za(t){return t.N_||(t.N_=function(n,r,i){let s=A(n);return s.R_(),new OI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:Az.bind(null,t),To:xz.bind(null,t),u_:Mz.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),NC(t)?RC(t):t.x_.set("Unknown")):(yield t.N_.stop(),Xk(t))}))),t.N_}function $i(t){return t.L_||(t.L_=function(n,r,i){let s=A(n);return s.R_(),new FI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:Pz.bind(null,t),To:Fz.bind(null,t),E_:kz.bind(null,t),T_:Oz.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.L_.Zo(),yield Ya(t)):(yield t.L_.stop(),t.D_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var BI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Xa(t,e){if(Ze("AsyncQueue",`${e}: ${t}`),qi(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var vg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||S.comparator(n.key,r.key):(n,r)=>S.comparator(n.key,r.key),this.keyedMap=qc(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var _g=class{constructor(){this.B_=new Pe(S.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):P():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},$a=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,vg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&El(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var $I=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},HI=class{constructor(){this.queries=new Cr(e=>ok(e),El),this.onlineState="Unknown",this.W_=new Set}};function PC(t,e){return v(this,null,function*(){let n=A(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new $I,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=Xa(o,`Initialization of query '${Ia(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&OC(n)})}function kC(t,e){return v(this,null,function*(){let n=A(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function Vz(t,e){let n=A(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&OC(n)}function Lz(t,e,n){let r=A(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function OC(t){t.W_.forEach(e=>{e.next()})}var qI,RP;(RP=qI||(qI={})).j_="default",RP.Cache="cache";var pl=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==qI.Cache}};var GI=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var wg=class{constructor(e){this.serializer=e}Ps(e){return _r(this.serializer,e)}Is(e){return e.metadata.exists?xk(this.serializer,e.document,!1):at.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Je(e)}},zI=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=n1(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=pe.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new wg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||ee()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield Tz(this.localStore,new wg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield bz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function n1(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Eg=class{constructor(e){this.key=e}},Ig=class{constructor(e){this.key=e}},Cg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=ee(),this.mutatedKeys=ee(),this.ha=uk(e),this.Pa=new vg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new _g,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Il(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),_=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),_=!0):this.da(h,f)||(r.track({type:2,doc:f}),_=!0,(u&&this.ha(f,u)>0||c&&this.ha(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(u||c)&&(a=!0)),_&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((l,d)=>function(f,p){let g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return P()}};return g(f)-g(p)}(l.type,d.type)||this.ha(l.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],u=this.la.size===0&&this.current&&!i?1:0,c=u!==this.ca;return this.ca=u,o.length!==0||c?{snapshot:new $a(this.query,e.Pa,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new _g,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=ee(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new Ig(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Eg(r))}),n}fa(e){this.ua=e.hs,this.la=ee();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return $a.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},WI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},KI=class{constructor(e){this.key=e,this.pa=!1}},QI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Cr(a=>ok(a),El),this.Sa=new Map,this.ba=new Set,this.Da=new Pe(S.comparator),this.Ca=new Map,this.va=new dl,this.Fa={},this.Ma=new Map,this.xa=La.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function jz(t,e,n=!0){return v(this,null,function*(){let r=Fg(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield r1(r,e,n,!0),i})}function Uz(t,e){return v(this,null,function*(){let n=Fg(t);yield r1(n,e,!0,!1)})}function r1(t,e,n,r){return v(this,null,function*(){let i=yield ja(t.localStore,Ht(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield FC(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Og(t.remoteStore,i),a})}function FC(t,e,n,r,i){return v(this,null,function*(){t.Na=(d,h,f)=>function(g,_,C,k){return v(this,null,function*(){let T=_.view.Ta(C);T.Xi&&(T=yield dg(g.localStore,_.query,!1).then(({documents:De})=>_.view.Ta(De,T)));let H=k&&k.targetChanges.get(_.targetId),z=k&&k.targetMismatches.get(_.targetId)!=null,Y=_.view.applyChanges(T,g.isPrimaryClient,H,z);return YI(g,_.targetId,Y.Va),Y.snapshot})}(t,d,h,f);let s=yield dg(t.localStore,e,!0),o=new Cg(e,s.hs),a=o.Ta(s.documents),u=al.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);YI(t,n,c.Va);let l=new WI(e,n,o);return t.wa.set(e,l),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),c.snapshot})}function Bz(t,e,n){return v(this,null,function*(){let r=A(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!El(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Ua(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ba(r.remoteStore,i.targetId),Ha(r,i.targetId)}).catch(Hi))):(Ha(r,i.targetId),yield Ua(r.localStore,i.targetId,!0))})}function $z(t,e){return v(this,null,function*(){let n=A(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ba(n.remoteStore,r.targetId))})}function Hz(t,e,n){return v(this,null,function*(){let r=UC(t);try{let i=yield function(o,a){let u=A(o),c=je.now(),l=a.reduce((f,p)=>f.add(p.key),ee()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=tn(),g=ee();return u.os.getEntries(f,l).next(_=>{p=_,p.forEach((C,k)=>{k.isValidDocument()||(g=g.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(_=>{d=_;let C=[];for(let k of a){let T=iz(k,d.get(k.key).overlayedDocument);T!=null&&C.push(new Kn(k.key,T,JP(T.value.mapValue),Qe.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,C,a)}).next(_=>{h=_;let C=_.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,_.batchId,C)})}).then(()=>({batchId:h.batchId,changes:lk(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Fa[o.currentUser.toKey()];c||(c=new Pe(X)),c=c.insert(a,u),o.Fa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield ai(r,i.changes),yield Ya(r.remoteStore)}catch(i){let s=Xa(i,"Failed to persist write");n.reject(s)}})}function i1(t,e){return v(this,null,function*(){let n=A(t);try{let r=yield Cz(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(V(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?V(o.pa):i.removedDocuments.size>0&&(V(o.pa),o.pa=!1))}),yield ai(n,r,e)}catch(r){yield Hi(r)}})}function NP(t,e,n){let r=A(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=A(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.G_(a)&&(c=!0)}),c&&OC(u)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function qz(t,e,n){return v(this,null,function*(){let r=A(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new Pe(S.comparator);o=o.insert(s,at.newNoDocument(s,B.min()));let a=ee().add(s),u=new ol(B.min(),new Map,new Pe(X),o,a);yield i1(r,u),r.Da=r.Da.remove(s),r.Ca.delete(e),jC(r)}else yield Ua(r.localStore,e,!1).then(()=>Ha(r,e,n)).catch(Hi)})}function Gz(t,e){return v(this,null,function*(){let n=A(t),r=e.batch.batchId;try{let i=yield Iz(n.localStore,e);LC(n,r,null),VC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ai(n,i)}catch(i){yield Hi(i)}})}function zz(t,e,n){return v(this,null,function*(){let r=A(t);try{let i=yield function(o,a){let u=A(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(V(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);LC(r,e,n),VC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ai(r,i)}catch(i){yield Hi(i)}})}function Wz(t,e){return v(this,null,function*(){let n=A(t);Gi(n.remoteStore)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=A(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=Xa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function VC(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function LC(t,e,n){let r=A(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function Ha(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||s1(t,r)})}function s1(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(Ba(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),jC(t))}function YI(t,e,n){for(let r of n)r instanceof Eg?(t.va.addReference(r.key,e),Kz(t,r)):r instanceof Ig?(I("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||s1(t,r.key)):P()}function Kz(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ba.add(r),jC(t))}function jC(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new S(pe.fromString(e)),r=t.xa.next();t.Ca.set(r,new KI(n)),t.Da=t.Da.insert(n,r),Og(t.remoteStore,new Va(Ht(Ka(n.path)),r,"TargetPurposeLimboResolution",cn._e))}}function ai(t,e,n){return v(this,null,function*(){let r=A(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,u)=>{o.push(r.Na(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=AI.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(u,c){return v(this,null,function*(){let l=A(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(c,h=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!qi(d))throw d;I("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function Qz(t,e){return v(this,null,function*(){let n=A(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield qk(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(u=>{u.reject(new w(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ai(n,r.us)}})}function Yz(t,e){let n=A(t),r=n.Ca.get(e);if(r&&r.pa)return ee().add(r.key);{let i=ee(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function Zz(t,e){return v(this,null,function*(){let n=A(t),r=yield dg(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&YI(n,e.targetId,i.Va),i})}function Xz(t,e){return v(this,null,function*(){let n=A(t);return Kk(n.localStore,e).then(r=>ai(n,r))})}function Jz(t,e,n,r){return v(this,null,function*(){let i=A(t),s=yield function(a,u){let c=A(a),l=A(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Ya(i.remoteStore):n==="acknowledged"||n==="rejected"?(LC(i,e,r||null),VC(i,e),function(a,u){A(A(a).mutationQueue).Mn(u)}(i.localStore,e)):P(),yield ai(i,s)):I("SyncEngine","Cannot apply mutation batch with id: "+e)})}function eW(t,e){return v(this,null,function*(){let n=A(t);if(Fg(n),UC(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield PP(n,r.toArray());n.Oa=!0,yield UI(n.remoteStore,!0);for(let s of i)Og(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ha(n,o),Ua(n.localStore,o,!0))),Ba(n.remoteStore,o)}),yield i,yield PP(n,r),function(o){let a=A(o);a.Ca.forEach((u,c)=>{Ba(a.remoteStore,c)}),a.va.mr(),a.Ca=new Map,a.Da=new Pe(S.comparator)}(n),n.Oa=!1,yield UI(n.remoteStore,!1)}})}function PP(t,e,n){return v(this,null,function*(){let r=A(t),i=[],s=[];for(let o of e){let a,u=r.Sa.get(o);if(u&&u.length!==0){a=yield ja(r.localStore,Ht(u[0]));for(let c of u){let l=r.wa.get(c),d=yield Zz(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield Wk(r.localStore,o);a=yield ja(r.localStore,c),yield FC(r,o1(c),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function o1(t){return sk(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function tW(t){return function(n){return A(A(n).persistence).Bi()}(A(t).localStore)}function nW(t,e,n,r){return v(this,null,function*(){let i=A(t);if(i.Oa)return void I("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield Kk(i.localStore,ak(s[0])),a=ol.createSynthesizedRemoteEventForCurrentChange(e,n==="current",mt.EMPTY_BYTE_STRING);yield ai(i,o,a);break}case"rejected":yield Ua(i.localStore,e,!0),Ha(i,e,r);break;default:P()}})}function rW(t,e,n){return v(this,null,function*(){let r=Fg(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){I("SyncEngine","Adding an already active target "+i);continue}let s=yield Wk(r.localStore,i),o=yield ja(r.localStore,s);yield FC(r,o1(s),o.targetId,!1,o.resumeToken),Og(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield Ua(r.localStore,i,!1).then(()=>{Ba(r.remoteStore,i),Ha(r,i)}).catch(Hi))}})}function Fg(t){let e=A(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=i1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qz.bind(null,e),e.ya.u_=Vz.bind(null,e.eventManager),e.ya.La=Lz.bind(null,e.eventManager),e}function UC(t){let e=A(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zz.bind(null,e),e}function iW(t,e,n){let r=A(t);(function(s,o,a){return v(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=A(f),_=Je(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",C=>g.$r.getBundleMetadata(C,p.id)).then(C=>!!C&&C.createTime.compareTo(_)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(n1(u));let c=new zI(u,s.localStore,o.serializer),l=yield o.Ba();for(;l;){let h=yield c.sa(l);h&&a._updateProgress(h),l=yield o.Ba()}let d=yield c.complete();return yield ai(s,d.aa,void 0),yield function(f,p){let g=A(f);return g.persistence.runTransaction("Save bundle","readwrite",_=>g.$r.saveBundleMetadata(_,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d._a)}catch(u){return Mn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var gl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=Cl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Hk(this.persistence,new lg,e.initialUser,this.serializer)}createPersistence(e){return new ug(cg.Hr,this.serializer)}createSharedClientState(e){return new pg}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Dg=class t extends gl{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield Ey(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield UC(this.ka.syncEngine),yield Ya(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return Hk(this.persistence,new lg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new fI(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new RE(n,this.persistence);return new ME(e.asyncQueue,r)}createPersistence(e){let n=xC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xn.withCacheSize(this.cacheSizeBytes):xn.DEFAULT;return new SI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Yk(),Fp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new pg}},ZI=class t extends Dg{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield Ey(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Yc&&(this.sharedClientState.syncEngine={Zs:Jz.bind(null,n),Xs:nW.bind(null,n),eo:rW.bind(null,n),Bi:tW.bind(null,n),Ys:Xz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield eW(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=Yk();if(!Yc.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=xC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yc(n,e.asyncQueue,r,e.clientId,e.initialUser)}},ml=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>NP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qz.bind(null,this.syncEngine),yield UI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new HI}()}createDatastore(e){let n=Cl(e.databaseInfo.databaseId),r=function(s){return new kI(s)}(e.databaseInfo);return function(s,o,a,u){return new VI(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new jI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>NP(this.syncEngine,n,0),function(){return gg.D()?new gg:new NI}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new QI(i,s,o,a,u,c);return l&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=A(r);I("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield Qa(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function kP(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var qa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Ze("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var XI=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new ot,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Ba(){return v(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return v(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new GI(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Wa(){return v(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return v(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var JI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=A(i),a={documents:s.map(d=>ul(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,pe.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=lz(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());V(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Bi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=S.fromPath(r);this.mutations.push(new rl(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=A(r),o={writes:i.map(a=>cl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,pe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw P();n=B.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(B.min())?Qe.exists(!1):Qe.updateTime(n):Qe.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(B.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(n)}return Qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var eC=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new fl(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>v(this,null,function*(){let e=new JI(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!_l(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Ek(n)}return!1}};var tC=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=st.UNAUTHENTICATED,this.clientId=jp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Xa(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Vp(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield qk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function nC(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield BC(t);I("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>MP(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>MP(e.remoteStore,i)),t._onlineComponents=e})}function a1(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function BC(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Vp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!a1(n))throw n;Mn("Error using user provided cache. Falling back to memory cache: "+n),yield Vp(t,new gl)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield Vp(t,new gl);return t._offlineComponents})}function Vg(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield nC(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield nC(t,new ml))),t._onlineComponents})}function u1(t){return BC(t).then(e=>e.persistence)}function $C(t){return BC(t).then(e=>e.localStore)}function c1(t){return Vg(t).then(e=>e.remoteStore)}function HC(t){return Vg(t).then(e=>e.syncEngine)}function sW(t){return Vg(t).then(e=>e.datastore)}function Ga(t){return v(this,null,function*(){let e=yield Vg(t),n=e.eventManager;return n.onListen=jz.bind(null,e.syncEngine),n.onUnlisten=Bz.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Uz.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$z.bind(null,e.syncEngine),n})}function oW(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield u1(t),n=yield c1(t);return e.setNetworkEnabled(!0),function(i){let s=A(i);return s.v_.delete(0),Dl(s)}(n)}))}function aW(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield u1(t),n=yield c1(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=A(i);s.v_.add(0),yield Qa(s),s.x_.set("Offline")})}(n)}))}function uW(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(c,l){let d=A(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=Xa(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield $C(t),e,n)})),n.promise}function l1(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new qa({next:h=>{o.enqueueAndForget(()=>kC(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new pl(Ka(a.path),l,{includeMetadataChanges:!0,ta:!0});return PC(s,d)}(yield Ga(t),t.asyncQueue,e,n,r)})),r.promise}function cW(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield dg(i,s,!0),u=new Cg(s,a.hs),c=u.Ta(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=Xa(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield $C(t),e,n)})),n.promise}function d1(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new qa({next:h=>{o.enqueueAndForget(()=>kC(s,d)),h.fromCache&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new pl(a,l,{includeMetadataChanges:!0,ta:!0});return PC(s,d)}(yield Ga(t),t.asyncQueue,e,n,r)})),r.promise}function lW(t,e){let n=new qa(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){A(i).W_.add(s),s.next()}(yield Ga(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){A(i).W_.delete(s)}(yield Ga(t),n)}))}}function dW(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?Ck().encode(o):o,function(l,d){return new XI(l,d)}(function(l,d){if(l instanceof Uint8Array)return kP(l,d);if(l instanceof ArrayBuffer)return kP(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Cl(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){iW(yield HC(t),i,r)}))}function hW(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=A(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield $C(t),e)}))}function h1(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var OP=new Map;function qC(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function GC(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function FP(t){if(!S.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function VP(t){if(S.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Lg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":P()}function ge(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Lg(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function f1(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Tg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=h1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Zs=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new wE;switch(r.type){case"firstParty":return new DE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=OP.get(n);r&&(I("ComponentProvider","Removing Datastore"),OP.delete(n),r.terminate())}(this),Promise.resolve()}};function jg(t,e,n,r={}){var i;let s=(t=ge(t,Zs))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Mn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=st.MOCK_USER;else{a=jd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new st(c)}t._authCredentials=new EE(new Lp(a,u))}}var St=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Me=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},wr=class t extends St{constructor(e,n,r){super(e,n,Ka(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new S(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Ug(t,e,...n){if(t=ce(t),qC("collection","path",e),t instanceof Zs){let r=pe.fromString(e,...n);return VP(r),new wr(t,null,r)}{if(!(t instanceof Me||t instanceof wr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(pe.fromString(e,...n));return VP(r),new wr(t.firestore,null,r)}}function zC(t,e){if(t=ge(t,Zs),qC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new St(t,null,function(r){return new Wn(pe.emptyPath(),r)}(e))}function Ja(t,e,...n){if(t=ce(t),arguments.length===1&&(e=jp.newId()),qC("doc","path",e),t instanceof Zs){let r=pe.fromString(e,...n);return FP(r),new Me(t,null,new S(r))}{if(!(t instanceof Me||t instanceof wr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(pe.fromString(e,...n));return FP(r),new Me(t.firestore,t instanceof wr?t.converter:null,new S(r))}}function Bg(t,e){return t=ce(t),e=ce(e),(t instanceof Me||t instanceof wr)&&(e instanceof Me||e instanceof wr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function $g(t,e){return t=ce(t),e=ce(e),t instanceof St&&e instanceof St&&t.firestore===e.firestore&&El(t._query,e._query)&&t.converter===e.converter}var rC=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new fl(this,"async_queue_retry"),this.cu=()=>{let n=Fp();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Fp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Fp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new ot;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return v(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!qi(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=BI.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&P()}verifyOperationInProgress(){}Tu(){return v(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function iC(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var sC=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ot,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var p1=-1,Fe=class extends Zs{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new rC}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||m1(this),this._firestoreClient.terminate()}};function g1(t,e){let n=typeof t=="object"?t:ku(),r=typeof t=="string"?t:e||"(default)",i=qd(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Iy("firestore");s&&jg(i,...s)}return i}function dt(t){return t._firestoreClient||m1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function m1(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new NE(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,h1(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new tC(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function WC(t,e){v1(t=ge(t,Fe));let n=dt(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");Mn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new ml;return y1(n,i,new Dg(i,r.cacheSizeBytes,e?.forceOwnership))}function KC(t){v1(t=ge(t,Fe));let e=dt(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");Mn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new ml;return y1(e,r,new ZI(r,n.cacheSizeBytes))}function y1(t,e,n){let r=new ot;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield Vp(t,n),yield nC(t,e),r.resolve()}catch(i){let s=i;if(!a1(s))throw s;Mn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function QC(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ot;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!ni.D())return Promise.resolve();let i=r+"main";yield ni.delete(i)})}(xC(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function YC(t){return function(n){let r=new ot;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return Wz(yield HC(n),r)})),r.promise}(dt(t=ge(t,Fe)))}function ZC(t){return oW(dt(t=ge(t,Fe)))}function XC(t){return aW(dt(t=ge(t,Fe)))}function JC(t,e){let n=dt(t=ge(t,Fe)),r=new sC;return dW(n,t._databaseId,e,r),r}function eD(t,e){return hW(dt(t=ge(t,Fe)),e).then(n=>n?new St(t,null,n.query):null)}function v1(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Dr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(mt.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Qn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var si=class{constructor(e){this._methodName=e}};var Xs=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}};var fW=/^__.*__$/,oC=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Kn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ui(e,this.data,n,this.fieldTransforms)}},bg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Kn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function _1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw P()}}var Sg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Ag(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(_1(this.Vu)&&fW.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},aC=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cl(e)}Cu(e,n,r,i=!1){return new Sg({Vu:e,methodName:n,Du:r,path:Xe.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function no(t){let e=t._freezeSettings(),n=Cl(t._databaseId);return new aC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Hg(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);rD("Data must be an object, but it was:",o,r);let a=I1(r,o),u,c;if(s.merge)u=new ln(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=hC(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);D1(l,h)||l.push(h)}u=new ln(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new oC(new kt(a),u,c)}var yl=class t extends si{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function w1(t,e,n){return new Sg({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var uC=class t extends si{_toFieldTransform(e){return new Ks(e.path,new Li)}isEqual(e){return e instanceof t}},cC=class t extends si{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=w1(this,e,!0),r=this.vu.map(s=>ro(s,n)),i=new ri(r);return new Ks(e.path,i)}isEqual(e){return e instanceof t&&Ty(this.vu,e.vu)}},lC=class t extends si{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=w1(this,e,!0),r=this.vu.map(s=>ro(s,n)),i=new ii(r);return new Ks(e.path,i)}isEqual(e){return e instanceof t&&Ty(this.vu,e.vu)}},dC=class t extends si{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new ji(e.serializer,pk(e.serializer,this.Fu));return new Ks(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function tD(t,e,n,r){let i=t.Cu(1,e,n);rD("Data must be an object, but it was:",i,r);let s=[],o=kt.empty();to(r,(u,c)=>{let l=iD(e,u,n);c=ce(c);let d=i.yu(l);if(c instanceof yl)s.push(l);else{let h=ro(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new ln(s);return new bg(o,a,i.fieldTransforms)}function nD(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[hC(e,r,n)],u=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(hC(e,s[h])),u.push(s[h+1]);let c=[],l=kt.empty();for(let h=a.length-1;h>=0;--h)if(!D1(c,a[h])){let f=a[h],p=u[h];p=ce(p);let g=o.yu(f);if(p instanceof yl)c.push(f);else{let _=ro(p,g);_!=null&&(c.push(f),l.set(f,_))}}let d=new ln(c);return new bg(l,d,o.fieldTransforms)}function E1(t,e,n,r=!1){return ro(n,t.Cu(r?4:3,e))}function ro(t,e){if(C1(t=ce(t)))return rD("Unsupported field value:",e,t),I1(t,e);if(t instanceof si)return function(r,i){if(!_1(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=ro(a,i.wu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=je.fromDate(r);return{timestampValue:Fa(i.serializer,s)}}if(r instanceof je){let s=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fa(i.serializer,s)}}if(r instanceof Xs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Dr)return{bytesValue:Dk(i.serializer,r._byteString)};if(r instanceof Me){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:bC(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${Lg(r)}`)}(t,e)}function I1(t,e){let n={};return YP(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):to(t,(r,i)=>{let s=ro(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function C1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof je||t instanceof Xs||t instanceof Dr||t instanceof Me||t instanceof si)}function rD(t,e,n){if(!C1(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Lg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function hC(t,e,n){if((e=ce(e))instanceof Qn)return e._internalPath;if(typeof e=="string")return iD(t,e);throw Ag("Field path arguments must be of type string or ",t,!1,void 0,n)}var pW=new RegExp("[~\\*/\\[\\]]");function iD(t,e,n){if(e.search(pW)>=0)throw Ag(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qn(...e.split("."))._internalPath}catch{throw Ag(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ag(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new w(y.INVALID_ARGUMENT,a+t+u)}function D1(t,e){return t.some(n=>n.isEqual(e))}var Js=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new fC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(qg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},fC=class extends Js{data(){return super.data()}};function qg(t,e){return typeof e=="string"?iD(t,e):e instanceof Qn?e._internalPath:e._delegate._internalPath}function T1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vl=class{},eo=class extends vl{};function Tr(t,e,...n){let r=[];e instanceof vl&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof pC).length,a=s.filter(u=>u instanceof xg).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var xg=class t extends eo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return S1(e._query,n),new St(e.firestore,e.converter,GE(e._query,n))}_parse(e){let n=no(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){jP(d,l);let f=[];for(let p of d)f.push(LP(u,s,p));h={arrayValue:{values:f}}}else h=LP(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||jP(d,l),h=E1(a,o,d,l==="in"||l==="not-in");return de.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function sD(t,e,n){let r=e,i=qg("where",t);return xg._create(i,r,n)}var pC=class t extends vl{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)S1(o,u),o=GE(o,u)}(e._query,n),new St(e.firestore,e.converter,GE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var gC=class t extends eo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zs(s,o)}(e._query,this._field,this._direction);return new St(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Wn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function oD(t,e="asc"){let n=e,r=qg("orderBy",t);return gC._create(r,n)}var Mg=class t extends eo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new St(e.firestore,e.converter,Qp(e._query,this._limit,this._limitType))}};function aD(t){return f1("limit",t),Mg._create("limit",t,"F")}function uD(t){return f1("limitToLast",t),Mg._create("limitToLast",t,"L")}var Rg=class t extends eo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=b1(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Wn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function cD(...t){return Rg._create("startAt",t,!0)}function lD(...t){return Rg._create("startAfter",t,!1)}var Ng=class t extends eo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=b1(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Wn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function dD(...t){return Ng._create("endBefore",t,!1)}function hD(...t){return Ng._create("endAt",t,!0)}function b1(t,e,n,r){if(n[0]=ce(n[0]),n[0]instanceof Js)return function(s,o,a,u,c){if(!u)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Aa(s))if(d.field.isKeyField())l.push(Gs(o,u.key));else{let h=u.data.field(d.field);if(kg(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Ir(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=no(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!DC(o)&&g.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let _=o.path.child(pe.fromString(g));if(!S.isDocumentKey(_))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);let C=new S(_);f.push(Gs(a,C))}else{let _=E1(u,c,g);f.push(_)}}return new Ir(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function LP(t,e,n){if(typeof(n=ce(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!DC(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(pe.fromString(n));if(!S.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gs(t,new S(r))}if(n instanceof Me)return Gs(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lg(n)}.`)}function jP(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function S1(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var za=class{convertValue(e,n="none"){switch(qs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw P()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return to(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Xs(Ke(e.latitude),Ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=IC(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(el(e));default:return null}}convertTimestamp(e){let n=ki(e);return new je(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=pe.fromString(e);V(Ok(r));let i=new Fi(r.get(1),r.get(3)),s=new S(r.popFirst(5));return i.isEqual(n)||Ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Gg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var mC=class extends za{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}};var ti=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Nn=class extends Js{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ni(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(qg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ni=class extends Nn{data(e={}){return super.data(e)}},Yn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ti(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ni(this._firestore,this._userDataWriter,r.key,r,new ti(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Ni(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ti(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Ni(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ti(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:gW(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function gW(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return P()}}function zg(t,e){return t instanceof Nn&&e instanceof Nn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Yn&&e instanceof Yn&&t._firestore===e._firestore&&$g(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function fD(t){t=ge(t,Me);let e=ge(t.firestore,Fe);return l1(dt(e),t._key).then(n=>ID(e,t,n))}var oi=class extends za{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}};function pD(t){t=ge(t,Me);let e=ge(t.firestore,Fe),n=dt(e),r=new oi(e);return uW(n,t._key).then(i=>new Nn(e,r,t._key,i,new ti(i!==null&&i.hasLocalMutations,!0),t.converter))}function gD(t){t=ge(t,Me);let e=ge(t.firestore,Fe);return l1(dt(e),t._key,{source:"server"}).then(n=>ID(e,t,n))}function mD(t){t=ge(t,St);let e=ge(t.firestore,Fe),n=dt(e),r=new oi(e);return T1(t._query),d1(n,t._query).then(i=>new Yn(e,r,t,i))}function yD(t){t=ge(t,St);let e=ge(t.firestore,Fe),n=dt(e),r=new oi(e);return cW(n,t._query).then(i=>new Yn(e,r,t,i))}function vD(t){t=ge(t,St);let e=ge(t.firestore,Fe),n=dt(e),r=new oi(e);return d1(n,t._query,{source:"server"}).then(i=>new Yn(e,r,t,i))}function Wg(t,e,n){t=ge(t,Me);let r=ge(t.firestore,Fe),i=Gg(t.converter,e,n);return eu(r,[Hg(no(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Qe.none())])}function Kg(t,e,n,...r){t=ge(t,Me);let i=ge(t.firestore,Fe),s=no(i),o;return o=typeof(e=ce(e))=="string"||e instanceof Qn?nD(s,"updateDoc",t._key,e,n,r):tD(s,"updateDoc",t._key,e),eu(i,[o.toMutation(t._key,Qe.exists(!0))])}function _D(t){return eu(ge(t.firestore,Fe),[new Bi(t._key,Qe.none())])}function wD(t,e){let n=ge(t.firestore,Fe),r=Ja(t),i=Gg(t.converter,e);return eu(n,[Hg(no(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}function Qg(t,...e){var n,r,i;t=ce(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||iC(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(iC(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof Me)c=ge(t.firestore,Fe),l=Ka(t._key.path),u={next:d=>{e[o]&&e[o](ID(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ge(t,St);c=ge(d.firestore,Fe),l=d._query;let h=new oi(c);u={next:f=>{e[o]&&e[o](new Yn(c,h,d,f))},error:e[o+1],complete:e[o+2]},T1(t._query)}return function(h,f,p,g){let _=new qa(g),C=new pl(f,_,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return PC(yield Ga(h),C)})),()=>{_.Qa(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return kC(yield Ga(h),C)}))}}(dt(c),l,a,u)}function ED(t,e){return lW(dt(t=ge(t,Fe)),iC(e)?e:{next:e})}function eu(t,e){return function(r,i){let s=new ot;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return Hz(yield HC(r),i,s)})),s.promise}(dt(t),e)}function ID(t,e,n){let r=n.docs.get(e._key),i=new oi(t);return new Nn(t,i,e._key,r,new ti(n.hasPendingWrites,n.fromCache),e.converter)}var mW={maxAttempts:5};var Pg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=no(e)}set(e,n,r){this._verifyNotCommitted();let i=Mi(e,this._firestore),s=Gg(i.converter,n,r),o=Hg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Mi(e,this._firestore),o;return o=typeof(n=ce(n))=="string"||n instanceof Qn?nD(this._dataReader,"WriteBatch.update",s._key,n,r,i):tD(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Mi(e,this._firestore);return this._mutations=this._mutations.concat(new Bi(n._key,Qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Mi(t,e){if((t=ce(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var yC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=no(n)}get(n){let r=Mi(n,this._firestore),i=new mC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return P();let o=s[0];if(o.isFoundDocument())return new Js(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Js(this._firestore,i,r._key,null,r.converter);throw P()})}set(n,r,i){let s=Mi(n,this._firestore),o=Gg(s.converter,r,i),a=Hg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Mi(n,this._firestore),a;return a=typeof(r=ce(r))=="string"||r instanceof Qn?nD(this._dataReader,"Transaction.update",o._key,r,i,s):tD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Mi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Mi(e,this._firestore),r=new oi(this._firestore);return super.get(e).then(i=>new Nn(this._firestore,r,n._key,i._document,new ti(!1,!1),n.converter))}};function CD(t,e,n){t=ge(t,Fe);let r=Object.assign(Object.assign({},mW),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new ot;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let c=yield sW(s);new eC(s.asyncQueue,c,a,o,u).Ya()})),u.promise}(dt(t),i=>e(new yC(t,i)),r)}function DD(){return new yl("deleteField")}function TD(){return new uC("serverTimestamp")}function bD(...t){return new cC("arrayUnion",t)}function SD(...t){return new lC("arrayRemove",t)}function AD(t){return new dC("increment",t)}(function(e,n=!0){(function(i){Wa=i})(Gd),us(new nn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Fe(new IE(r.getProvider("auth-internal")),new bE(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fi(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ft(UN,"4.5.1",e),Ft(UN,"4.5.1","esm2017")})();var Tl=class{constructor(e){return e}},A1="firestore",xD=class{constructor(){return mc(A1)}};var MD=new R("angularfire2.firestore-instances");function yW(t,e){let n=Cw(A1,t,e);return n&&new Tl(n)}function vW(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Tl(r)}}var _W={provide:xD,deps:[[new $n,MD]]},wW={provide:Tl,useFactory:yW,deps:[[new $n,MD],Yf]},EW=(()=>{class t{constructor(){Ft("angularfire",Yr.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=qe({type:t});static \u0275inj=He({providers:[wW,_W]})}return t})();function x1(t,...e){return{ngModule:EW,providers:[{provide:MD,useFactory:vW(t),multi:!0,deps:[ae,an,Zr,Zf,[new $n,Xf],[new $n,Sn],...e]}]}}var M1=Dw(g1,!0);var IW="firebase",CW="10.10.0";At.registerVersion(IW,CW,"app-compat");var DW=["ngOnDestroy"],N1=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(DW.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Yg=class{constructor(e){return e}},zi=new R("angularfire2.app.options"),Wi=new R("angularfire2.app.name");function io(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=At.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>At.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;TW("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Yg(o)}var TW=(t,...e)=>{H_()&&typeof console<"u"&&console[t](...e)},bW={provide:Yg,useFactory:io,deps:[zi,ae,[new $n,Wi]]},P1=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:zi,useValue:n},{provide:Wi,useValue:r}]}}constructor(n){At.registerVersion("angularfire",Yr.full,"core"),At.registerVersion("angularfire",Yr.full,"app-compat"),At.registerVersion("angular",Jx.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(Mt))};static \u0275mod=qe({type:t});static \u0275inj=He({providers:[bW]})}return t})();function tu(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return SW(i,o)||(R1("error",`${e} was already initialized on the ${n} Firebase App with different settings.${AW?" You may need to reload as Firebase is not HMR aware.":""}`),R1("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function SW(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var AW=typeof module<"u"&&!!module.hot,R1=(t,...e)=>{H_()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ne="primary",Ul=Symbol("RouteTitle"),OD=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ou(t){return new OD(t)}function xW(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function MW(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!br(t[n],e[n]))return!1;return!0}function br(t,e){let n=t?FD(t):void 0,r=e?FD(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!$1(t[i],e[i]))return!1;return!0}function FD(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function $1(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function H1(t){return t.length>0?t[t.length-1]:null}function Zi(t){return qy(t)?t:bs(t)?me(Promise.resolve(t)):F(t)}var RW={exact:G1,subset:z1},q1={exact:NW,subset:PW,ignored:()=>!0};function k1(t,e,n){return RW[n.paths](t.root,e.root,n.matrixParams)&&q1[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function NW(t,e){return br(t,e)}function G1(t,e,n){if(!oo(t.segments,e.segments)||!Jg(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!G1(t.children[r],e.children[r],n))return!1;return!0}function PW(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>$1(t[n],e[n]))}function z1(t,e,n){return W1(t,e,e.segments,n)}function W1(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!oo(i,n)||e.hasChildren()||!Jg(i,n,r))}else if(t.segments.length===n.length){if(!oo(t.segments,n)||!Jg(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!z1(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!oo(t.segments,i)||!Jg(t.segments,i,r)||!t.children[ne]?!1:W1(t.children[ne],e,s,r)}}function Jg(t,e,n){return e.every((r,i)=>q1[n](t[i].parameters,r.parameters))}var Ki=class{constructor(e=new Ee([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ou(this.queryParams),this._queryParamMap}toString(){return FW.serialize(this)}},Ee=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return em(this)}},so=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ou(this.parameters),this._parameterMap}toString(){return Q1(this)}};function kW(t,e){return oo(t,e)&&t.every((n,r)=>br(n.parameters,e[r].parameters))}function oo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function OW(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ne&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ne&&(n=n.concat(e(i,r)))}),n}var Bl=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>new Nl)(),providedIn:"root"});let t=e;return t})(),Nl=class{parse(e){let n=new LD(e);return new Ki(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${bl(e.root,!0)}`,r=jW(e.queryParams),i=typeof e.fragment=="string"?`#${VW(e.fragment)}`:"";return`${n}${r}${i}`}},FW=new Nl;function em(t){return t.segments.map(e=>Q1(e)).join("/")}function bl(t,e){if(!t.hasChildren())return em(t);if(e){let n=t.children[ne]?bl(t.children[ne],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ne&&r.push(`${i}:${bl(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=OW(t,(r,i)=>i===ne?[bl(t.children[ne],!1)]:[`${i}:${bl(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ne]!=null?`${em(t)}/${n[0]}`:`${em(t)}/(${n.join("//")})`}}function K1(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Zg(t){return K1(t).replace(/%3B/gi,";")}function VW(t){return encodeURI(t)}function VD(t){return K1(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function tm(t){return decodeURIComponent(t)}function O1(t){return tm(t.replace(/\+/g,"%20"))}function Q1(t){return`${VD(t.path)}${LW(t.parameters)}`}function LW(t){return Object.entries(t).map(([e,n])=>`;${VD(e)}=${VD(n)}`).join("")}function jW(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Zg(n)}=${Zg(i)}`).join("&"):`${Zg(n)}=${Zg(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var UW=/^[^\/()?;#]+/;function RD(t){let e=t.match(UW);return e?e[0]:""}var BW=/^[^\/()?;=#]+/;function $W(t){let e=t.match(BW);return e?e[0]:""}var HW=/^[^=?&#]+/;function qW(t){let e=t.match(HW);return e?e[0]:""}var GW=/^[^&#]+/;function zW(t){let e=t.match(GW);return e?e[0]:""}var LD=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ne]=new Ee(e,n)),r}parseSegment(){let e=RD(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new L(4009,!1);return this.capture(e),new so(tm(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=$W(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=RD(this.remaining);i&&(r=i,this.capture(r))}e[tm(n)]=tm(r)}parseQueryParam(e){let n=qW(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=zW(this.remaining);o&&(r=o,this.capture(r))}let i=O1(n),s=O1(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=RD(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new L(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ne]:new Ee([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new L(4011,!1)}};function Y1(t){return t.segments.length>0?new Ee([],{[ne]:t}):t}function Z1(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=Z1(i);if(r===ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ee(t.segments,e);return WW(n)}function WW(t){if(t.numberOfChildren===1&&t.children[ne]){let e=t.children[ne];return new Ee(t.segments.concat(e.segments),e.children)}return t}function au(t){return t instanceof Ki}function KW(t,e,n=null,r=null){let i=X1(t);return J1(i,e,n,r)}function X1(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new Ee(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=Y1(r);return e??i}function J1(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return ND(i,i,i,n,r);let s=QW(e);if(s.toRoot())return ND(i,i,new Ee([],{}),n,r);let o=YW(s,i,t),a=o.processChildren?xl(o.segmentGroup,o.index,s.commands):tO(o.segmentGroup,o.index,s.commands);return ND(i,o.segmentGroup,a,n,r)}function nm(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Pl(t){return typeof t=="object"&&t!=null&&t.outlets}function ND(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=eO(t,e,n);let a=Y1(Z1(o));return new Ki(a,s,i)}function eO(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=eO(s,e,n)}),new Ee(t.segments,r)}var rm=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&nm(r[0]))throw new L(4003,!1);let i=r.find(Pl);if(i&&i!==H1(r))throw new L(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function QW(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new rm(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new rm(n,e,r)}var iu=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function YW(t,e,n){if(t.isAbsolute)return new iu(e,!0,0);if(!n)return new iu(e,!1,NaN);if(n.parent===null)return new iu(n,!0,0);let r=nm(t.commands[0])?0:1,i=n.segments.length-1+r;return ZW(n,i,t.numberOfDoubleDots)}function ZW(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new L(4005,!1);i=r.segments.length}return new iu(r,!1,i-s)}function XW(t){return Pl(t[0])?t[0].outlets:{[ne]:t}}function tO(t,e,n){if(t??=new Ee([],{}),t.segments.length===0&&t.hasChildren())return xl(t,e,n);let r=JW(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ee(t.segments.slice(0,r.pathIndex),{});return s.children[ne]=new Ee(t.segments.slice(r.pathIndex),t.children),xl(s,0,i)}else return r.match&&i.length===0?new Ee(t.segments,{}):r.match&&!t.hasChildren()?jD(t,e,n):r.match?xl(t,0,i):jD(t,e,n)}function xl(t,e,n){if(n.length===0)return new Ee(t.segments,{});{let r=XW(n),i={};if(Object.keys(r).some(s=>s!==ne)&&t.children[ne]&&t.numberOfChildren===1&&t.children[ne].segments.length===0){let s=xl(t.children[ne],e,n);return new Ee(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=tO(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ee(t.segments,i)}}function JW(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Pl(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!V1(u,c,o))return s;r+=2}else{if(!V1(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function jD(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Pl(s)){let u=e3(s.outlets);return new Ee(r,u)}if(i===0&&nm(n[0])){let u=t.segments[e];r.push(new so(u.path,F1(n[0]))),i++;continue}let o=Pl(s)?s.outlets[ne]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&nm(a)?(r.push(new so(o,F1(a))),i+=2):(r.push(new so(o,{})),i++)}return new Ee(r,{})}function e3(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=jD(new Ee([],{}),0,r))}),e}function F1(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function V1(t,e,n){return t==n.path&&br(e,n.parameters)}var Ml="imperative",vt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(vt||{}),Pn=class{constructor(e,n){this.id=e,this.url=n}},uu=class extends Pn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=vt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Sr=class extends Pn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=vt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},hn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(hn||{}),im=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(im||{}),Qi=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=vt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Yi=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=vt.NavigationSkipped}},kl=class extends Pn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=vt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},sm=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=vt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},UD=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=vt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},BD=class extends Pn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=vt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},$D=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=vt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},HD=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=vt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qD=class{constructor(e){this.route=e,this.type=vt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},GD=class{constructor(e){this.route=e,this.type=vt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},zD=class{constructor(e){this.snapshot=e,this.type=vt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},WD=class{constructor(e){this.snapshot=e,this.type=vt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},KD=class{constructor(e){this.snapshot=e,this.type=vt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},QD=class{constructor(e){this.snapshot=e,this.type=vt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},om=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=vt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Ol=class{},Fl=class{constructor(e){this.url=e}};var YD=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new $l,this.attachRef=null}},$l=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new YD,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),am=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=ZD(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=ZD(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=XD(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return XD(e,this._root).map(n=>n.value)}};function ZD(t,e){if(t===e.value)return e;for(let n of e.children){let r=ZD(t,n);if(r)return r}return null}function XD(t,e){if(t===e.value)return[e];for(let n of e.children){let r=XD(t,n);if(r.length)return r.unshift(e),r}return[]}var dn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ru(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var um=class extends am{constructor(e,n){super(e),this.snapshot=n,u0(this,e)}toString(){return this.snapshot.toString()}};function nO(t){let e=t3(t),n=new It([new so("",{})]),r=new It({}),i=new It({}),s=new It({}),o=new It(""),a=new ui(n,r,s,o,i,ne,t,e.root);return a.snapshot=e.root,new um(new dn(a,[]),e)}function t3(t){let e={},n={},r={},i="",s=new Vl([],e,r,i,n,ne,t,null,{});return new cm("",new dn(s,[]))}var ui=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(O(c=>c[Ul]))??F(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(O(e=>ou(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(O(e=>ou(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function a0(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:b(b({},e.params),t.params),data:b(b({},e.data),t.data),resolve:b(b(b(b({},t.data),e.data),i?.data),t._resolvedData)}:r={params:b({},t.params),data:b({},t.data),resolve:b(b({},t.data),t._resolvedData??{})},i&&iO(i)&&(r.resolve[Ul]=i.title),r}var Vl=class{get title(){return this.data?.[Ul]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ou(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ou(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},cm=class extends am{constructor(e,n){super(n),this.url=e,u0(this,n)}toString(){return rO(this._root)}};function u0(t,e){e.value._routerState=t,e.children.forEach(n=>u0(t,n))}function rO(t){let e=t.children.length>0?` { ${t.children.map(rO).join(", ")} } `:"";return`${t.value}${e}`}function PD(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,br(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),br(e.params,n.params)||t.paramsSubject.next(n.params),MW(e.url,n.url)||t.urlSubject.next(n.url),br(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function JD(t,e){let n=br(t.params,e.params)&&kW(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||JD(t.parent,e.parent))}function iO(t){return typeof t.title=="string"||t.title===null}var c0=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new $e,this.deactivateEvents=new $e,this.attachEvents=new $e,this.detachEvents=new $e,this.parentContexts=M($l),this.location=M(Jo),this.changeDetector=M(Ss),this.environmentInjector=M(sn),this.inputBinder=M(pm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new L(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new L(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new L(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new L(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new e0(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Oe({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[cr]});let t=e;return t})(),e0=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r,this.__ngOutletInjector=!0}get(e,n){return e===ui?this.route:e===$l?this.childContexts:this.parent.get(e,n)}},pm=new R(""),L1=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Vu([i.queryParams,i.params,i.data]).pipe(ke(([o,a,u],c)=>(u=b(b(b({},o),a),u),c===0?F(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=cM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})();function n3(t,e,n){let r=Ll(t,e._root,n?n._root:void 0);return new um(r,e)}function Ll(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=r3(t,e,n);return new dn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Ll(t,a)),o}}let r=i3(e.value),i=e.children.map(s=>Ll(t,s));return new dn(r,i)}}function r3(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Ll(t,r,i);return Ll(t,r)})}function i3(t){return new ui(new It(t.url),new It(t.params),new It(t.queryParams),new It(t.fragment),new It(t.data),t.outlet,t.component,t)}var sO="ngNavigationCancelingError";function oO(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=au(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=aO(!1,hn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function aO(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[sO]=!0,n.cancellationCode=e,n}function s3(t){return uO(t)&&au(t.url)}function uO(t){return!!t&&t[sO]}var o3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Zt({type:e,selectors:[["ng-component"]],standalone:!0,features:[Xx],decls:1,vars:0,template:function(i,s){i&1&&Dt(0,"router-outlet")},dependencies:[c0],encapsulation:2});let t=e;return t})();function a3(t,e){return t.providers&&!t._injector&&(t._injector=yf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function l0(t){let e=t.children&&t.children.map(l0),n=e?ye(b({},t),{children:e}):b({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ne&&(n.component=o3),n}function Ar(t){return t.outlet||ne}function u3(t,e){let n=t.filter(r=>Ar(r)===e);return n.push(...t.filter(r=>Ar(r)!==e)),n}function Hl(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var c3=(t,e,n,r)=>O(i=>(new t0(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),t0=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),PD(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=ru(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ru(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ru(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=ru(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new QD(s.value.snapshot))}),e.children.length&&this.forwardEvent(new WD(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(PD(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),PD(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Hl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},lm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},su=class{constructor(e,n){this.component=e,this.route=n}};function l3(t,e,n){let r=t._root,i=e?e._root:null;return Sl(r,i,n,[r.value])}function d3(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function lu(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!eA(t)?t:e.get(t):r}function Sl(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ru(e);return t.children.forEach(o=>{h3(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Rl(a,n.getContext(o),i)),i}function h3(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=f3(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new lm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Sl(t,e,a?a.children:null,r,i):Sl(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new su(a.outlet.component,o))}else o&&Rl(e,a,i),i.canActivateChecks.push(new lm(r)),s.component?Sl(t,null,a?a.children:null,r,i):Sl(t,null,n,r,i);return i}function f3(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!oo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!oo(t.url,e.url)||!br(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!JD(t,e)||!br(t.queryParams,e.queryParams);case"paramsChange":default:return!JD(t,e)}}function Rl(t,e,n){let r=ru(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Rl(o,e.children.getContext(s),n):Rl(o,null,n):Rl(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new su(e.outlet.component,i)):n.canDeactivateChecks.push(new su(null,i)):n.canDeactivateChecks.push(new su(null,i))}function ql(t){return typeof t=="function"}function p3(t){return typeof t=="boolean"}function g3(t){return t&&ql(t.canLoad)}function m3(t){return t&&ql(t.canActivate)}function y3(t){return t&&ql(t.canActivateChild)}function v3(t){return t&&ql(t.canDeactivate)}function _3(t){return t&&ql(t.canMatch)}function cO(t){return t instanceof Vr||t?.name==="EmptyError"}var Xg=Symbol("INITIAL_VALUE");function cu(){return ke(t=>Vu(t.map(e=>e.pipe(Lr(1),gs(Xg)))).pipe(O(e=>{for(let n of e)if(n!==!0){if(n===Xg)return Xg;if(n===!1||n instanceof Ki)return n}return!0}),Ct(e=>e!==Xg),Lr(1)))}function w3(t,e){return tt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?F(ye(b({},n),{guardsResult:!0})):E3(o,r,i,t).pipe(tt(a=>a&&p3(a)?I3(r,s,t,e):F(a)),O(a=>ye(b({},n),{guardsResult:a})))})}function E3(t,e,n,r){return me(t).pipe(tt(i=>S3(i.component,i.route,n,e,r)),wn(i=>i!==!0,!0))}function I3(t,e,n,r){return me(e).pipe(ps(i=>Po(D3(i.route.parent,r),C3(i.route,r),b3(t,i.path,n),T3(t,i.route,n))),wn(i=>i!==!0,!0))}function C3(t,e){return t!==null&&e&&e(new KD(t)),F(!0)}function D3(t,e){return t!==null&&e&&e(new zD(t)),F(!0)}function T3(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return F(!0);let i=r.map(s=>mh(()=>{let o=Hl(e)??n,a=lu(s,o),u=m3(a)?a.canActivate(e,t):Br(o,()=>a(e,t));return Zi(u).pipe(wn())}));return F(i).pipe(cu())}function b3(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>d3(o)).filter(o=>o!==null).map(o=>mh(()=>{let a=o.guards.map(u=>{let c=Hl(o.node)??n,l=lu(u,c),d=y3(l)?l.canActivateChild(r,t):Br(c,()=>l(r,t));return Zi(d).pipe(wn())});return F(a).pipe(cu())}));return F(s).pipe(cu())}function S3(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return F(!0);let o=s.map(a=>{let u=Hl(e)??i,c=lu(a,u),l=v3(c)?c.canDeactivate(t,e,n,r):Br(u,()=>c(t,e,n,r));return Zi(l).pipe(wn())});return F(o).pipe(cu())}function A3(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return F(!0);let s=i.map(o=>{let a=lu(o,t),u=g3(a)?a.canLoad(e,n):Br(t,()=>a(e,n));return Zi(u)});return F(s).pipe(cu(),lO(r))}function lO(t){return Ly(ct(e=>{if(au(e))throw oO(t,e)}),O(e=>e===!0))}function x3(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return F(!0);let s=i.map(o=>{let a=lu(o,t),u=_3(a)?a.canMatch(e,n):Br(t,()=>a(e,n));return Zi(u)});return F(s).pipe(cu(),lO(r))}var jl=class{constructor(e){this.segmentGroup=e||null}},dm=class extends Error{constructor(e){super(),this.urlTree=e}};function nu(t){return No(new jl(t))}function M3(t){return No(new L(4e3,!1))}function R3(t){return No(aO(!1,hn.GuardRejected))}var n0=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return F(r);if(i.numberOfChildren>1||!i.children[ne])return M3(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new dm(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ki(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Ee(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new L(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},r0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function N3(t,e,n,r,i){let s=d0(t,e,n);return s.matched?(r=a3(e,r),x3(r,e,n,i).pipe(O(o=>o===!0?s:b({},r0)))):F(s)}function d0(t,e,n){if(e.path==="**")return P3(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?b({},r0):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||xW)(n,t,e);if(!i)return b({},r0);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?b(b({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function P3(t){return{matched:!0,parameters:t.length>0?H1(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function j1(t,e,n,r){return n.length>0&&F3(t,n,r)?{segmentGroup:new Ee(e,O3(r,new Ee(n,t.children))),slicedSegments:[]}:n.length===0&&V3(t,n,r)?{segmentGroup:new Ee(t.segments,k3(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ee(t.segments,t.children),slicedSegments:n}}function k3(t,e,n,r){let i={};for(let s of n)if(gm(t,e,s)&&!r[Ar(s)]){let o=new Ee([],{});i[Ar(s)]=o}return b(b({},r),i)}function O3(t,e){let n={};n[ne]=e;for(let r of t)if(r.path===""&&Ar(r)!==ne){let i=new Ee([],{});n[Ar(r)]=i}return n}function F3(t,e,n){return n.some(r=>gm(t,e,r)&&Ar(r)!==ne)}function V3(t,e,n){return n.some(r=>gm(t,e,r))}function gm(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function L3(t,e,n,r){return Ar(t)!==r&&(r===ne||!gm(e,n,t))?!1:d0(e,t,n).matched}function j3(t,e,n){return e.length===0&&!t.children[n]}var i0=class{};function U3(t,e,n,r,i,s,o="emptyOnly"){return new s0(t,e,n,r,i,o,s).recognize()}var B3=31,s0=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new n0(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new L(4002,`'${e.segmentGroup}'`)}recognize(){let e=j1(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(O(n=>{let r=new Vl([],Object.freeze({}),Object.freeze(b({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new dn(r,n),s=new cm("",i),o=KW(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(pi(r=>{if(r instanceof dm)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof jl?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=a0(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(O(s=>s instanceof dn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return me(i).pipe(ps(s=>{let o=r.children[s],a=u3(n,s);return this.processSegmentGroup(e,a,o,s)}),nr((s,o)=>(s.push(...o),s)),gi(null),Wy(),tt(s=>{if(s===null)return nu(r);let o=dO(s);return $3(o),F(o)}))}processSegment(e,n,r,i,s,o){return me(n).pipe(ps(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(pi(u=>{if(u instanceof jl)return F(null);throw u}))),wn(a=>!!a),pi(a=>{if(cO(a))return j3(r,i,s)?F(new i0):nu(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return L3(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):nu(i):nu(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=d0(n,i,s);if(!a)return nu(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>B3&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(tt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=N3(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(ke(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ke(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new Vl(l,h,Object.freeze(b({},this.urlTree.queryParams)),this.urlTree.fragment,q3(r),Ar(r),r.component??r._loadedComponent??null,r,G3(r)),{segmentGroup:p,slicedSegments:g}=j1(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(O(C=>C===null?null:new dn(f,C)));if(u.length===0&&g.length===0)return F(new dn(f,[]));let _=Ar(r)===s;return this.processSegment(c,u,p,g,_?ne:s,!0).pipe(O(C=>new dn(f,C instanceof dn?[C]:[])))}))):nu(n)))}getChildConfig(e,n,r){return n.children?F({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?F({routes:n._loadedRoutes,injector:n._loadedInjector}):A3(e,n,r,this.urlSerializer).pipe(tt(i=>i?this.configLoader.loadChildren(e,n).pipe(ct(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):R3(n))):F({routes:[],injector:e})}};function $3(t){t.sort((e,n)=>e.value.outlet===ne?-1:n.value.outlet===ne?1:e.value.outlet.localeCompare(n.value.outlet))}function H3(t){let e=t.value.routeConfig;return e&&e.path===""}function dO(t){let e=[],n=new Set;for(let r of t){if(!H3(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=dO(r.children);e.push(new dn(r.value,i))}return e.filter(r=>!n.has(r))}function q3(t){return t.data||{}}function G3(t){return t.resolve||{}}function z3(t,e,n,r,i,s){return tt(o=>U3(t,e,n,r,o.extractedUrl,i,s).pipe(O(({state:a,tree:u})=>ye(b({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function W3(t,e){return tt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return F(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of hO(u))o.add(c);let a=0;return me(o).pipe(ps(u=>s.has(u)?K3(u,r,t,e):(u.data=a0(u,u.parent,t).resolve,F(void 0))),ct(()=>a++),Oo(1),tt(u=>a===o.size?F(n):Vt))})}function hO(t){let e=t.children.map(n=>hO(n)).flat();return[t,...e]}function K3(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!iO(i)&&(s[Ul]=i.title),Q3(s,t,e,r).pipe(O(o=>(t._resolvedData=o,t.data=a0(t,t.parent,n).resolve,null)))}function Q3(t,e,n,r){let i=FD(t);if(i.length===0)return F({});let s={};return me(i).pipe(tt(o=>Y3(t[o],e,n,r).pipe(wn(),ct(a=>{s[o]=a}))),Oo(1),zy(s),pi(o=>cO(o)?Vt:No(o)))}function Y3(t,e,n,r){let i=Hl(e)??r,s=lu(t,i),o=s.resolve?s.resolve(e,n):Br(i,()=>s(e,n));return Zi(o)}function kD(t){return ke(e=>{let n=t(e);return n?me(n).pipe(O(()=>e)):F(e)})}var fO=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(r){return r.data[Ul]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(Z3))(),providedIn:"root"});let t=e;return t})(),Z3=(()=>{let e=class e extends fO{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(NM))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gl=new R("",{providedIn:"root",factory:()=>({})}),hm=new R(""),h0=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=M(Sf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return F(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Zi(r.loadComponent()).pipe(O(pO),ct(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),ju(()=>{this.componentLoaders.delete(r)})),s=new So(i,()=>new Be).pipe(bo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return F({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=X3(i,this.compiler,r,this.onLoadEndListener).pipe(ju(()=>{this.childrenLoaders.delete(i)})),a=new So(o,()=>new Be).pipe(bo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function X3(t,e,n,r){return Zi(t.loadChildren()).pipe(O(pO),tt(i=>i instanceof Xu||Array.isArray(i)?F(i):me(e.compileModuleAsync(i))),O(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(hm,[],{optional:!0,self:!0}).flat()),{routes:o.map(l0),injector:s}}))}function J3(t){return t&&typeof t=="object"&&"default"in t}function pO(t){return J3(t)?t.default:t}var f0=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(e9))(),providedIn:"root"});let t=e;return t})(),e9=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),gO=new R(""),mO=new R("");function t9(t,e,n){let r=t.get(mO),i=t.get(en);return t.get(ae).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),n9(t))),{onViewTransitionCreated:u}=r;return u&&Br(t,()=>u({transition:a,from:e,to:n})),o})}function n9(t){return new Promise(e=>{P_(e,{injector:t})})}var p0=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Be,this.transitionAbortSubject=new Be,this.configLoader=M(h0),this.environmentInjector=M(sn),this.urlSerializer=M(Bl),this.rootContexts=M($l),this.location=M(na),this.inputBindingEnabled=M(pm,{optional:!0})!==null,this.titleStrategy=M(fO),this.options=M(Gl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=M(f0),this.createViewTransition=M(gO,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>F(void 0),this.rootComponentType=null;let r=s=>this.events.next(new qD(s)),i=s=>this.events.next(new GD(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ye(b(b({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new It({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ml,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ct(o=>o.id!==0),O(o=>ye(b({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ke(o=>{let a=!1,u=!1;return F(o).pipe(ke(c=>{if(this.navigationId>o.id){let h="";return this.cancelNavigationTransition(o,h,hn.SupersededByNewNavigation),Vt}this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ye(b({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Yi(c.id,this.urlSerializer.serialize(c.rawUrl),h,im.IgnoredSameUrlNavigation)),c.resolve(null),Vt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return F(c).pipe(ke(h=>{let f=this.transitions?.getValue();return this.events.next(new uu(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Vt:Promise.resolve(h)}),z3(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),ct(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ye(b({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new sm(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:_}=c,C=new uu(h,this.urlSerializer.serialize(f),p,g);this.events.next(C);let k=nO(this.rootComponentType).snapshot;return this.currentTransition=o=ye(b({},c),{targetSnapshot:k,urlAfterRedirects:f,extras:ye(b({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,F(o)}else{let h="";return this.events.next(new Yi(c.id,this.urlSerializer.serialize(c.extractedUrl),h,im.IgnoredByUrlHandlingStrategy)),c.resolve(null),Vt}}),ct(c=>{let l=new UD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),O(c=>(this.currentTransition=o=ye(b({},c),{guards:l3(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),w3(this.environmentInjector,c=>this.events.next(c)),ct(c=>{if(o.guardsResult=c.guardsResult,au(c.guardsResult))throw oO(this.urlSerializer,c.guardsResult);let l=new BD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Ct(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",hn.GuardRejected),!1)),kD(c=>{if(c.guards.canActivateChecks.length)return F(c).pipe(ct(l=>{let d=new $D(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ke(l=>{let d=!1;return F(l).pipe(W3(this.paramsInheritanceStrategy,this.environmentInjector),ct({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",hn.NoDataFromResolver)}}))}),ct(l=>{let d=new HD(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),kD(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ct(f=>{d.component=f}),O(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Vu(l(c.targetSnapshot.root)).pipe(gi(null),Lr(1))}),kD(()=>this.afterPreactivation()),ke(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?me(d).pipe(O(()=>o)):F(o)}),O(c=>{let l=n3(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ye(b({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),ct(()=>{this.events.next(new Ol)}),c3(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Lr(1),ct({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Sr(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Yy(this.transitionAbortSubject.pipe(ct(c=>{throw c}))),ju(()=>{if(!a&&!u){let c="";this.cancelNavigationTransition(o,c,hn.SupersededByNewNavigation)}this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),pi(c=>{if(u=!0,uO(c))this.events.next(new Qi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),s3(c)?this.events.next(new Fl(c.url)):o.resolve(!1);else{this.events.next(new kl(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Vt}))}))}cancelNavigationTransition(r,i,s){let o=new Qi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function r9(t){return t!==Ml}var i9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(s9))(),providedIn:"root"});let t=e;return t})(),o0=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},s9=(()=>{let e=class e extends o0{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:()=>(()=>M(o9))(),providedIn:"root"});let t=e;return t})(),o9=(()=>{let e=class e extends yO{constructor(){super(...arguments),this.location=M(na),this.urlSerializer=M(Bl),this.options=M(Gl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=M(f0),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ki,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=nO(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof uu)this.stateMemento=this.createStateMemento();else if(r instanceof Yi)this.rawUrlTree=i.initialUrl;else if(r instanceof sm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Ol?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Qi&&(r.code===hn.GuardRejected||r.code===hn.NoDataFromResolver)?this.restoreHistory(i):r instanceof kl?this.restoreHistory(i,!0):r instanceof Sr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=b(b({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=b(b({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=qr(e)))(s||e)}})(),e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Al=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Al||{});function vO(t,e){t.events.pipe(Ct(n=>n instanceof Sr||n instanceof Qi||n instanceof kl||n instanceof Yi),O(n=>n instanceof Sr||n instanceof Yi?Al.COMPLETE:(n instanceof Qi?n.code===hn.Redirect||n.code===hn.SupersededByNewNavigation:!1)?Al.REDIRECTING:Al.FAILED),Ct(n=>n!==Al.REDIRECTING),Lr(1)).subscribe(()=>{e()})}function a9(t){throw t}var u9={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},c9={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},xr=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=M(Cf),this.stateManager=M(yO),this.options=M(Gl,{optional:!0})||{},this.pendingTasks=M(vf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=M(p0),this.urlSerializer=M(Bl),this.location=M(na),this.urlHandlingStrategy=M(f0),this._events=new Be,this.errorHandler=this.options.errorHandler||a9,this.navigated=!1,this.routeReuseStrategy=M(i9),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=M(hm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!M(pm,{optional:!0}),this.eventsSubscription=new Ye,this.isNgZoneEnabled=M(ae)instanceof ae&&ae.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Qi&&i.code!==hn.Redirect&&i.code!==hn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Sr)this.navigated=!0;else if(i instanceof Fl){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||r9(s.source)};this.scheduleNavigation(a,Ml,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}d9(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ml,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=b({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(l0),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=b(b({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=X1(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return J1(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=au(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Ml,null,i)}navigate(r,i={skipLocationChange:!1}){return l9(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=b({},u9):i===!1?s=b({},c9):s=i,au(r))return k1(this.currentUrlTree,r,s);let o=this.parseUrl(r);return k1(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return vO(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function l9(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new L(4008,!1)}function d9(t){return!(t instanceof Ol)&&!(t instanceof Fl)}var mm=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Be,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof Sr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:fx(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(j(xr),j(ui),y_("tabindex"),j(Gr),j(lr),j(Kr))},e.\u0275dir=Oe({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&ft("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&ic("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[nt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ci],skipLocationChange:[nt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ci],replaceUrl:[nt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ci],routerLink:"routerLink"},standalone:!0,features:[O_,cr]});let t=e;return t})();var fm=class{};var h9=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Ct(r=>r instanceof Sr),ps(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=yf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return me(s).pipe(fi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=F(null);let o=s.pipe(tt(a=>a===null?F(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return me([o,a]).pipe(fi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(xr),E(Sf),E(sn),E(fm),E(h0))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_O=new R(""),f9=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof uu?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Sr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Yi&&r.code===im.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof om&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new om(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Tx()},e.\u0275prov=N({token:e,factory:e.\u0275fac});let t=e;return t})();function p9(t){return t.routerState.root}function zl(t,e){return{\u0275kind:t,\u0275providers:e}}function g9(){let t=M(an);return e=>{let n=t.get(ta);if(e!==n.components[0])return;let r=t.get(xr),i=t.get(wO);t.get(g0)===1&&r.initialNavigation(),t.get(EO,null,oe.Optional)?.setUpPreloading(),t.get(_O,null,oe.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var wO=new R("",{factory:()=>new Be}),g0=new R("",{providedIn:"root",factory:()=>1});function m9(){return zl(2,[{provide:g0,useValue:0},{provide:bf,multi:!0,deps:[an],useFactory:e=>{let n=e.get(mM,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(xr),s=e.get(wO);vO(i,()=>{r(!0)}),e.get(p0).afterPreactivation=()=>(r(!0),s.closed?F(void 0):s),i.initialNavigation()}))}}])}function y9(){return zl(3,[{provide:bf,multi:!0,useFactory:()=>{let e=M(xr);return()=>{e.setUpLocationChangeListener()}}},{provide:g0,useValue:2}])}var EO=new R("");function v9(t){return zl(0,[{provide:EO,useExisting:h9},{provide:fm,useExisting:t}])}function _9(){return zl(8,[L1,{provide:pm,useExisting:L1}])}function w9(t){let e=[{provide:gO,useValue:t9},{provide:mO,useValue:b({skipNextTransition:!!t?.skipInitialTransition},t)}];return zl(9,e)}var U1=new R("ROUTER_FORROOT_GUARD"),E9=[na,{provide:Bl,useClass:Nl},xr,$l,{provide:ui,useFactory:p9,deps:[xr]},h0,[]],m0=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[E9,[],{provide:hm,multi:!0,useValue:r},{provide:U1,useFactory:T9,deps:[[xr,new $n,new t_]]},{provide:Gl,useValue:i||{}},i?.useHash?C9():D9(),I9(),i?.preloadingStrategy?v9(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?b9(i):[],i?.bindToComponentInputs?_9().\u0275providers:[],i?.enableViewTransitions?w9().\u0275providers:[],S9()]}}static forChild(r){return{ngModule:e,providers:[{provide:hm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(U1,8))},e.\u0275mod=qe({type:e}),e.\u0275inj=He({});let t=e;return t})();function I9(){return{provide:_O,useFactory:()=>{let t=M(IM),e=M(ae),n=M(Gl),r=M(p0),i=M(Bl);return n.scrollOffset&&t.setOffset(n.scrollOffset),new f9(i,r,t,e,n)}}}function C9(){return{provide:Kr,useClass:vM}}function D9(){return{provide:Kr,useClass:Z_}}function T9(t){return"guarded"}function b9(t){return[t.initialNavigation==="disabled"?y9().\u0275providers:[],t.initialNavigation==="enabledBlocking"?m9().\u0275providers:[]]}var B1=new R("");function S9(){return[{provide:B1,useFactory:g9},{provide:U_,multi:!0,useExisting:B1}]}var A9=new Map,x9={activated:!1,tokenObservers:[]},M9={initialized:!1,enabled:!1};function Zn(t){return A9.get(t)||Object.assign({},x9)}function bO(){return M9}var R9="https://content-firebaseappcheck.googleapis.com/v1";var N9="exchangeDebugToken",IO={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Vie=24*60*60*1e3;var v0=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new ht,this.pending.promise.catch(n=>{}),yield P9(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ht,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function P9(t){return new Promise(e=>{setTimeout(e,t)})}var k9={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Xi=new kb("appCheck","AppCheck",k9);function SO(t){if(!Zn(t).activated)throw Xi.create("use-before-activation",{appName:t.name})}function AO(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw Xi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw Xi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw Xi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Xi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function xO(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${R9}/projects/${n}/apps/${r}:${N9}?key=${i}`,body:{debug_token:e}}}var O9="firebase-app-check-database",F9=1,_0="firebase-app-check-store";var ym=null;function V9(){return ym||(ym=new Promise((t,e)=>{try{let n=indexedDB.open(O9,F9);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Xi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(_0,{keyPath:"compositeKey"})}}}catch(n){e(Xi.create("storage-open",{originalErrorMessage:n?.message}))}}),ym)}function L9(t,e){return j9(U9(t),e)}function j9(t,e){return v(this,null,function*(){let r=(yield V9()).transaction(_0,"readwrite"),s=r.objectStore(_0).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(Xi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function U9(t){return`${t.options.appId}-${t.name}`}var w0=new hi("@firebase/app-check");function y0(t,e){return Ud()?L9(t,e).catch(n=>{w0.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function MO(){return bO().enabled}function RO(){return v(this,null,function*(){let t=bO();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var B9={error:"UNKNOWN_ERROR"};function $9(t){return Ld.encodeString(JSON.stringify(t),!1)}function E0(t,e=!1){return v(this,null,function*(){let n=t.app;SO(n);let r=Zn(n),i=r.token,s;if(i&&!Kl(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Kl(u)?i=u:yield y0(n,void 0))}if(!e&&i&&Kl(i))return{token:i.token};let o=!1;if(MO()){r.exchangeTokenPromise||(r.exchangeTokenPromise=AO(xO(n,yield RO()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield y0(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Zn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?w0.warn(u.message):w0.error(u),s=u}let a;return i?s?Kl(i)?a={token:i.token,internalError:s}:a=DO(s):(a={token:i.token},r.token=i,yield y0(n,i)):a=DO(s),o&&z9(n,a),a})}function H9(t){return v(this,null,function*(){let e=t.app;SO(e);let{provider:n}=Zn(e);if(MO()){let r=yield RO(),{token:i}=yield AO(xO(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function q9(t,e,n,r){let{app:i}=t,s=Zn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Kl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),CO(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>CO(t))}function NO(t,e){let n=Zn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function CO(t){let{app:e}=t,n=Zn(e),r=n.tokenRefresher;r||(r=G9(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function G9(t){let{app:e}=t;return new v0(()=>v(this,null,function*(){let n=Zn(e),r;if(n.token?r=yield E0(t,!0):r=yield E0(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Zn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},IO.RETRIAL_MIN_WAIT,IO.RETRIAL_MAX_WAIT)}function z9(t,e){let n=Zn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Kl(t){return t.expireTimeMillis-Date.now()>0}function DO(t){return{token:$9(B9),error:t}}var I0=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Zn(this.app);for(let n of e)NO(this.app,n.next);return Promise.resolve()}};function W9(t,e){return new I0(t,e)}function K9(t){return{getToken:e=>E0(t,e),getLimitedUseToken:()=>H9(t),addTokenListener:e=>q9(t,"INTERNAL",e),removeTokenListener:e=>NO(t.app,e)}}var Q9="@firebase/app-check",Y9="0.8.3";var Z9="app-check",TO="app-check-internal";function X9(){us(new nn(Z9,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return W9(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(TO).initialize()})),us(new nn(TO,t=>{let e=t.getProvider("app-check").getImmediate();return K9(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ft(Q9,Y9)}X9();var J9=["localhost","0.0.0.0","127.0.0.1"],Qie=typeof window<"u"&&J9.includes(window.location.hostname);var Ql=new R("angularfire2.auth.use-emulator"),Yl=new R("angularfire2.auth.settings"),Zl=new R("angularfire2.auth.tenant-id"),Xl=new R("angularfire2.auth.langugage-code"),Jl=new R("angularfire2.auth.use-device-language"),ed=new R("angularfire.auth.persistence"),td=(t,e,n,r,i,s,o,a)=>tu(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),vm=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Be,g=F(void 0).pipe(rn(o.outsideAngular),ke(()=>s.runOutsideAngular(()=>import("./chunk-IT5WWNU7.js"))),O(()=>io(n,s,r)),O(_=>td(_,s,a,c,l,d,u,h)),vh({bufferSize:1,refCount:!1}));if(As(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=F(null);else{g.pipe(wn()).subscribe();let _=g.pipe(ke(T=>T.getRedirectResult().then(H=>H,()=>null)),ze,vh({bufferSize:1,refCount:!1})),C=g.pipe(ke(T=>new te(H=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(z=>H.next(z),z=>H.error(z),()=>H.complete()))})))),k=g.pipe(ke(T=>new te(H=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(z=>H.next(z),z=>H.error(z),()=>H.complete()))}))));this.authState=_.pipe(_h(C),_n(o.outsideAngular),rn(o.insideAngular)),this.user=_.pipe(_h(k),_n(o.outsideAngular),rn(o.insideAngular)),this.idToken=this.user.pipe(ke(T=>T?me(T.getIdToken()):F(null))),this.idTokenResult=this.user.pipe(ke(T=>T?me(T.getIdTokenResult()):F(null))),this.credential=ko(_,p,this.authState.pipe(Ct(T=>!T))).pipe(O(T=>T?.user?T:null),_n(o.outsideAngular),rn(o.insideAngular))}return N1(this,g,s,{spy:{apply:(_,C,k)=>{(_.startsWith("signIn")||_.startsWith("createUser"))&&k.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(E(zi),E(Wi,8),E(Mt),E(ae),E(Zr),E(Ql,8),E(Yl,8),E(Zl,8),E(Xl,8),E(Jl,8),E(ed,8),E(Sn,8))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var e5="@firebase/firestore-compat",t5="0.3.28";function x0(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function kO(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function OO(){if(!ZP())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var _m=class t{constructor(e){this._delegate=e}static fromBase64String(e){return OO(),new t(Dr.fromBase64String(e))}static fromUint8Array(e){return kO(),new t(Dr.fromUint8Array(e))}toBase64(){return OO(),this._delegate.toBase64()}toUint8Array(){return kO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function D0(t){return n5(t,["next","error","complete"])}function n5(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var T0=class{enableIndexedDbPersistence(e,n){return WC(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return KC(e._delegate)}clearIndexedDbPersistence(e){return QC(e._delegate)}},wm=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Fi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Mn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){jg(this._delegate,e,n,r)}enableNetwork(){return ZC(this._delegate)}disableNetwork(){return XC(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,GC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return YC(this._delegate)}onSnapshotsInSync(e){return ED(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new fu(this,Ug(this._delegate,e))}catch(n){throw qt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Mr(this,Ja(this._delegate,e))}catch(n){throw qt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new lo(this,zC(this._delegate,e))}catch(n){throw qt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return CD(this._delegate,n=>e(new Em(this,n)))}batch(){return dt(this._delegate),new Im(new Pg(this._delegate,e=>eu(this._delegate,e)))}loadBundle(e){return JC(this._delegate,e)}namedQuery(e){return eD(this._delegate,e).then(n=>n?new lo(this,n):null)}},du=class extends za{constructor(e){super(),this.firestore=e}convertBytes(e){return new _m(new Dr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Mr.forKey(n,this.firestore,null)}};function r5(t){vC(t)}var Em=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new du(e)}get(e){let n=ao(e);return this._delegate.get(n).then(r=>new uo(this._firestore,new Nn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=ao(e);return r?(x0("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=ao(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=ao(e);return this._delegate.delete(n),this}},Im=class{constructor(e){this._delegate=e}set(e,n,r){let i=ao(e);return r?(x0("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=ao(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=ao(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},hu=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ni(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new co(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new du(e),n),i.set(n,s)),s}};hu.INSTANCES=new WeakMap;var Mr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new du(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Me(n._delegate,r,new S(e)))}static forKey(e,n,r){return new t(n,new Me(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new fu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new fu(this.firestore,Ug(this._delegate,e))}catch(n){throw qt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ce(e),e instanceof Me?Bg(this._delegate,e):!1}set(e,n){n=x0("DocumentReference.set",n);try{return n?Wg(this._delegate,e,n):Wg(this._delegate,e)}catch(r){throw qt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Kg(this._delegate,e):Kg(this._delegate,e,n,...r)}catch(i){throw qt(i,"updateDoc()","DocumentReference.update()")}}delete(){return _D(this._delegate)}onSnapshot(...e){let n=FO(e),r=VO(e,i=>new uo(this.firestore,new Nn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Qg(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=pD(this._delegate):e?.source==="server"?n=gD(this._delegate):n=fD(this._delegate),n.then(r=>new uo(this.firestore,new Nn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function qt(t,e,n){return t.message=t.message.replace(e,n),t}function FO(t){for(let e of t)if(typeof e=="object"&&!D0(e))return e;return{}}function VO(t,e){var n,r;let i;return D0(t[0])?i=t[0]:D0(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var uo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Mr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return zg(this._delegate,e._delegate)}},co=class extends uo{data(e){let n=this._delegate.data(e);return this._delegate._converter||UP(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},lo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new du(e)}where(e,n,r){try{return new t(this.firestore,Tr(this._delegate,sD(e,n,r)))}catch(i){throw qt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Tr(this._delegate,oD(e,n)))}catch(r){throw qt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Tr(this._delegate,aD(e)))}catch(n){throw qt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Tr(this._delegate,uD(e)))}catch(n){throw qt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Tr(this._delegate,cD(...e)))}catch(n){throw qt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Tr(this._delegate,lD(...e)))}catch(n){throw qt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Tr(this._delegate,dD(...e)))}catch(n){throw qt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Tr(this._delegate,hD(...e)))}catch(n){throw qt(n,"endAt()","Query.endAt()")}}isEqual(e){return $g(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=yD(this._delegate):e?.source==="server"?n=vD(this._delegate):n=mD(this._delegate),n.then(r=>new nd(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=FO(e),r=VO(e,i=>new nd(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Qg(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},b0=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new co(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},nd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new lo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new co(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new b0(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new co(this._firestore,r))})}isEqual(e){return zg(this._delegate,e._delegate)}},fu=class t extends lo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Mr(this.firestore,e):null}doc(e){try{return e===void 0?new Mr(this.firestore,Ja(this._delegate)):new Mr(this.firestore,Ja(this._delegate,e))}catch(n){throw qt(n,"doc()","CollectionReference.doc()")}}add(e){return wD(this._delegate,e).then(n=>new Mr(this.firestore,n))}isEqual(e){return Bg(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ao(t){return ge(t,Me)}var S0=class t{constructor(...e){this._delegate=new Qn(...e)}static documentId(){return new t(Xe.keyField().canonicalString())}isEqual(e){return e=ce(e),e instanceof Qn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var A0=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=TD();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=DD();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=bD(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=SD(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=AD(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var i5={Firestore:wm,GeoPoint:Xs,Timestamp:je,Blob:_m,Transaction:Em,WriteBatch:Im,DocumentReference:Mr,DocumentSnapshot:uo,Query:lo,QueryDocumentSnapshot:co,QuerySnapshot:nd,CollectionReference:fu,FieldPath:S0,FieldValue:A0,setLogLevel:r5,CACHE_SIZE_UNLIMITED:p1};function s5(t,e){t.INTERNAL.registerComponent(new nn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},i5)))}function o5(t){s5(t,(e,n)=>new wm(e,n,new T0)),t.registerVersion(e5,t5)}o5(At);function a5(t,e=fs){return new te(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function LO(t,e){return a5(t,e)}function u5(t,e){return LO(t,e).pipe(gs(void 0),Uu(),O(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function N0(t,e){return LO(t,e).pipe(O(n=>({payload:n,type:"query"})))}var Cm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=BO(r,n);return new Tm(i,s,this.afs)}snapshotChanges(){return u5(this.ref,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return this.snapshotChanges().pipe(O(({payload:n})=>e.idField?ye(b({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return me(this.ref.get(e)).pipe(ze)}};function Dm(t,e){return N0(t,e).pipe(gs(void 0),Uu(),O(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function jO(t,e,n){return Dm(t,n).pipe(nr((r,i)=>c5(r,i.map(s=>s.payload),e),[]),Lu(),O(r=>r.map(i=>({type:i.type,payload:i}))))}function c5(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=l5(t,r))}),t}function M0(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function l5(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return M0(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return M0(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return M0(t,e.oldIndex,1);break}return t}function UO(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Tm=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Dm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(O(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(gs(void 0),Uu(),Ct(([r,i])=>i.length>0||!r),O(([,r])=>r),ze)}auditTrail(e){return this.stateChanges(e).pipe(nr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=UO(e);return jO(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return N0(this.query,this.afs.schedulers.outsideAngular).pipe(O(n=>n.payload.docs.map(r=>e.idField?ye(b({},r.data()),{[e.idField]:r.id}):r.data())),ze)}get(e){return me(this.query.get(e)).pipe(ze)}add(e){return this.ref.add(e)}doc(e){return new Cm(this.ref.doc(e),this.afs)}},R0=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Dm(this.query,this.afs.schedulers.outsideAngular).pipe(ze):Dm(this.query,this.afs.schedulers.outsideAngular).pipe(O(n=>n.filter(r=>e.indexOf(r.type)>-1)),Ct(n=>n.length>0),ze)}auditTrail(e){return this.stateChanges(e).pipe(nr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=UO(e);return jO(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return N0(this.query,this.afs.schedulers.outsideAngular).pipe(O(r=>r.payload.docs.map(i=>e.idField?b({[e.idField]:i.id},i.data()):i.data())),ze)}get(e){return me(this.query.get(e)).pipe(ze)}},d5=new R("angularfire2.enableFirestorePersistence"),h5=new R("angularfire2.firestore.persistenceSettings"),f5=new R("angularfire2.firestore.settings"),p5=new R("angularfire2.firestore.use-emulator");function BO(t,e=n=>n){return{query:e(t),ref:t}}var $O=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_,C,k){this.schedulers=u;let T=io(n,a,r),H=l;d&&td(T,a,h,p,g,_,f,C),[this.firestore,this.persistenceEnabled$]=tu(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let z=a.runOutsideAngular(()=>T.firestore());if(s&&z.settings(s),H&&z.useEmulator(...H),i&&!As(o)){let Y=()=>{try{return me(z.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(De){return typeof console<"u"&&console.warn(De),F(!1)}};return[z,a.runOutsideAngular(Y)]}else return[z,F(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=BO(i,r),a=this.schedulers.ngZone.run(()=>s);return new Tm(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new R0(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Cm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(zi),E(Wi,8),E(d5,8),E(f5,8),E(Mt),E(ae),E(Zr),E(h5,8),E(p5,8),E(vm,8),E(Ql,8),E(Yl,8),E(Zl,8),E(Xl,8),E(Jl,8),E(ed,8),E(Sn,8))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var bm=(()=>{let e=class e{constructor(r){this.firestore=r}agregarEmpleado(r){return this.firestore.collection("Datos Usuarios").add(r)}getEmpleados(){return this.firestore.collection("Datos Usuarios").snapshotChanges()}eliminarEmpleado(r){return this.firestore.collection("Datos Usuarios").doc(r).delete()}};e.\u0275fac=function(i){return new(i||e)(E($O))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function m5(t,e){t&1&&(U(0,"span",16),re(1,"TODOS LOS CAMPOS SON OBLIGATORIOS"),$())}var qO=(()=>{let e=class e{constructor(r,i){this.fb=r,this.empleadoService=i,this.submitted=!1,this.crearempleado=this.fb.group({nombre:["",sa.required],email:["",sa.required],phone:["",sa.required]})}ngOnInit(){}agregarempleado(){if(this.submitted=!0,this.crearempleado.invalid)return;let r={nombre:this.crearempleado.value.nombre,email:this.crearempleado.value.email,phone:this.crearempleado.value.phone,fechaCreacion:new Date,fechaActualizacion:new Date};this.empleadoService.agregarEmpleado(r).then(()=>{let i=document.getElementById("notification-message");i&&(i.textContent="Empleado agregado correctamente",this.showNotification(),setTimeout(()=>{this.hideNotification(),this.resetForm()},4e3))}).catch(i=>{console.log(i)})}showNotification(){let r=document.getElementById("notification");r&&r.classList.add("show")}hideNotification(){let r=document.getElementById("notification");r&&(r.classList.remove("show"),r.classList.add("hide"),setTimeout(()=>{r.classList.remove("hide")},300))}resetForm(){this.crearempleado.reset(),this.submitted=!1}};e.\u0275fac=function(i){return new(i||e)(j(mR),j(bm))},e.\u0275cmp=Zt({type:e,selectors:[["app-crear-empleados"]],decls:22,vars:2,consts:[[1,"container","pt-4"],[1,"row"],[1,"col-lg-6","offset-lg-3"],[1,"card","text-center"],[1,"card-body"],["id","notification",1,"notification"],["id","notification-message"],["class","text-danger",4,"ngIf"],[1,"mt-4",3,"ngSubmit","formGroup"],[1,"col"],["type","text","formControlName","nombre","placeholder","Nombre",1,"form-control","form-control-lg"],["type","text","formControlName","email","placeholder","Email",1,"form-control","form-control-lg"],["type","number","formControlName","phone","placeholder","Telefono",1,"form-control","form-control-lg","mt-3"],[1,"mt-3"],["type","button","routerLink","/lista-empleados",1,"btn","btn-secondary","btn-lg","mr-3"],["type","submit",1,"btn","btn-dark","btn-lg"],[1,"text-danger"]],template:function(i,s){i&1&&(U(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3"),re(6,"Agregar Empleado"),$(),U(7,"div",5),Dt(8,"span",6),$(),zr(9,m5,2,0,"span",7),U(10,"form",8),ft("ngSubmit",function(){return s.agregarempleado()}),U(11,"div",1)(12,"div",9),Dt(13,"input",10),$(),U(14,"div",9),Dt(15,"input",11),$()(),Dt(16,"input",12),U(17,"div",13)(18,"button",14),re(19,"VOLVER"),$(),U(20,"button",15),re(21,"AGREGAR"),$()()()()()()()()),i&2&&(Le(9),bn("ngIf",s.submitted&&s.crearempleado.invalid),Le(),bn("formGroup",s.crearempleado))},dependencies:[ra,mm,Wf,ca,yw,Hf,qf,vw,_w],styles:[".notification[_ngcontent-%COMP%]{display:none;position:fixed;bottom:20px;right:20px;padding:15px;background-color:#4caf50;color:#fff;border-radius:5px;box-shadow:0 2px 5px #0003;transition:opacity .3s ease}.notification.show[_ngcontent-%COMP%]{display:block;opacity:1}.notification.hide[_ngcontent-%COMP%]{opacity:0}"]});let t=e;return t})();var GO="@firebase/database",zO="1.0.4";var qT="";function GT(t){qT=t}var U0=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),et(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Bd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var B0=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return yn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var CF=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new U0(e)}}catch{}return new B0},fo=CF("localStorage"),$0=CF("sessionStorage");var yu=new hi("@firebase/database"),DF=function(){let t=1;return function(){return t++}}(),TF=function(t){let e=jb(t),n=new Lb;n.update(e);let r=n.digest();return Ld.encodeByteArray(r)},bd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=bd.apply(null,r):typeof r=="object"?e+=et(r):e+=r,e+=" "}return e},po=null,WO=!0,bF=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(yu.logLevel=vn.VERBOSE,po=yu.log.bind(yu),e&&$0.set("logging_enabled",!0)):typeof t=="function"?po=t:(po=null,$0.remove("logging_enabled"))},_t=function(...t){if(WO===!0&&(WO=!1,po===null&&$0.get("logging_enabled")===!0&&bF(!0)),po){let e=bd.apply(null,t);po(e)}},Sd=function(t){return function(...e){_t(t,...e)}},H0=function(...t){let e="FIREBASE INTERNAL ERROR: "+bd(...t);yu.error(e)},Pr=function(...t){let e=`FIREBASE FATAL ERROR: ${bd(...t)}`;throw yu.error(e),new Error(e)},Ot=function(...t){let e="FIREBASE WARNING: "+bd(...t);yu.warn(e)},y5=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ot("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ey=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},v5=function(t){if(er()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ns="[MIN_NAME]",ci="[MAX_NAME]",mo=function(t,e){if(t===e)return 0;if(t===ns||e===ci)return-1;if(e===ns||t===ci)return 1;{let n=KO(t),r=KO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},_5=function(t,e){return t===e?0:t<e?-1:1},rd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+et(e))},zT=function(t){if(typeof t!="object"||t===null)return et(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=et(e[r]),n+=":",n+=zT(t[e[r]]);return n+="}",n},SF=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function wt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var AF=function(t){D(!ey(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},w5=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},E5=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function I5(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var C5=new RegExp("^-?(0*)\\d{1,10}$"),D5=-2147483648,T5=2147483647,KO=function(t){if(C5.test(t)){let e=Number(t);if(e>=D5&&e<=T5)return e}return null},bu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Ot("Exception was thrown by user callback.",n),e},Math.floor(0))}},b5=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ad=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var q0=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ot(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var G0=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ot(e)}},ud=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Am="5",xF="v",MF="s",RF="r",NF="f",PF=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kF="ls",OF="p",z0="ac",FF="websocket",VF="long_polling";var xm=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=fo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&fo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function S5(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function LF(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===FF)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===VF)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);S5(t)&&(n.ns=t.namespace);let i=[];return wt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var W0=class{constructor(){this.counters_={}}incrementCounter(e,n=1){yn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Rb(this.counters_)}};var P0={},k0={};function WT(t){let e=t.toString();return P0[e]||(P0[e]=new W0),P0[e]}function A5(t,e){let n=t.toString();return k0[n]||(k0[n]=e()),k0[n]}var K0=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&bu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var QO="start",x5="close",M5="pLPCommand",R5="pRTLPCB",jF="id",UF="pw",BF="ser",N5="cb",P5="seg",k5="ts",O5="d",F5="dframe",$F=1870,HF=30,V5=$F-HF,L5=25e3,j5=3e4,hd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Sd(e),this.stats_=WT(n),this.urlFn=u=>(this.appCheckToken&&(u[z0]=this.appCheckToken),LF(n,VF,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new K0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(j5)),v5(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Q0((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===QO)this.id=a,this.password=u;else if(o===x5)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[QO]="t",r[BF]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[N5]=this.scriptTagHolder.uniqueCallbackIdentifier),r[xF]=Am,this.transportSessionId&&(r[MF]=this.transportSessionId),this.lastSessionId&&(r[kF]=this.lastSessionId),this.applicationId&&(r[OF]=this.applicationId),this.appCheckToken&&(r[z0]=this.appCheckToken),typeof location<"u"&&location.hostname&&PF.test(location.hostname)&&(r[RF]=NF);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return er()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!w5()&&!E5()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Mb(n),i=SF(r,V5);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(er())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[F5]="t",r[jF]=e,r[UF]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Q0=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,er())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=DF(),window[M5+this.uniqueCallbackIdentifier]=e,window[R5+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){_t("frame writing exception"),a.stack&&_t(a.stack),_t(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[jF]=this.myID,e[UF]=this.myPW,e[BF]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+HF+r.length<=$F;){let o=this.pendingSegs.shift();r=r+"&"+P5+i+"="+o.seg+"&"+k5+i+"="+o.ts+"&"+O5+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(L5)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){er()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var U5=16384,B5=45e3,Mm=null;typeof MozWebSocket<"u"?Mm=MozWebSocket:typeof WebSocket<"u"&&(Mm=WebSocket);var gu=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Sd(this.connId),this.stats_=WT(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[xF]=Am,!er()&&typeof location<"u"&&location.hostname&&PF.test(location.hostname)&&(a[RF]=NF),r&&(a[MF]=r),i&&(a[kF]=i),s&&(a[z0]=s),o&&(a[OF]=o),LF(n,FF,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,fo.set("previous_websocket_failure",!0);try{let i;if(er()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Am}/${qT}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Mm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Mm!==null&&!t.forceDisallow_}static previouslyFailed(){return fo.isInMemoryStorage||fo.get("previous_websocket_failure")===!0}markConnectionHealthy(){fo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Bd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=et(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=SF(r,U5);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(B5))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),qF=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[hd,gu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=gu&&gu.isAvailable(),i=r&&!gu.previouslyFailed();if(n.webSocketOnly&&(r||Ot("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[gu];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),$5=6e4,H5=5e3,q5=10*1024,G5=100*1024,O0="t",YO="d",z5="s",ZO="r",W5="e",XO="o",JO="a",eF="n",tF="p",K5="h",Y0=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Sd("c:"+this.id+":"),this.transportManager_=new qF(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ad(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>G5?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>q5?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(O0 in e){let n=e[O0];n===JO?this.upgradeIfSecondaryHealthy_():n===ZO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===XO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=rd("t",e),r=rd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:tF,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:JO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:eF,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=rd("t",e),r=rd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=rd(O0,e);if(YO in e){let r=e[YO];if(n===K5){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===eF){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===z5?this.onConnectionShutdown_(r):n===ZO?this.onReset_(r):n===W5?H0("Server Error: "+r):n===XO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):H0("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Am!==r&&Ot("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ad(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor($5))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ad(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(H5))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:tF,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(fo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Rm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Nm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Pm=class t extends Nm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Cy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var nF=32,rF=768,_e=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new _e("")}function ie(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function rs(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new _e(t.pieces_,e)}function KT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Q5(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function fd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function GF(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new _e(e,0)}function Ve(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof _e)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new _e(n,0)}function se(t){return t.pieceNum_>=t.pieces_.length}function Gt(t,e){let n=ie(t),r=ie(e);if(n===null)return e;if(n===r)return Gt(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Y5(t,e){let n=fd(t,0),r=fd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=mo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function QT(t,e){if(rs(t)!==rs(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function kn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(rs(t)>rs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Z0=class{constructor(e,n){this.errorPrefix_=n,this.parts_=fd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Pu(this.parts_[r]);zF(this)}};function Z5(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Pu(e),zF(t)}function X5(t){let e=t.parts_.pop();t.byteLength_-=Pu(e),t.parts_.length>0&&(t.byteLength_-=1)}function zF(t){if(t.byteLength_>rF)throw new Error(t.errorPrefix_+"has a key path longer than "+rF+" bytes ("+t.byteLength_+").");if(t.parts_.length>nF)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+nF+") or object contains a cycle "+ho(t))}function ho(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var X0=class t extends Nm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var id=1e3,J5=60*5*1e3,iF=30*1e3,e6=1.3,t6=3e4,n6="server_kill",sF=3,YT=(()=>{class t extends Rm{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Sd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=id,this.maxReconnectDelay_=J5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!er())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");X0.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Pm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(et(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new ht,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&yn(n,"w")){let i=di(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ot(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Fb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=iF)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Ob(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+et(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):H0("Unrecognized action received from server: "+et(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=id,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=id,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>t6&&(this.reconnectDelay_=id),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*e6)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){D(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new Y0(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Ot(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(n6)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Ot(h),c())}}})}interrupt(n){_t("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){_t("Resuming connection for reason: "+n),delete this.interruptReasons_[n],$d(this.interruptReasons_)&&(this.reconnectDelay_=id,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>zT(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new _e(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){_t("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=sF&&(this.reconnectDelay_=iF,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){_t("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=sF&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";er()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+qT.replace(/\./g,"-")]=1,Cy()?n["framework.cordova"]=1:Nb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Pm.getInstance().currentlyOnline();return $d(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ue=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var vu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ue(ns,e),i=new ue(ns,n);return this.compare(r,i)!==0}minPost(){return ue.MIN}};var Sm,km=class extends vu{static get __EMPTY_NODE(){return Sm}static set __EMPTY_NODE(e){Sm=e}compare(e,n){return mo(e.name,n.name)}isDefinedOn(e){throw Eo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ue.MIN}maxPost(){return new ue(ci,Sm)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ue(e,Sm)}toString(){return".key"}},Nr=new km;var mu=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Xn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??On.EMPTY_NODE,this.right=o??On.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return On.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return On.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),J0=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Xn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},On=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Xn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Xn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new mu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new mu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new mu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new mu(this.root_,null,this.comparator_,!0,e)}};On.EMPTY_NODE=new J0;function r6(t,e){return mo(t.name,e.name)}function ZT(t,e){return mo(t,e)}var eT;function i6(t){eT=t}var WF=function(t){return typeof t=="number"?"number:"+AF(t):"string:"+t},KF=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&yn(e,".sv"),"Priority must be a string or number.")}else D(t===eT||t.isEmpty(),"priority of unexpected type.");D(t===eT||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var oF,_u=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),KF(this.priorityNode_)}static set __childrenNodeConstructor(n){oF=n}static get __childrenNodeConstructor(){return oF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return se(n)?this:ie(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ie(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||rs(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+WF(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=AF(this.value_):n+=this.value_,this.lazyHash_=TF(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),QF,YF;function s6(t){QF=t}function o6(t){YF=t}var tT=class extends vu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?mo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ue.MIN}maxPost(){return new ue(ci,new _u("[PRIORITY-POST]",YF))}makePost(e,n){let r=QF(e);return new ue(n,new _u("[PRIORITY-POST]",r))}toString(){return".priority"}},Re=new tT;var a6=Math.log(2),nT=class{constructor(e){let n=s=>parseInt(Math.log(s)/a6,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Om=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Xn(h,d.node,Xn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Xn(h,d.node,Xn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let _=d-p,C=d;d-=p;let k=i(_+1,C),T=t[_],H=n?n(T):T;f(new Xn(H,T.node,g,null,k))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),_=Math.pow(2,u.count-(p+1));g?h(_,Xn.BLACK):(h(_,Xn.BLACK),h(_,Xn.RED))}return l},o=new nT(t.length),a=s(o);return new On(r||e,a)};var F0,pu={},wu=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(pu&&Re,"ChildrenNode.ts has not been loaded"),F0=F0||new t({".priority":pu},{".priority":Re}),F0}get(e){let n=di(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof On?n:null}hasIndex(e){return yn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Nr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ue.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Om(r,e.getCompare()):a=pu;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=Nu(this.indexes_,(i,s)=>{let o=di(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===pu)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(ue.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Om(a,o.getCompare())}else return pu;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new ue(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Nu(this.indexes_,i=>{if(i===pu)return i;{let s=n.get(e.name);return s?i.remove(new ue(e.name,s)):i}});return new t(r,this.indexSet_)}};var sd,J=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&KF(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return sd||(sd=new t(new On(ZT),null,wu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||sd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?sd:r}}getChild(n){let r=ie(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ue(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?sd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ie(n);if(i===null)return r;{D(ie(n)!==".priority"||rs(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Re,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+WF(this.getPriority().val())+":"),this.forEachChild(Re,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":TF(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ue(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ue(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ue(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ad?-1:0}withIndex(n){if(n===Nr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Nr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Re),s=r.getIterator(Re),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Nr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),rT=class extends J{constructor(){super(new On(ZT),J.EMPTY_NODE,wu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return J.EMPTY_NODE}isEmpty(){return!1}},Ad=new rT;Object.defineProperties(ue,{MIN:{value:new ue(ns,J.EMPTY_NODE)},MAX:{value:new ue(ci,Ad)}});km.__EMPTY_NODE=J.EMPTY_NODE;_u.__childrenNodeConstructor=J;i6(Ad);o6(Ad);var u6=!0;function Ue(t,e=null){if(t===null)return J.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new _u(n,Ue(e))}if(!(t instanceof Array)&&u6){let n=[],r=!1;if(wt(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ue(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new ue(o,u)))}}),n.length===0)return J.EMPTY_NODE;let s=Om(n,r6,o=>o.name,ZT);if(r){let o=Om(n,Re.getCompare());return new J(s,Ue(e),new wu({".priority":o},{".priority":Re}))}else return new J(s,Ue(e),wu.Default)}else{let n=J.EMPTY_NODE;return wt(t,(r,i)=>{if(yn(t,r)&&r.substring(0,1)!=="."){let s=Ue(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ue(e))}}s6(Ue);var pd=class extends vu{constructor(e){super(),this.indexPath_=e,D(!se(e)&&ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?mo(e.name,n.name):s}makePost(e,n){let r=Ue(e),i=J.EMPTY_NODE.updateChild(this.indexPath_,r);return new ue(n,i)}maxPost(){let e=J.EMPTY_NODE.updateChild(this.indexPath_,Ad);return new ue(ci,e)}toString(){return fd(this.indexPath_,0).join("/")}};var iT=class extends vu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?mo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ue.MIN}maxPost(){return ue.MAX}makePost(e,n){let r=Ue(e);return new ue(n,r)}toString(){return".value"}},XT=new iT;function ZF(t){return{type:"value",snapshotNode:t}}function Eu(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function gd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function md(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function c6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var yd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(gd(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Eu(n,r)):o.trackChildChange(md(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Re,(i,s)=>{n.hasChild(i)||r.trackChildChange(gd(i,s))}),n.isLeafNode()||n.forEachChild(Re,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(md(i,s,o))}else r.trackChildChange(Eu(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?J.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Fm=class t{constructor(e){this.indexedFilter_=new yd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ue(n,r))||(r=J.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=J.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(J.EMPTY_NODE);let s=this;return n.forEachChild(Re,(o,a)=>{s.matches(new ue(o,a))||(i=i.updateImmediateChild(o,J.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var sT=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Fm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ue(n,r))||(r=J.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=J.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=J.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(J.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,J.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let u=new ue(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(md(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(gd(n,d));let g=a.updateImmediateChild(n,J.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Eu(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(gd(c.name,c.node)),s.trackChildChange(Eu(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,J.EMPTY_NODE)):e}};var vd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Re}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ns}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ci}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Re}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function l6(t){return t.loadsAllData()?new yd(t.getIndex()):t.hasLimit()?new sT(t):new Fm(t)}function d6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function h6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function oT(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function f6(t,e,n){let r;return t.index_===Nr||n?r=oT(t,e,n):r=oT(t,e,ci),r.startAfterSet_=!0,r}function aT(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function p6(t,e,n){let r;return t.index_===Nr||n?r=aT(t,e,n):r=aT(t,e,ns),r.endBeforeSet_=!0,r}function ty(t,e){let n=t.copy();return n.index_=e,n}function aF(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Re?n="$priority":t.index_===XT?n="$value":t.index_===Nr?n="$key":(D(t.index_ instanceof pd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=et(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+et(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function uF(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Re&&(e.i=t.index_.toString()),e}var uT=class t extends Rm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Sd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=aF(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),di(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=aF(e._queryParams),r=e._path.toString(),i=new ht;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Vb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Bd(a.responseText)}catch{Ot("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Ot("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var cT=class{constructor(){this.rootNode_=J.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Vm(){return{value:null,children:new Map}}function Su(t,e,n){if(se(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ie(e);t.children.has(r)||t.children.set(r,Vm());let i=t.children.get(r);e=Ae(e),Su(i,e,n)}}function lT(t,e){if(se(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Re,(r,i)=>{Su(t,new _e(r),i)}),lT(t,e)}}else if(t.children.size>0){let n=ie(e);return e=Ae(e),t.children.has(n)&&lT(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function dT(t,e,n){t.value!==null?n(e,t.value):g6(t,(r,i)=>{let s=new _e(e.toString()+"/"+r);dT(i,s,n)})}function g6(t,e){t.children.forEach((n,r)=>{e(r,n)})}var hT=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&wt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var cF=10*1e3,m6=30*1e3,y6=5*60*1e3,fT=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new hT(e);let r=cF+(m6-cF)*Math.random();ad(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;wt(e,(i,s)=>{s>0&&yn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),ad(this.reportStats_.bind(this),Math.floor(Math.random()*2*y6))}};var Rr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Rr||{});function JT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function eb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tb(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var pT=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Rr.ACK_USER_WRITE,this.source=JT()}operationForChild(e){if(se(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new _e(e));return new t(ve(),n,this.revert)}}else return D(ie(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var Lm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Rr.LISTEN_COMPLETE}operationForChild(e){return se(this.path)?new t(this.source,ve()):new t(this.source,Ae(this.path))}};var Iu=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Rr.OVERWRITE}operationForChild(e){return se(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var _d=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Rr.MERGE}operationForChild(e){if(se(this.path)){let n=this.children.subtree(new _e(e));return n.isEmpty()?null:n.value?new Iu(this.source,ve(),n.value):new t(this.source,ve(),n)}else return D(ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var kr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(se(e))return this.isFullyInitialized()&&!this.filtered_;let n=ie(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var gT=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function v6(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(c6(o.childName,o.snapshotNode))}),od(t,i,"child_removed",e,r,n),od(t,i,"child_added",e,r,n),od(t,i,"child_moved",s,r,n),od(t,i,"child_changed",e,r,n),od(t,i,"value",e,r,n),i}function od(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>w6(t,a,u)),o.forEach(a=>{let u=_6(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function _6(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function w6(t,e,n){if(e.childName==null||n.childName==null)throw Eo("Should only compare child_ events.");let r=new ue(e.childName,e.snapshotNode),i=new ue(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function ny(t,e){return{eventCache:t,serverCache:e}}function cd(t,e,n,r){return ny(new kr(e,n,r),t.serverCache)}function XF(t,e,n,r){return ny(t.eventCache,new kr(e,n,r))}function jm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function go(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var V0,E6=()=>(V0||(V0=new On(_5)),V0),zt=class t{constructor(e,n=E6()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return wt(e,(r,i)=>{n=n.set(new _e(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(se(e))return null;{let r=ie(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:Ve(new _e(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(se(e))return this;{let n=ie(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(se(e))return new t(n,this.children);{let r=ie(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(se(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ie(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(se(e))return this.value;{let n=ie(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(se(e))return n;{let r=ie(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ve(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(se(e))return null;{let s=ie(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),Ve(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(se(e))return this;{this.value&&r(n,this.value);let i=ie(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),Ve(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ve(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Jn=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new zt(null))}};function ld(t,e,n){if(se(e))return new Jn(new zt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Gt(i,e);return s=s.updateChild(o,n),new Jn(t.writeTree_.set(i,s))}else{let i=new zt(n),s=t.writeTree_.setTree(e,i);return new Jn(s)}}}function mT(t,e,n){let r=t;return wt(n,(i,s)=>{r=ld(r,Ve(e,i),s)}),r}function lF(t,e){if(se(e))return Jn.empty();{let n=t.writeTree_.setTree(e,new zt(null));return new Jn(n)}}function yT(t,e){return yo(t,e)!=null}function yo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Gt(n.path,e)):null}function dF(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Re,(r,i)=>{e.push(new ue(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ue(r,i.value))}),e}function es(t,e){if(se(e))return t;{let n=yo(t,e);return n!=null?new Jn(new zt(n)):new Jn(t.writeTree_.subtree(e))}}function vT(t){return t.writeTree_.isEmpty()}function Cu(t,e){return JF(ve(),t.writeTree_,e)}function JF(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=JF(Ve(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ve(t,".priority"),r)),n}}function ry(t,e){return rV(e,t)}function I6(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=ld(t.visibleWrites,e,n)),t.lastWriteId=r}function C6(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=mT(t.visibleWrites,e,n),t.lastWriteId=r}function D6(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function T6(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&b6(a,r.path)?i=!1:kn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return S6(t),!0;if(r.snap)t.visibleWrites=lF(t.visibleWrites,r.path);else{let a=r.children;wt(a,u=>{t.visibleWrites=lF(t.visibleWrites,Ve(r.path,u))})}return!0}else return!1}function b6(t,e){if(t.snap)return kn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&kn(Ve(t.path,n),e))return!0;return!1}function S6(t){t.visibleWrites=eV(t.allWrites,A6,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function A6(t){return t.visible}function eV(t,e,n){let r=Jn.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)kn(n,o)?(a=Gt(n,o),r=ld(r,a,s.snap)):kn(o,n)&&(a=Gt(o,n),r=ld(r,ve(),s.snap.getChild(a)));else if(s.children){if(kn(n,o))a=Gt(n,o),r=mT(r,a,s.children);else if(kn(o,n))if(a=Gt(o,n),se(a))r=mT(r,ve(),s.children);else{let u=di(s.children,ie(a));if(u){let c=u.getChild(Ae(a));r=ld(r,ve(),c)}}}else throw Eo("WriteRecord should have .snap or .children")}}return r}function tV(t,e,n,r,i){if(!r&&!i){let s=yo(t.visibleWrites,e);if(s!=null)return s;{let o=es(t.visibleWrites,e);if(vT(o))return n;if(n==null&&!yT(o,ve()))return null;{let a=n||J.EMPTY_NODE;return Cu(o,a)}}}else{let s=es(t.visibleWrites,e);if(!i&&vT(s))return n;if(!i&&n==null&&!yT(s,ve()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(kn(c.path,e)||kn(e,c.path))},a=eV(t.allWrites,o,e),u=n||J.EMPTY_NODE;return Cu(a,u)}}}function x6(t,e,n){let r=J.EMPTY_NODE,i=yo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Re,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=es(t.visibleWrites,e);return n.forEachChild(Re,(o,a)=>{let u=Cu(es(s,new _e(o)),a);r=r.updateImmediateChild(o,u)}),dF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=es(t.visibleWrites,e);return dF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function M6(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ve(e,n);if(yT(t.visibleWrites,s))return null;{let o=es(t.visibleWrites,s);return vT(o)?i.getChild(n):Cu(o,i.getChild(n))}}function R6(t,e,n,r){let i=Ve(e,n),s=yo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=es(t.visibleWrites,i);return Cu(o,r.getNode().getImmediateChild(n))}else return null}function N6(t,e){return yo(t.visibleWrites,e)}function P6(t,e,n,r,i,s,o){let a,u=es(t.visibleWrites,e),c=yo(u,ve());if(c!=null)a=c;else if(n!=null)a=Cu(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function k6(){return{visibleWrites:Jn.empty(),allWrites:[],lastWriteId:-1}}function Um(t,e,n,r){return tV(t.writeTree,t.treePath,e,n,r)}function nb(t,e){return x6(t.writeTree,t.treePath,e)}function hF(t,e,n,r){return M6(t.writeTree,t.treePath,e,n,r)}function Bm(t,e){return N6(t.writeTree,Ve(t.treePath,e))}function O6(t,e,n,r,i,s){return P6(t.writeTree,t.treePath,e,n,r,i,s)}function rb(t,e,n){return R6(t.writeTree,t.treePath,e,n)}function nV(t,e){return rV(Ve(t.treePath,e),t.writeTree)}function rV(t,e){return{treePath:t,writeTree:e}}var _T=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,md(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,gd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Eu(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,md(r,e.snapshotNode,i.oldSnap));else throw Eo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var wT=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},iV=new wT,wd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new kr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rb(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:go(this.viewCache_),s=O6(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function F6(t){return{filter:t}}function V6(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function L6(t,e,n,r,i){let s=new _T,o,a;if(n.type===Rr.OVERWRITE){let c=n;c.source.fromUser?o=ET(t,e,c.path,c.snap,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!se(c.path),o=$m(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Rr.MERGE){let c=n;c.source.fromUser?o=U6(t,e,c.path,c.children,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=IT(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Rr.ACK_USER_WRITE){let c=n;c.revert?o=H6(t,e,c.path,r,i,s):o=B6(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Rr.LISTEN_COMPLETE)o=$6(t,e,n.path,r,s);else throw Eo("Unknown operation type: "+n.type);let u=s.getChanges();return j6(e,o,u),{viewCache:o,changes:u}}function j6(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=jm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(ZF(jm(e)))}}function sV(t,e,n,r,i,s){let o=e.eventCache;if(Bm(r,n)!=null)return e;{let a,u;if(se(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=go(e),l=c instanceof J?c:J.EMPTY_NODE,d=nb(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=Um(r,go(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ie(n);if(c===".priority"){D(rs(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=hF(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ae(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=hF(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=rb(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return cd(e,a,o.isFullyInitialized()||se(n),t.filter.filtersNodes())}}function $m(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(se(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ie(n);if(!u.isCompleteForPath(n)&&rs(n)>1)return e;let p=Ae(n),_=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),_):c=l.updateChild(u.getNode(),f,_,p,iV,null)}let d=XF(e,c,u.isFullyInitialized()||se(n),l.filtersNodes()),h=new wd(i,d,s);return sV(t,d,n,i,h,a)}function ET(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new wd(i,e,s);if(se(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=cd(e,c,!0,t.filter.filtersNodes());else{let d=ie(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=cd(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(se(h))p=r;else{let g=l.getCompleteChild(d);g!=null?KT(h)===".priority"&&g.getChild(GF(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=J.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=cd(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function fF(t,e){return t.eventCache.isCompleteForChild(e)}function U6(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=Ve(n,u);fF(e,ie(l))&&(a=ET(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=Ve(n,u);fF(e,ie(l))||(a=ET(t,a,l,c,i,s,o))}),a}function pF(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function IT(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;se(n)?c=r:c=new zt(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=pF(t,f,h);u=$m(t,u,new _e(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=pF(t,p,h);u=$m(t,u,new _e(d),g,i,s,o,a)}}),u}function B6(t,e,n,r,i,s,o){if(Bm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(se(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return $m(t,e,n,u.getNode().getChild(n),i,s,a,o);if(se(n)){let c=new zt(null);return u.getNode().forEachChild(Nr,(l,d)=>{c=c.set(new _e(l),d)}),IT(t,e,n,c,i,s,a,o)}else return e}else{let c=new zt(null);return r.foreach((l,d)=>{let h=Ve(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),IT(t,e,n,c,i,s,a,o)}}function $6(t,e,n,r,i){let s=e.serverCache,o=XF(e,s.getNode(),s.isFullyInitialized()||se(n),s.isFiltered());return sV(t,o,n,r,iV,i)}function H6(t,e,n,r,i,s){let o;if(Bm(r,n)!=null)return e;{let a=new wd(r,e,i),u=e.eventCache.getNode(),c;if(se(n)||ie(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=Um(r,go(e));else{let d=e.serverCache.getNode();D(d instanceof J,"serverChildren would be complete if leaf node"),l=nb(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ie(n),d=rb(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Ae(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,J.EMPTY_NODE,Ae(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Um(r,go(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Bm(r,ve())!=null,cd(e,c,o,t.filter.filtersNodes())}}var CT=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new yd(r.getIndex()),s=l6(r);this.processor_=F6(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(J.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(J.EMPTY_NODE,a.getNode(),null),l=new kr(u,o.isFullyInitialized(),i.filtersNodes()),d=new kr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ny(d,l),this.eventGenerator_=new gT(this.query_)}get query(){return this.query_}};function q6(t){return t.viewCache_.serverCache.getNode()}function G6(t){return jm(t.viewCache_)}function z6(t,e){let n=go(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!se(e)&&!n.getImmediateChild(ie(e)).isEmpty())?n.getChild(e):null}function gF(t){return t.eventRegistrations_.length===0}function W6(t,e){t.eventRegistrations_.push(e)}function mF(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function yF(t,e,n,r){e.type===Rr.MERGE&&e.source.queryId!==null&&(D(go(t.viewCache_),"We should always have a full cache before handling merges"),D(jm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=L6(t.processor_,i,e,n,r);return V6(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,oV(t,s.changes,s.viewCache.eventCache.getNode(),null)}function K6(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Re,(s,o)=>{r.push(Eu(s,o))}),n.isFullyInitialized()&&r.push(ZF(n.getNode())),oV(t,r,n.getNode(),e)}function oV(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return v6(t.eventGenerator_,e,n,i)}var Hm,qm=class{constructor(){this.views=new Map}};function Q6(t){D(!Hm,"__referenceConstructor has already been defined"),Hm=t}function Y6(){return D(Hm,"Reference.ts has not been loaded"),Hm}function Z6(t){return t.views.size===0}function ib(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),yF(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(yF(o,e,n,r));return s}}function aV(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Um(n,i?r:null),u=!1;a?u=!0:r instanceof J?(a=nb(n,r),u=!1):(a=J.EMPTY_NODE,u=!1);let c=ny(new kr(a,u,!1),new kr(r,i,!1));return new CT(e,c)}return o}function X6(t,e,n,r,i,s){let o=aV(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),W6(o,n),K6(o,n)}function J6(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=is(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(mF(c,n,r)),gF(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(mF(u,n,r)),gF(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!is(t)&&s.push(new(Y6())(e._repo,e._path)),{removed:s,events:o}}function uV(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ts(t,e){let n=null;for(let r of t.views.values())n=n||z6(r,e);return n}function cV(t,e){if(e._queryParams.loadsAllData())return iy(t);{let r=e._queryIdentifier;return t.views.get(r)}}function lV(t,e){return cV(t,e)!=null}function is(t){return iy(t)!=null}function iy(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Gm;function e8(t){D(!Gm,"__referenceConstructor has already been defined"),Gm=t}function t8(){return D(Gm,"Reference.ts has not been loaded"),Gm}var n8=1,zm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new zt(null),this.pendingWriteTree_=k6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function sb(t,e,n,r,i){return I6(t.pendingWriteTree_,e,n,r,i),i?Au(t,new Iu(JT(),e,n)):[]}function r8(t,e,n,r){C6(t.pendingWriteTree_,e,n,r);let i=zt.fromObject(n);return Au(t,new _d(JT(),e,i))}function Ji(t,e,n=!1){let r=D6(t.pendingWriteTree_,e);if(T6(t.pendingWriteTree_,e)){let s=new zt(null);return r.snap!=null?s=s.set(ve(),!0):wt(r.children,o=>{s=s.set(new _e(o),!0)}),Au(t,new pT(r.path,s,n))}else return[]}function xd(t,e,n){return Au(t,new Iu(eb(),e,n))}function i8(t,e,n){let r=zt.fromObject(n);return Au(t,new _d(eb(),e,r))}function s8(t,e){return Au(t,new Lm(eb(),e))}function o8(t,e,n){let r=ob(t,n);if(r){let i=ab(r),s=i.path,o=i.queryId,a=Gt(s,e),u=new Lm(tb(o),a);return ub(t,s,u)}else return[]}function Wm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||lV(o,e))){let u=J6(o,e,n,r);Z6(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>is(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=c8(h);for(let p=0;p<f.length;++p){let g=f[p],_=g.query,C=pV(t,g);t.listenProvider_.startListening(dd(_),Ed(t,_),C.hashFn,C.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(dd(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(oy(h));t.listenProvider_.stopListening(dd(h),f)}))}l8(t,c)}return a}function dV(t,e,n,r){let i=ob(t,r);if(i!=null){let s=ab(i),o=s.path,a=s.queryId,u=Gt(o,e),c=new Iu(tb(a),u,n);return ub(t,o,c)}else return[]}function a8(t,e,n,r){let i=ob(t,r);if(i){let s=ab(i),o=s.path,a=s.queryId,u=Gt(o,e),c=zt.fromObject(n),l=new _d(tb(a),u,c);return ub(t,o,l)}else return[]}function DT(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Gt(h,i);s=s||ts(f,p),o=o||is(f)});let a=t.syncPointTree_.get(i);a?(o=o||is(a),s=s||ts(a,ve())):(a=new qm,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=J.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=ts(p,ve());g&&(s=s.updateImmediateChild(f,g))}));let c=lV(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=oy(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=d8();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=ry(t.pendingWriteTree_,i),d=X6(a,e,n,l,s,u);if(!c&&!o&&!r){let h=cV(a,e);d=d.concat(h8(t,e,h))}return d}function sy(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=Gt(o,e),c=ts(a,u);if(c)return c});return tV(i,e,s,n,!0)}function u8(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=Gt(c,n);r=r||ts(l,d)});let i=t.syncPointTree_.get(n);i?r=r||ts(i,ve()):(i=new qm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new kr(r,!0,!1):null,a=ry(t.pendingWriteTree_,e._path),u=aV(i,e,a,s?o.getNode():J.EMPTY_NODE,s);return G6(u)}function Au(t,e){return hV(e,t.syncPointTree_,null,ry(t.pendingWriteTree_,ve()))}function hV(t,e,n,r){if(se(t.path))return fV(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=ts(i,ve()));let s=[],o=ie(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=nV(r,o);s=s.concat(hV(a,u,c,l))}return i&&(s=s.concat(ib(i,t,r,n))),s}}function fV(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=ts(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=nV(r,o),l=t.operationForChild(o);l&&(s=s.concat(fV(l,a,u,c)))}),i&&(s=s.concat(ib(i,t,r,n))),s}function pV(t,e){let n=e.query,r=Ed(t,n);return{hashFn:()=>(q6(e)||J.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?o8(t,n._path,r):s8(t,n._path);{let s=I5(i,n);return Wm(t,n,null,s)}}}}function Ed(t,e){let n=oy(e);return t.queryToTagMap.get(n)}function oy(t){return t._path.toString()+"$"+t._queryIdentifier}function ob(t,e){return t.tagToQueryMap.get(e)}function ab(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new _e(t.substr(0,e))}}function ub(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=ry(t.pendingWriteTree_,e);return ib(r,n,i,null)}function c8(t){return t.fold((e,n,r)=>{if(n&&is(n))return[iy(n)];{let i=[];return n&&(i=uV(n)),wt(r,(s,o)=>{i=i.concat(o)}),i}})}function dd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(t8())(t._repo,t._path):t}function l8(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=oy(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function d8(){return n8++}function h8(t,e,n){let r=e._path,i=Ed(t,e),s=pV(t,n),o=t.listenProvider_.startListening(dd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!is(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!se(c)&&l&&is(l))return[iy(l).query];{let h=[];return l&&(h=h.concat(uV(l).map(f=>f.query))),wt(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(dd(l),Ed(t,l))}}return o}var TT=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},bT=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Ve(this.path_,e);return new t(this.syncTree_,n)}node(){return sy(this.syncTree_,this.path_)}},f8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},vF=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return p8(t[".sv"],e,n);if(typeof t[".sv"]=="object")return g8(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},p8=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},g8=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},gV=function(t,e,n,r){return lb(e,new bT(n,t),r)},cb=function(t,e,n){return lb(t,new TT(e),n)};function lb(t,e,n){let r=t.getPriority().val(),i=vF(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=vF(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new _u(a,Ue(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new _u(i))),o.forEachChild(Re,(a,u)=>{let c=lb(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var Id=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function ay(t,e){let n=e instanceof _e?e:new _e(e),r=t,i=ie(n);for(;i!==null;){let s=di(r.node.children,i)||{children:{},childCount:0};r=new Id(i,r,s),n=Ae(n),i=ie(n)}return r}function vo(t){return t.node.value}function db(t,e){t.node.value=e,ST(t)}function mV(t){return t.node.childCount>0}function m8(t){return vo(t)===void 0&&!mV(t)}function uy(t,e){wt(t.node.children,(n,r)=>{e(new Id(n,t,r))})}function yV(t,e,n,r){n&&!r&&e(t),uy(t,i=>{yV(i,e,!0,r)}),n&&r&&e(t)}function y8(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Md(t){return new _e(t.parent===null?t.name:Md(t.parent)+"/"+t.name)}function ST(t){t.parent!==null&&v8(t.parent,t.name,t)}function v8(t,e,n){let r=m8(n),i=yn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ST(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ST(t))}var _8=/[\[\].#$\/\u0000-\u001F\u007F]/,w8=/[\[\].#$\u0000-\u001F\u007F]/,L0=10*1024*1024,cy=function(t){return typeof t=="string"&&t.length!==0&&!_8.test(t)},vV=function(t){return typeof t=="string"&&t.length!==0&&!w8.test(t)},E8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),vV(t)},Cd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ey(t)||t&&typeof t=="object"&&yn(t,".sv")},Or=function(t,e,n,r){r&&e===void 0||Rd(Qt(t,"value"),e,n)},Rd=function(t,e,n){let r=n instanceof _e?new Z0(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ho(r));if(typeof e=="function")throw new Error(t+"contains a function "+ho(r)+" with contents = "+e.toString());if(ey(e))throw new Error(t+"contains "+e.toString()+" "+ho(r));if(typeof e=="string"&&e.length>L0/3&&Pu(e)>L0)throw new Error(t+"contains a string greater than "+L0+" utf8 bytes "+ho(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(wt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!cy(o)))throw new Error(t+" contains an invalid key ("+o+") "+ho(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Z5(r,o),Rd(t,a,r),X5(r)}),i&&s)throw new Error(t+' contains ".value" child '+ho(r)+" in addition to actual children.")}},I8=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=fd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!cy(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Y5);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&kn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},_V=function(t,e,n,r){if(r&&e===void 0)return;let i=Qt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];wt(e,(o,a)=>{let u=new _e(o);if(Rd(i,a,Ve(n,u)),KT(u)===".priority"&&!Cd(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),I8(i,s)},hb=function(t,e,n){if(!(n&&e===void 0)){if(ey(e))throw new Error(Qt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Cd(e))throw new Error(Qt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Nd=function(t,e,n,r){if(!(r&&n===void 0)&&!cy(n))throw new Error(Qt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},xu=function(t,e,n,r){if(!(r&&n===void 0)&&!vV(n))throw new Error(Qt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},C8=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),xu(t,e,n,r)},fn=function(t,e){if(ie(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},wV=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!cy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!E8(n))throw new Error(Qt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var AT=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function ly(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!QT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function EV(t,e,n){ly(t,n),IV(t,r=>QT(r,e))}function pn(t,e,n){ly(t,n),IV(t,r=>kn(r,e)||kn(e,r))}function IV(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(D8(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function D8(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();po&&_t("event: "+n.toString()),bu(r)}}}var CV="repo_interrupt",T8=25,xT=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new AT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Vm(),this.transactionQueueTree_=new Id,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function b8(t,e,n){if(t.stats_=WT(t.repoInfo_),t.forceRestClient_||b5())t.server_=new uT(t.repoInfo_,(r,i,s,o)=>{_F(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>wF(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new YT(t.repoInfo_,e,(r,i,s,o)=>{_F(t,r,i,s,o)},r=>{wF(t,r)},r=>{S8(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=A5(t.repoInfo_,()=>new fT(t.stats_,t.server_)),t.infoData_=new cT,t.infoSyncTree_=new zm({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=xd(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),fb(t,"connected",!1),t.serverSyncTree_=new zm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);pn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function DV(t){let n=t.infoData_.getNode(new _e(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Pd(t){return f8({timestamp:DV(t)})}function _F(t,e,n,r,i){t.dataUpdateCount++;let s=new _e(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=Nu(n,c=>Ue(c));o=a8(t.serverSyncTree_,s,u,i)}else{let u=Ue(n);o=dV(t.serverSyncTree_,s,u,i)}else if(r){let u=Nu(n,c=>Ue(c));o=i8(t.serverSyncTree_,s,u)}else{let u=Ue(n);o=xd(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Du(t,s)),pn(t.eventQueue_,a,o)}function wF(t,e){fb(t,"connected",e),e===!1&&M8(t)}function S8(t,e){wt(e,(n,r)=>{fb(t,n,r)})}function fb(t,e,n){let r=new _e("/.info/"+e),i=Ue(n);t.infoData_.updateSnapshot(r,i);let s=xd(t.infoSyncTree_,r,i);pn(t.eventQueue_,r,s)}function dy(t){return t.nextWriteId_++}function A8(t,e,n){let r=u8(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ue(i).withIndex(e._queryParams.getIndex());DT(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=xd(t.serverSyncTree_,e._path,s);else{let a=Ed(t.serverSyncTree_,e);o=dV(t.serverSyncTree_,e._path,s,a)}return pn(t.eventQueue_,e._path,o),Wm(t.serverSyncTree_,e,n,null,!0),s},i=>(Mu(t,"get for query "+et(e)+" failed: "+i),Promise.reject(new Error(i))))}function pb(t,e,n,r,i){Mu(t,"set",{path:e.toString(),value:n,priority:r});let s=Pd(t),o=Ue(n,r),a=sy(t.serverSyncTree_,e),u=cb(o,a,s),c=dy(t),l=sb(t.serverSyncTree_,e,u,c,!0);ly(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Ot("set at "+e+" failed: "+h);let g=Ji(t.serverSyncTree_,c,!p);pn(t.eventQueue_,e,g),ss(t,i,h,f)});let d=mb(t,e);Du(t,d),pn(t.eventQueue_,d,[])}function x8(t,e,n,r){Mu(t,"update",{path:e.toString(),value:n});let i=!0,s=Pd(t),o={};if(wt(n,(a,u)=>{i=!1,o[a]=gV(Ve(e,a),Ue(u),t.serverSyncTree_,s)}),i)_t("update() called with empty data.  Don't do anything."),ss(t,r,"ok",void 0);else{let a=dy(t),u=r8(t.serverSyncTree_,e,o,a);ly(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||Ot("update at "+e+" failed: "+c);let h=Ji(t.serverSyncTree_,a,!d),f=h.length>0?Du(t,e):e;pn(t.eventQueue_,f,h),ss(t,r,c,l)}),wt(n,c=>{let l=mb(t,Ve(e,c));Du(t,l)}),pn(t.eventQueue_,e,[])}}function M8(t){Mu(t,"onDisconnectEvents");let e=Pd(t),n=Vm();dT(t.onDisconnect_,ve(),(i,s)=>{let o=gV(i,s,t.serverSyncTree_,e);Su(n,i,o)});let r=[];dT(n,ve(),(i,s)=>{r=r.concat(xd(t.serverSyncTree_,i,s));let o=mb(t,i);Du(t,o)}),t.onDisconnect_=Vm(),pn(t.eventQueue_,ve(),r)}function R8(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&lT(t.onDisconnect_,e),ss(t,n,r,i)})}function EF(t,e,n,r){let i=Ue(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Su(t.onDisconnect_,e,i),ss(t,r,s,o)})}function N8(t,e,n,r,i){let s=Ue(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Su(t.onDisconnect_,e,s),ss(t,i,o,a)})}function P8(t,e,n,r){if($d(n)){_t("onDisconnect().update() called with empty data.  Don't do anything."),ss(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&wt(n,(o,a)=>{let u=Ue(a);Su(t.onDisconnect_,Ve(e,o),u)}),ss(t,r,i,s)})}function k8(t,e,n){let r;ie(e._path)===".info"?r=DT(t.infoSyncTree_,e,n):r=DT(t.serverSyncTree_,e,n),EV(t.eventQueue_,e._path,r)}function MT(t,e,n){let r;ie(e._path)===".info"?r=Wm(t.infoSyncTree_,e,n):r=Wm(t.serverSyncTree_,e,n),EV(t.eventQueue_,e._path,r)}function TV(t){t.persistentConnection_&&t.persistentConnection_.interrupt(CV)}function O8(t){t.persistentConnection_&&t.persistentConnection_.resume(CV)}function Mu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),_t(n,...e)}function ss(t,e,n,r){e&&bu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function F8(t,e,n,r,i,s){Mu(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:DF(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=gb(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Rd("transaction failed: Data returned ",u,o.path),o.status=0;let c=ay(t.transactionQueueTree_,e),l=vo(c)||[];l.push(o),db(c,l);let d;typeof u=="object"&&u!==null&&yn(u,".priority")?(d=di(u,".priority"),D(Cd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(sy(t.serverSyncTree_,e)||J.EMPTY_NODE).getPriority().val();let h=Pd(t),f=Ue(u,d),p=cb(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=dy(t);let g=sb(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);pn(t.eventQueue_,e,g),hy(t,t.transactionQueueTree_)}}function gb(t,e,n){return sy(t.serverSyncTree_,e,n)||J.EMPTY_NODE}function hy(t,e=t.transactionQueueTree_){if(e||fy(t,e),vo(e)){let n=SV(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&V8(t,Md(e),n)}else mV(e)&&uy(e,n=>{hy(t,n)})}function V8(t,e,n){let r=n.map(c=>c.currentWriteId),i=gb(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Gt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{Mu(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(Ji(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();fy(t,ay(t.transactionQueueTree_,e)),hy(t,t.transactionQueueTree_),pn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)bu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ot("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Du(t,e)}},o)}function Du(t,e){let n=bV(t,e),r=Md(n),i=SV(t,n);return L8(t,i,r),r}function L8(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=Gt(n,u.path),l=!1,d;if(D(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(Ji(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=T8)l=!0,d="maxretry",i=i.concat(Ji(t.serverSyncTree_,u.currentWriteId,!0));else{let h=gb(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Rd("transaction failed: Data returned ",f,u.path);let p=Ue(f);typeof f=="object"&&f!=null&&yn(f,".priority")||(p=p.updatePriority(h.getPriority()));let _=u.currentWriteId,C=Pd(t),k=cb(p,h,C);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=k,u.currentWriteId=dy(t),o.splice(o.indexOf(_),1),i=i.concat(sb(t.serverSyncTree_,u.path,k,u.currentWriteId,u.applyLocally)),i=i.concat(Ji(t.serverSyncTree_,_,!0))}else l=!0,d="nodata",i=i.concat(Ji(t.serverSyncTree_,u.currentWriteId,!0))}pn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}fy(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)bu(r[a]);hy(t,t.transactionQueueTree_)}function bV(t,e){let n,r=t.transactionQueueTree_;for(n=ie(e);n!==null&&vo(r)===void 0;)r=ay(r,n),e=Ae(e),n=ie(e);return r}function SV(t,e){let n=[];return AV(t,e,n),n.sort((r,i)=>r.order-i.order),n}function AV(t,e,n){let r=vo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);uy(e,i=>{AV(t,i,n)})}function fy(t,e){let n=vo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,db(e,n.length>0?n:void 0)}uy(e,r=>{fy(t,r)})}function mb(t,e){let n=Md(bV(t,e)),r=ay(t.transactionQueueTree_,e);return y8(r,i=>{j0(t,i)}),j0(t,r),yV(r,i=>{j0(t,i)}),n}function j0(t,e){let n=vo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Ji(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?db(e,void 0):n.length=s+1,pn(t.eventQueue_,Md(e),i);for(let o=0;o<r.length;o++)bu(r[o])}}function j8(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function U8(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ot(`Invalid query segment '${n}' in query '${t}'`)}return e}var RT=function(t,e){let n=B8(t),r=n.namespace;n.domain==="firebase.com"&&Pr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Pr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||y5();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new xm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new _e(n.pathString)}},B8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=j8(t.substring(l,d)));let h=U8(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var IF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",$8=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=IF.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=IF.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var Km=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+et(this.snapshot.exportVal())}},Qm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Dd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ym=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new ht;return R8(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){fn("OnDisconnect.remove",this._path);let e=new ht;return EF(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){fn("OnDisconnect.set",this._path),Or("OnDisconnect.set",e,this._path,!1);let n=new ht;return EF(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){fn("OnDisconnect.setWithPriority",this._path),Or("OnDisconnect.setWithPriority",e,this._path,!1),hb("OnDisconnect.setWithPriority",n,!1);let r=new ht;return N8(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){fn("OnDisconnect.update",this._path),_V("OnDisconnect.update",e,this._path,!1);let n=new ht;return P8(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Wt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return se(this._path)?null:KT(this._path)}get ref(){return new gn(this._repo,this._path)}get _queryIdentifier(){let e=uF(this._queryParams),n=zT(e);return n==="{}"?"default":n}get _queryObject(){return uF(this._queryParams)}isEqual(e){if(e=ce(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=QT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Q5(this._path)}};function py(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function as(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Nr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ns)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ci)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Re){if(e!=null&&!Cd(e)||n!=null&&!Cd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof pd||t.getIndex()===XT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function gy(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var gn=class t extends Wt{constructor(e,n){super(e,n,new vd,!1)}get parent(){let e=GF(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Tu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new _e(e),r=os(this.ref,e);return new t(this._node.getChild(n),r,Re)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,os(this.ref,r),Re)))}hasChild(e){let n=new _e(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function yb(t,e){return t=ce(t),t._checkNotDeleted("ref"),e!==void 0?os(t._root,e):t._root}function vb(t,e){t=ce(t),t._checkNotDeleted("refFromURL");let n=RT(e,t._repo.repoInfo_.nodeAdmin);wV("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Pr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),yb(t,n.path.toString())}function os(t,e){return t=ce(t),ie(t._path)===null?C8("child","path",e,!1):xu("child","path",e,!1),new gn(t._repo,Ve(t._path,e))}function xV(t,e){t=ce(t),fn("push",t._path),Or("push",e,t._path,!0);let n=DV(t._repo),r=$8(n),i=os(t,r),s=os(t,r),o;return e!=null?o=my(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function MV(t){return fn("remove",t._path),my(t,null)}function my(t,e){t=ce(t),fn("set",t._path),Or("set",e,t._path,!1);let n=new ht;return pb(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function RV(t,e){t=ce(t),fn("setPriority",t._path),hb("setPriority",e,!1);let n=new ht;return pb(t._repo,Ve(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function NV(t,e,n){if(fn("setWithPriority",t._path),Or("setWithPriority",e,t._path,!1),hb("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new ht;return pb(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function PV(t,e){_V("update",e,t._path,!1);let n=new ht;return x8(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function kV(t){t=ce(t);let e=new Dd(()=>{}),n=new Td(e);return A8(t._repo,t,n).then(r=>new Tu(r,new gn(t._repo,t._path),t._queryParams.getIndex()))}var Td=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Km("value",this,new Tu(e.snapshotNode,new gn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Qm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Zm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Qm(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=os(new gn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Km(e.type,this,new Tu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function kd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{MT(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Dd(n,s||void 0),a=e==="value"?new Td(o):new Zm(e,o);return k8(t._repo,t,a),()=>MT(t._repo,t,a)}function yy(t,e,n,r){return kd(t,"value",e,n,r)}function _b(t,e,n,r){return kd(t,"child_added",e,n,r)}function wb(t,e,n,r){return kd(t,"child_changed",e,n,r)}function Eb(t,e,n,r){return kd(t,"child_moved",e,n,r)}function Ib(t,e,n,r){return kd(t,"child_removed",e,n,r)}function Cb(t,e,n){let r=null,i=n?new Dd(n):null;e==="value"?r=new Td(i):e&&(r=new Zm(e,i)),MT(t._repo,t,r)}var mn=class{},Xm=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Or("endAt",this._value,e._path,!0);let n=aT(e._queryParams,this._value,this._key);if(gy(n),as(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}};function OV(t,e){return Nd("endAt","key",e,!0),new Xm(t,e)}var NT=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Or("endBefore",this._value,e._path,!1);let n=p6(e._queryParams,this._value,this._key);if(gy(n),as(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}};function FV(t,e){return Nd("endBefore","key",e,!0),new NT(t,e)}var Jm=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Or("startAt",this._value,e._path,!0);let n=oT(e._queryParams,this._value,this._key);if(gy(n),as(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}};function VV(t=null,e){return Nd("startAt","key",e,!0),new Jm(t,e)}var PT=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Or("startAfter",this._value,e._path,!1);let n=f6(e._queryParams,this._value,this._key);if(gy(n),as(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}};function LV(t,e){return Nd("startAfter","key",e,!0),new PT(t,e)}var kT=class extends mn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,d6(e._queryParams,this._limit),e._orderByCalled)}};function jV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new kT(t)}var OT=class extends mn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,h6(e._queryParams,this._limit),e._orderByCalled)}};function UV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new OT(t)}var FT=class extends mn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){py(e,"orderByChild");let n=new _e(this._path);if(se(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new pd(n),i=ty(e._queryParams,r);return as(i),new Wt(e._repo,e._path,i,!0)}};function BV(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return xu("orderByChild","path",t,!1),new FT(t)}var VT=class extends mn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){py(e,"orderByKey");let n=ty(e._queryParams,Nr);return as(n),new Wt(e._repo,e._path,n,!0)}};function $V(){return new VT}var LT=class extends mn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){py(e,"orderByPriority");let n=ty(e._queryParams,Re);return as(n),new Wt(e._repo,e._path,n,!0)}};function HV(){return new LT}var jT=class extends mn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){py(e,"orderByValue");let n=ty(e._queryParams,XT);return as(n),new Wt(e._repo,e._path,n,!0)}};function qV(){return new jT}var UT=class extends mn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Or("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Xm(this._value,this._key)._apply(new Jm(this._value,this._key)._apply(e))}};function GV(t,e){return Nd("equalTo","key",e,!0),new UT(t,e)}function Fn(t,...e){let n=ce(t);for(let r of e)n=r._apply(n);return n}Q6(gn);e8(gn);var H8="FIREBASE_DATABASE_EMULATOR_HOST",BT={},q8=!1;function G8(t,e,n,r){t.repoInfo_=new xm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Db(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Pr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=RT(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[H8]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=RT(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new ud(ud.OWNER):new G0(t.name,t.options,e);wV("Invalid Firebase Database URL",o),se(o.path)||Pr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=W8(a,t,l,new q0(t.name,n));return new $T(d,t)}function z8(t,e){let n=BT[e];(!n||n[t.key]!==t)&&Pr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),TV(t),delete n[t.key]}function W8(t,e,n,r){let i=BT[e.name];i||(i={},BT[e.name]=i);let s=i[t.toURLString()];return s&&Pr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new xT(t,q8,n,r),i[t.toURLString()]=s,s}var $T=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(b8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new gn(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(z8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pr("Cannot call "+e+" on a deleted database.")}};function zV(){qF.IS_TRANSPORT_INITIALIZED&&Ot("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function WV(){zV(),hd.forceDisallow()}function KV(){zV(),gu.forceDisallow(),hd.forceAllow()}function QV(t,e,n,r={}){t=ce(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Pr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ud(ud.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:jd(r.mockUserToken,t.app.options.projectId);s=new ud(o)}G8(i,e,n,s)}function YV(t){t=ce(t),t._checkNotDeleted("goOffline"),TV(t._repo)}function ZV(t){t=ce(t),t._checkNotDeleted("goOnline"),O8(t._repo)}function XV(t,e){bF(t,e)}function K8(t){GT(Gd),us(new nn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Db(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Ft(GO,zO,t),Ft(GO,zO,"esm2017")}var Q8={".sv":"timestamp"};function JV(){return Q8}function eL(t){return{".sv":{increment:t}}}var HT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function tL(t,e,n){var r;if(t=ce(t),fn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new ht,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new Tu(l,new gn(t._repo,t._path),Re),s.resolve(new HT(c,d)))},a=yy(t,()=>{});return F8(t._repo,t._path,e,o,a,i),s.promise}YT.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};YT.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};K8();var Y8="@firebase/database-compat",Z8="1.0.4";var X8=new hi("@firebase/database-compat"),nL=function(t){let e="FIREBASE WARNING: "+t;X8.warn(e)};var J8=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Qt(t,e)+"must be a boolean.")},eK=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Qt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Tb=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),ut("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),ut("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),ut("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,nL("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ut("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var bb=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var _o=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),xu("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),xu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new li(this._database,this._delegate.ref)}get ref(){return this.getRef()}},vy=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),ut("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new _o(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return yy(this._delegate,a,u),n;case"child_added":return _b(this._delegate,a,u),n;case"child_removed":return Ib(this._delegate,a,u),n;case"child_changed":return wb(this._delegate,a,u),n;case"child_moved":return Eb(this._delegate,a,u),n;default:throw new Error(Qt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),eK("Query.off",e,!0),ut("Query.off","callback",n,!0),by("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,Cb(this._delegate,e,i)}else Cb(this._delegate,e)}get(){return kV(this._delegate).then(e=>new _o(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),ut("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new ht,a=(c,l)=>{let d=new _o(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":yy(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":_b(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":Ib(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":wb(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":Eb(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(Qt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,Fn(this._delegate,jV(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,Fn(this._delegate,UV(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,Fn(this._delegate,BV(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,Fn(this._delegate,$V()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,Fn(this._delegate,HV()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,Fn(this._delegate,qV()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,Fn(this._delegate,VV(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,Fn(this._delegate,LV(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,Fn(this._delegate,OV(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,Fn(this._delegate,FV(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,Fn(this._delegate,GV(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ut(e,"cancel",i.cancel,!0),i.context=r,by(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Qt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new li(this.database,new gn(this._delegate._repo,this._delegate._path))}},li=class t extends vy{constructor(e,n){super(e,new Wt(n._repo,n._path,new vd,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,os(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),ut("Reference.set","onComplete",n,!0);let r=my(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,nL("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fn("Reference.update",this._delegate._path),ut("Reference.update","onComplete",n,!0);let r=PV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),ut("Reference.setWithPriority","onComplete",r,!0);let i=NV(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),ut("Reference.remove","onComplete",e,!0);let n=MV(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),ut("Reference.transaction","transactionUpdate",e,!1),ut("Reference.transaction","onComplete",n,!0),J8("Reference.transaction","applyLocally",r,!0);let i=tL(this._delegate,e,{applyLocally:r}).then(s=>new bb(s.committed,new _o(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),ut("Reference.setPriority","onComplete",n,!0);let r=RV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),ut("Reference.push","onComplete",n,!0);let r=xV(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return fn("Reference.onDisconnect",this._delegate._path),new Tb(new Ym(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var wo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:WV,forceLongPolling:KV}}useEmulator(e,n,r={}){QV(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof li){let n=vb(this._delegate,e.toString());return new li(this,n)}else{let n=yb(this._delegate,e);return new li(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=vb(this._delegate,e);return new li(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),YV(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),ZV(this._delegate)}};wo.ServerValue={TIMESTAMP:JV(),increment:t=>eL(t)};function tK({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){GT(n);let a=new Sy("database-standalone"),u=new Hd("auth-internal",a);u.setComponent(new nn("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new Hd("app-check-internal",a),c.setComponent(new nn("app-check-internal",()=>i,"PRIVATE"))),{instance:new wo(Db(t,u,c,e,o),t),namespace:s}}var nK=Object.freeze({__proto__:null,initStandalone:tK});var rK=wo.ServerValue;function iK(t){t.INTERNAL.registerComponent(new nn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new wo(i,r)},"PUBLIC").setServiceProps({Reference:li,Query:vy,Database:wo,DataSnapshot:_o,enableLogging:XV,INTERNAL:nK,ServerValue:rK}).setMultipleInstances(!0)),t.registerVersion(Y8,Z8)}iK(At);function Od(t,e,n="on",r=fs){return new te(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(O(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Bu())}function sK(t){return typeof t=="string"}function oK(t){return typeof t.exportVal=="function"}function aL(t){return t==null}function uL(t){return typeof t.set=="function"}function rL(t,e){return uL(e)?e:t.ref(e)}function cL(t,e){if(sK(t))return e.stringCase();if(uL(t))return e.firebaseCase();if(oK(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function lL(t){return(aL(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function dL(t,e,n){e=lL(e);let r=e.map(i=>Od(t,i,"on",n));return ko(...r)}function aK(t,e,n){let r=dL(t,e).pipe(nr((i,s)=>[...i,s],[]));return cK(t,r,n)}function uK(t,e){return Od(t,"value","on",e).pipe(O(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function cK(t,e,n){return uK(t,n).pipe(Zy(e),O(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Qy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),O(i=>i.actions))}function iL(t,e){return function(r,i){return cL(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function lK(t){return function(n){return n?cL(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function dK(t,e,n){return Od(t,"value","once",n).pipe(ke(r=>{let i=[F(r)];return e.forEach(s=>i.push(Od(t,s,"on",n))),ko(...i).pipe(nr(fK,[]))}),Lu())}function hL(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function hK(t,e){if(aL(e))return 0;{let n=hL(t,e);return n===-1?t.length:n+1}}function fK(t,e){let{payload:n,prevKey:r,key:i}=e,s=hL(t,i),o=hK(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function sL(t,e,n){return e=lL(e),dK(t,e,n)}function pK(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:iL(r,"update"),set:iL(r,"set"),push:i=>r.push(i),remove:lK(r),snapshotChanges(i){return sL(t,i,n).pipe(ze)},stateChanges(i){return dL(t,i,n).pipe(ze)},auditTrail(i){return aK(t,i,n).pipe(ze)},valueChanges(i,s){return sL(t,i,n).pipe(O(a=>a.map(u=>s&&s.idField?ye(b({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),ze)}}}function oL(t,e){return function(){return Od(t,"value","on",e)}}function gK(t,e){return{query:t,snapshotChanges(){return oL(t,e.schedulers.outsideAngular)().pipe(ze)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return oL(t,e.schedulers.outsideAngular)().pipe(ze,O(r=>r.payload.exists()?r.payload.val():null))}}}var mK=new R("angularfire2.realtimeDatabaseURL"),yK=new R("angularfire2.database.use-emulator"),_y=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_){this.schedulers=a;let C=u,k=io(n,o,r);c&&td(k,o,l,h,f,p,d,g),this.database=tu(`${k.name}.database.${i}`,"AngularFireDatabase",k.name,()=>{let T=o.runOutsideAngular(()=>k.database(i||void 0));return C&&T.useEmulator(...C),T},[C])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>rL(this.database,n)),s=i;return r&&(s=r(i)),pK(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>rL(this.database,n));return gK(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(zi),E(Wi,8),E(mK,8),E(Mt),E(ae),E(Zr),E(yK,8),E(vm,8),E(Ql,8),E(Yl,8),E(Zl,8),E(Xl,8),E(Jl,8),E(ed,8),E(Sn,8))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var pL=(()=>{let e=class e{constructor(r){this.db=r}getEmpleadoPorNombre(r){return this.db.object(`DatosDue\xF1os/${r}`).valueChanges()}};e.\u0275fac=function(i){return new(i||e)(E(_y))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var gL=(()=>{let e=class e{constructor(r,i){this.route=r,this.empleadoService=i}ngOnInit(){this.route.params.subscribe(r=>{let i=r.nombre;this.getEmpleadoPorNombre(i)})}getEmpleadoPorNombre(r){this.empleadoService.getEmpleadoPorNombre(r).subscribe(i=>{this.empleado=i},i=>{console.error("Error al obtener empleado:",i)})}};e.\u0275fac=function(i){return new(i||e)(j(ui),j(pL))},e.\u0275cmp=Zt({type:e,selectors:[["app-lista-empleados"]],decls:42,vars:7,consts:[[1,"container","mt-4"],[1,"card"],[1,"card-body","d-flex","justify-content-between","align-items-center"],[1,"h3"],[1,"table","table-striped","mt-3"],["scope","row"]],template:function(i,s){i&1&&(U(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),re(4,"Detalles del Empleado"),$()(),U(5,"table",4)(6,"tbody")(7,"tr")(8,"th",5),re(9,"Nombre"),$(),U(10,"td"),re(11),$()(),U(12,"tr")(13,"th",5),re(14,"Direcci\xF3n"),$(),U(15,"td"),re(16),$()(),U(17,"tr")(18,"th",5),re(19,"Email"),$(),U(20,"td"),re(21),$()(),U(22,"tr")(23,"th",5),re(24,"Nombre Perro"),$(),U(25,"td"),re(26),$()(),U(27,"tr")(28,"th",5),re(29,"Raza Perro"),$(),U(30,"td"),re(31),$()(),U(32,"tr")(33,"th",5),re(34,"Edad Perro"),$(),U(35,"td"),re(36),$()(),U(37,"tr")(38,"th",5),re(39,"Ruta de Imagen"),$(),U(40,"td"),re(41),$()()()()()()),i&2&&(Le(11),qn(s.empleado==null?null:s.empleado.nombre),Le(5),qn(s.empleado==null?null:s.empleado.direccion),Le(5),qn(s.empleado==null?null:s.empleado.email),Le(5),qn(s.empleado==null?null:s.empleado.fechaini),Le(5),qn(s.empleado==null?null:s.empleado.fechafin),Le(5),qn(s.empleado==null?null:s.empleado.descripcion),Le(5),qn(s.empleado==null?null:s.empleado.rutaImagen))},styles:[".card-body[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px}td[_ngcontent-%COMP%]{padding:12px;text-align:left}"]});let t=e;return t})();var mL=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/Datos Cuidadores"}agregarEmpleado(r){let i=this.db.createPushId();return this.db.list(this.dbPath).set(i,r)}getEmpleados3(){return this.db.list(this.dbPath).snapshotChanges().pipe(O(r=>r.map(i=>b({id:i.payload.key},i.payload.val()))))}eliminarEmpleado3(r){return this.db.list(this.dbPath).remove(r)}};e.\u0275fac=function(i){return new(i||e)(E(_y))},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yL=t=>["/lista-empleados",t];function wK(t,e){t&1&&(U(0,"h5",16),re(1,"NO HAY DATOS PARA MOSTRAR"),$())}function EK(t,e){if(t&1){let n=Qx();U(0,"tr")(1,"td",21)(2,"a",22),re(3),$()(),U(4,"td",23)(5,"a",24),ft("click",function(){let i=FA(n).$implicit,s=sc(2);return VA(s.eliminarEmpleado(i.id))}),Dt(6,"img",25),$(),U(7,"a",26),Dt(8,"img",27),$()()()}if(t&2){let n=e.$implicit;Le(2),bn("routerLink",V_(3,yL,n.nombre)),Le(),qn(n.nombre),Le(4),bn("routerLink",V_(5,yL,n.nombre))}}function IK(t,e){if(t&1&&(U(0,"table",17)(1,"thead")(2,"tr")(3,"th",18),re(4,"Nombre"),$(),U(5,"th",19),re(6,"Acciones"),$()()(),U(7,"tbody"),zr(8,EK,9,7,"tr",20),$()()),t&2){let n=sc();Le(8),bn("ngForOf",n.empleadosFiltrados)}}var vL=(()=>{let e=class e{constructor(r,i){this._empleadoService=r,this._empleadoService3=i,this.empleados=[],this.empleadosFiltrados=[],this.role="owner"}ngOnInit(){this.getEmpleadosDue\u00F1o()}onRoleChange(r){this.role=r.target.value,this.role==="owner"?this.getEmpleadosDue\u00F1o():this.getEmpleadosCuidador()}getEmpleadosDue\u00F1o(){this._empleadoService.getEmpleados().subscribe(r=>{this.empleados=r.map(i=>b({id:i.payload.doc.id},i.payload.doc.data())),this.empleadosFiltrados=this.empleados,console.log("Empleados en la colecci\xF3n (Due\xF1os):",this.empleados)},r=>{console.error("Error al obtener empleados (Due\xF1os):",r)})}getEmpleadosCuidador(){this._empleadoService3.getEmpleados3().subscribe(r=>{this.empleados=r,this.empleadosFiltrados=this.empleados,console.log("Empleados en la colecci\xF3n (Cuidadores):",this.empleados)},r=>{console.error("Error al obtener empleados (Cuidadores):",r)})}eliminarEmpleado(r){this.role==="owner"?this._empleadoService.eliminarEmpleado(r).then(()=>{console.log("Empleado eliminado con \xE9xito"),this.showNotification("Empleado eliminado correctamente"),this.getEmpleadosDue\u00F1o()}).catch(i=>{console.error("Error al eliminar empleado:",i)}):this._empleadoService3.eliminarEmpleado3(r).then(()=>{console.log("Empleado eliminado con \xE9xito"),this.showNotification("Empleado eliminado correctamente"),this.getEmpleadosCuidador()}).catch(i=>{console.error("Error al eliminar empleado:",i)})}showNotification(r){let i=document.getElementById("notification-message");i&&(i.textContent=r,this.showNotificationElement(),setTimeout(()=>{this.hideNotificationElement()},4e3))}showNotificationElement(){let r=document.getElementById("notification");r&&r.classList.add("show")}hideNotificationElement(){let r=document.getElementById("notification");r&&(r.classList.remove("show"),r.classList.add("hide"),setTimeout(()=>{r.classList.remove("hide")},300))}buscarEmpleado(r){r?this.empleadosFiltrados=this.empleados.filter(i=>i.nombre.toLowerCase().includes(r.toLowerCase())):this.empleadosFiltrados=this.empleados}onBuscarEmpleado(r){let i=r.target.value;this.buscarEmpleado(i)}};e.\u0275fac=function(i){return new(i||e)(j(bm),j(mL))},e.\u0275cmp=Zt({type:e,selectors:[["tabla-empleados"]],decls:20,vars:2,consts:[[1,"container","mt-4"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"h3"],["id","role-selector",1,"form-select",3,"change"],["value","owner","selected",""],["value","caretaker"],[1,"card-body"],["class","no-data",4,"ngIf"],[1,"input-group","mb-3"],["type","text","placeholder","Buscar por nombre...",1,"form-control",3,"input"],["routerLink","/crear-empleados",1,"btn","btn-dark"],[1,"table-responsive"],["class","table table-striped mt-3",4,"ngIf"],["id","notification",1,"notification"],["id","notification-message"],[1,"no-data"],[1,"table","table-striped","mt-3"],["scope","col",1,"nombre"],["scope","col",1,"acciones"],[4,"ngFor","ngForOf"],[1,"nombre"],[3,"routerLink"],[1,"acciones"],[1,"action-icon",2,"cursor","pointer",3,"click"],["src","assets/iconos/eliminar.ico","alt","Icono Eliminar"],[1,"action-icon",3,"routerLink"],["src","assets/iconos/ver.ico","alt","Icono Ver Detalles"]],template:function(i,s){i&1&&(U(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),re(4,"LISTA CUIDADORES"),$(),U(5,"select",4),ft("change",function(a){return s.onRoleChange(a)}),U(6,"option",5),re(7,"Due\xF1o"),$(),U(8,"option",6),re(9,"Cuidador"),$()()(),U(10,"div",7),zr(11,wK,2,0,"h5",8),U(12,"div",9)(13,"input",10),ft("input",function(a){return s.onBuscarEmpleado(a)}),$(),U(14,"button",11),re(15,"Agregar"),$()(),U(16,"div",12),zr(17,IK,9,1,"table",13),$()()()(),U(18,"div",14),Dt(19,"span",15),$()),i&2&&(Le(11),bn("ngIf",s.empleados.length==0),Le(6),bn("ngIf",s.empleados.length>0))},dependencies:[wM,ra,mm,hR,pR],styles:[".card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef}.card-header[_ngcontent-%COMP%]   .h3[_ngcontent-%COMP%]{margin:0}.no-data[_ngcontent-%COMP%]{margin-top:15px;color:brown;text-align:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex-grow:1}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex-shrink:0}.table[_ngcontent-%COMP%]{margin-top:20px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-of-type(odd){background-color:#0000000d}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#0000001a}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{padding-left:200px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .acciones[_ngcontent-%COMP%]{padding-right:30px}.nombre[_ngcontent-%COMP%]{padding-left:200px}.action-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.notification[_ngcontent-%COMP%]{display:none;position:fixed;bottom:20px;right:20px;padding:15px;background-color:#ba1d1d;color:#fff;border-radius:5px;box-shadow:0 2px 5px #0003;transition:opacity .3s ease}.notification.show[_ngcontent-%COMP%]{display:block;opacity:1}.notification.hide[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s ease}"]});let t=e;return t})();var _L=(()=>{let e=class e{constructor(){}login(r,i){return r==="diego"&&i==="123456"?F(!0):F(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function DK(t,e){if(t&1&&(U(0,"div",9)(1,"span"),re(2,"!"),$(),re(3),Dt(4,"img",10),$()),t&2){let n=sc();Le(3),wf(" ",n.errorMessage," ")}}var wL=(()=>{let e=class e{constructor(r,i){this.router=r,this.authService=i,this.username="",this.password="",this.errorMessage=""}onSubmit(){if(!this.username||!this.password){this.errorMessage="Ingrese el nombre de usuario y la contrase\xF1a.";return}let r=this.sanitizeInput(this.username),i=this.sanitizeInput(this.password);this.authService.login(r,i).subscribe(s=>{s?(this.router.navigate(["/tabla-empleados"]),console.log("Sesi\xF3n iniciada correctamente")):(console.log("Credenciales incorrectas"),this.errorMessage="Credenciales incorrectas")},s=>{console.log("Error al autenticar:",s)})}sanitizeInput(r){return r.replace(/[^a-zA-Z0-9]/g,"")}};e.\u0275fac=function(i){return new(i||e)(j(xr),j(_L))},e.\u0275cmp=Zt({type:e,selectors:[["app-login"]],decls:17,vars:3,consts:[[1,"login-box"],[1,"photo-container"],["src","../../../assets/iconos/perro3.png","alt","Foto de perfil",2,"width","160px","height","160px"],[3,"submit"],[1,"user-box"],["type","text","name","username","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit"],["class","error-msg",4,"ngIf"],[1,"error-msg"],["src","../../../assets/iconos/exclamacion.png","alt","Error",1,"error-icon"]],template:function(i,s){i&1&&(U(0,"div",0)(1,"div",1),Dt(2,"img",2),$(),U(3,"h2"),re(4,"Login"),$(),U(5,"form",3),ft("submit",function(){return s.onSubmit()}),U(6,"div",4)(7,"input",5),If("ngModelChange",function(a){return F_(s.username,a)||(s.username=a),a}),$(),U(8,"label"),re(9,"Username"),$()(),U(10,"div",4)(11,"input",6),If("ngModelChange",function(a){return F_(s.password,a)||(s.password=a),a}),$(),U(12,"label"),re(13,"Password"),$()(),U(14,"button",7),re(15," Submit "),$()(),zr(16,DK,5,1,"div",8),$()),i&2&&(Le(7),Ef("ngModel",s.username),Le(4),Ef("ngModel",s.password),Le(5),bn("ngIf",s.errorMessage))},dependencies:[ra,Wf,ca,Hf,qf,ww,mw,gw],styles:['html[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;padding:0;font-family:sans-serif;background:linear-gradient(#141e30,#243b55)}.login-box[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:400px;padding:40px;transform:translate(-50%,-50%);background:rgba(0,0,0,.5);box-sizing:border-box;box-shadow:0 15px 25px #0009;border-radius:10px}.login-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 30px;padding:0;color:#fff;text-align:center}.login-box[_ngcontent-%COMP%]   .user-box[_ngcontent-%COMP%]{position:relative}.login-box[_ngcontent-%COMP%]   .user-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 0;font-size:16px;color:#fff;margin-bottom:30px;border:none;border-bottom:1px solid #fff;outline:none;background:transparent}.login-box[_ngcontent-%COMP%]   .user-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:10px 0;font-size:16px;color:#fff;pointer-events:none;transition:.5s}.login-box[_ngcontent-%COMP%]   .user-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .login-box[_ngcontent-%COMP%]   .user-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid ~ label[_ngcontent-%COMP%]{top:-20px;left:0;color:#03e9f4;font-size:12px}.login-box[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;display:inline-block;padding:10px 20px;color:#03e9f4;font-size:16px;text-decoration:none;text-transform:uppercase;overflow:hidden;transition:.5s;margin-top:40px;letter-spacing:4px}.login-box[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;display:block}.login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;display:inline-block;padding:10px 20px;color:#03e9f4;font-size:16px;text-decoration:none;text-transform:uppercase;overflow:hidden;transition:.5s;letter-spacing:4px;border:none;background-color:transparent;cursor:pointer}.login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:0;height:100%;background:linear-gradient(90deg,transparent,#03e9f4);transition:width .5s,height .5s,left .5s,top .5s;z-index:-1}.login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:before, .login-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:before{width:100%;height:100%;left:0;top:0}.error[_ngcontent-%COMP%]{background-color:red}.error-msg[_ngcontent-%COMP%]{color:red;font-size:15px;font-weight:700;margin-bottom:10px}.photo-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.error-icon[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:10px}.error-msg[_ngcontent-%COMP%]{display:flex;align-items:center}']});let t=e;return t})();var TK=[{path:"tabla-empleados",component:vL},{path:"crear-empleados",component:qO},{path:"lista-empleados/:nombre",component:gL},{path:"login",component:wL},{path:"",redirectTo:"login",pathMatch:"full"},{path:"**",redirectTo:"tabla-empleados",pathMatch:"full"}],EL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=He({imports:[m0.forRoot(TK),m0]});let t=e;return t})();var IL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Zt({type:e,selectors:[["app-navbar"]],decls:4,vars:0,consts:[["data-bs-theme","dark",1,"navbar","bg-dark","border-bottom","border-body"],[1,"container-fluid"],[1,"navbar-brand","mb-0","h1"]],template:function(i,s){i&1&&(U(0,"nav",0)(1,"div",1)(2,"span",2),re(3,"Mi-Mascota Perruna"),$()()())},styles:[".container-fluid[_ngcontent-%COMP%]{display:flex;justify-content:center}"]});let t=e;return t})();var CL=(()=>{let e=class e{constructor(){this.title="empleados"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Zt({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){i&1&&Dt(0,"app-navbar")(1,"router-outlet")},dependencies:[c0,IL]});let t=e;return t})();var DL={production:!1,firebase:{apiKey:"AIzaSyA_SM6d1nCztP2JON5DHytWOOWs7Jl_Ff4",authDomain:"perruna-cd211.firebaseapp.com",databaseURL:"https://perruna-cd211-default-rtdb.firebaseio.com",projectId:"perruna-cd211",storageBucket:"perruna-cd211.appspot.com",messagingSenderId:"796763331783",appId:"1:796763331783:web:2fd75de7e305206f66b2e2",measurementId:"G-RHB6WS2L9H"}};var TL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=qe({type:e,bootstrap:[CL]}),e.\u0275inj=He({imports:[RM,EL,vR,yR,P1.initializeApp(DL.firebase),x1(()=>M1())]});let t=e;return t})();MM().bootstrapModule(TL).catch(t=>console.error(t));
